Notebook[
 {Cell[CellGroupData[
    {Cell[TextData[{Cell[BoxData[FormBox[SuperscriptBox[SubscriptBox[
             StyleBox["H", FontSlant -> "Plain"], "5"], "+"], 
           TraditionalForm]]], " DVR Adiabatic"}], "Chapter", 
      CellChangeTimes -> {{3.731863985172079*^9, 3.7318639863199368*^9}, 
        {3.734891636796474*^9, 3.734891649850445*^9}, {3.745182404731666*^9, 
        3.745182409315515*^9}, 3.74518245026158*^9}, 
      TextAlignment -> Center], Cell["2/22/2019", "Text", 
      CellChangeTimes -> {{3.731863989207284*^9, 3.731863990655895*^9}, 
       {3.731864026554674*^9, 3.731864033938505*^9}, {3.7598616732610493*^9, 
       3.7598616753009863*^9}}, TextAlignment -> Right], 
     Cell[TextData[{"Adiabatic treatment of ", 
        Cell[BoxData[FormBox[SuperscriptBox[SubscriptBox[StyleBox["H", 
              FontSlant -> "Plain"], "5"], "+"], TraditionalForm]]]}], 
      "Text", CellChangeTimes -> {{3.745182582129764*^9, 
       3.745182592099962*^9}, {3.759866727496587*^9, 
       3.7598667294416656*^9}}], Cell[CellGroupData[
       {Cell["Average Field (Adiabatic Treatment)", "Section", 
         CellChangeTimes -> {{3.7348929629536343*^9, 3.7348929771866083*^9}, 
          {3.738596532627039*^9, 3.738596537593079*^9}, 
          {3.744568560358317*^9, 3.744568565054776*^9}}], 
        Cell[TextData[
          {"We\[CloseCurlyQuote]ll protect ourselves by sticking this ", 
           Cell[BoxData[RowBox[{"$HistoryLength", " ", "=", " ", "0"}]]], 
           " here... (for local use only)"}], "Text", CellChangeTimes -> 
          {{3.760134682530834*^9, 3.7601347072119627*^9}, 
          {3.76014343418371*^9, 3.760143437448017*^9}}], 
        Cell[BoxData[{RowBox[{RowBox[{"$HistoryLength", "=", "0"}], ";"}], 
           "\n", RowBox[{RowBox[{"Clear", "@@", RowBox[{"Unprotect", "[", 
                 "Out", "]"}]}], ";"}]}], "Input", CellChangeTimes -> 
          {{3.759936988904265*^9, 3.759937013743372*^9}}, 
         CellLabel -> "In[1]:="], Cell["On the server do this:", "Text", 
         CellChangeTimes -> {{3.760143440447447*^9, 3.76014344539176*^9}}], 
        Cell[BoxData[RowBox[{RowBox[{"$runContext", "=", RowBox[{
                "$ScriptCommandLine", "[", RowBox[{"[", RowBox[{"-", "1"}], 
                  "]"}], "]"}]}], ";"}]], "Input", CellChangeTimes -> 
          {{3.760645809945709*^9, 3.7606458182936077*^9}, 
          {3.7606458663554363*^9, 3.7606458812589293*^9}, 
          {3.760646137994034*^9, 3.760646150436212*^9}, {3.76064910675535*^9, 
          3.760649106871996*^9}}], 
        Cell[BoxData[{RowBox[{RowBox[{"PacletManager`PacletDirectoryAdd", 
               "[", "\"/gscratch/chem/b3m2a1/Mathematica/Paclets\"", "]"}], 
             ";"}], "\n", RowBox[{RowBox[{"$Path", "=", RowBox[
                {"DeleteDuplicates", "@", RowBox[{"Append", "[", RowBox[
                    {"$Path", ",", " ", 
                     "\"/gscratch/chem/b3m2a1/H5+/Common\""}], "]"}]}]}], 
             ";"}], "\n", RowBox[{RowBox[{"$Output", " ", "=", " ", RowBox[
                {RowBox[{"OpenWrite", "[", RowBox[{"FileNameJoin", "@", 
                     RowBox[{"{", RowBox[{"\"outs\"", ",", " ", RowBox[
                          {"\"out_\"", "<>", RowBox[{"ToLowerCase", "[", 
                          "$runContext", "]"}], "<>", "\".txt\""}]}], 
                       "}"}]}], "]"}], "//", RowBox[{RowBox[{"Prepend", "[", 
                     RowBox[{"$Output", ",", " ", "#"}], "]"}], "&"}]}]}], 
             ";"}], "\n", RowBox[{RowBox[{"$Messages", " ", "=", " ", RowBox[
                {RowBox[{"OpenWrite", "[", RowBox[{"FileNameJoin", "@", 
                     RowBox[{"{", RowBox[{"\"logs\"", ",", " ", RowBox[
                          {"\"log_\"", "<>", RowBox[{"ToLowerCase", "[", 
                          "$runContext", "]"}], "<>", "\".txt\""}]}], 
                       "}"}]}], "]"}], "//", "\[IndentingNewLine]", 
                 RowBox[{RowBox[{"Prepend", "[", RowBox[{"$Messages", ",", 
                       " ", "#"}], "]"}], "&"}]}]}], ";"}]}], "Input", 
         CellChangeTimes -> {{3.7601433502761517*^9, 3.760143448063857*^9}, 
           3.7601440563175583*^9, {3.7601441586749*^9, 
           3.7601441750155697*^9}, {3.760145273432289*^9, 
           3.760145284835162*^9}, {3.760145607704586*^9, 
           3.760145609526905*^9}, {3.760145751238508*^9, 
           3.760145767761195*^9}, {3.760148243635193*^9, 
           3.760148259784851*^9}, {3.760164933418954*^9, 
           3.760164947665435*^9}, {3.760187874488419*^9, 
           3.760187904502633*^9}, {3.760201413644503*^9, 
           3.760201421115123*^9}, {3.760203373215582*^9, 
           3.760203391672698*^9}, {3.76020376382743*^9, 
           3.7602038164637213*^9}, 3.760645799810273*^9, 
           {3.7606458845251293*^9, 3.760645939323618*^9}, 
           3.760649085333847*^9}], Cell[CellGroupData[
          {Cell["Set Up Environment", "Subsection", CellChangeTimes -> 
             {{3.7601333244965754*^9, 3.760133328232445*^9}}], 
           Cell[BoxData[{RowBox[{RowBox[{"Do", "[", RowBox[{RowBox[{"If", 
                      "[", RowBox[{RowBox[{"StringEndsQ", "[", RowBox[
                          {"$Context", ",", " ", "\"`Private`\""}], "]"}], 
                        ",", " ", RowBox[{"End", "[", "]"}]}], "]"}], ",", 
                    " ", "10"}], "]"}], ";"}], "\[IndentingNewLine]", 
              RowBox[{RowBox[{"Do", "[", RowBox[{RowBox[{"If", "[", 
                      RowBox[{RowBox[{"$Context", "=!=", "\"Global`\""}], 
                        ",", " ", RowBox[{"EndPackage", "[", "]"}]}], "]"}], 
                    ",", "  ", "10"}], "]"}], ";"}], "\[IndentingNewLine]", 
              RowBox[{RowBox[{"BeginPackage", "[", RowBox[{"$runContext", 
                    "<>", "\"`\""}], "]"}], ";"}]}], "Input", 
            CellChangeTimes -> {{3.760133287036646*^9, 3.760133390599545*^9}, 
              {3.7601334493521023*^9, 3.760133475366535*^9}, 
              3.760135415157834*^9, {3.7601452559269667*^9, 
              3.760145270117404*^9}, {3.760187907375557*^9, 
              3.7601879075586*^9}, {3.760188800012582*^9, 
              3.760188804065283*^9}, {3.760646007128573*^9, 
              3.7606460096147137*^9}}], Cell[CellGroupData[
             {Cell["Declare Exported Symbols", "Subsubsection", 
               CellChangeTimes -> {{3.760133836656806*^9, 
                 3.760133840743672*^9}, 3.760204523622408*^9}], 
              Cell["All of these will end up being dumped to file", "Text", 
               CellChangeTimes -> {{3.760134129058668*^9, 
                3.7601341578584347*^9}}], Cell[BoxData[
                {RowBox[{RowBox[{RowBox[{"$OverlapMatrices", "::", "usage"}], 
                     "=", "\"The overlap matrices used in the coupling\""}], 
                   ";"}], "\[IndentingNewLine]", RowBox[{RowBox[
                    {RowBox[{"$Wavefunctions", "::", "usage"}], "=", 
                     "\"The 4D wavefunctions used in the end\""}], ";"}], 
                 "\[IndentingNewLine]", RowBox[{RowBox[{RowBox[
                      {"$FullWavefunctions", "::", "usage"}], "=", 
                     "\"The full set of 4D wavefunctions generated\""}], 
                   ";"}], "\[IndentingNewLine]", RowBox[{RowBox[
                    {RowBox[{"$ZeroPointEnergies", "::", "usage"}], "=", 
                     "\"The ZPEs of all the wavefunctions\""}], ";"}], 
                 "\[IndentingNewLine]", RowBox[{RowBox[{RowBox[
                      {"$RawSpectra", "::", "usage"}], "=", 
                     "\"The raw data used for building the spectra\""}], 
                   ";"}], "\[IndentingNewLine]", RowBox[{RowBox[
                    {RowBox[{"$Spectra", "::", "usage"}], "=", 
                     "\"The chunks of the spectra generated\""}], ";"}]}], 
               "Input", CellChangeTimes -> {{3.760133844324112*^9, 
                3.760133908846692*^9}, {3.7601341214750137*^9, 
                3.76013412200314*^9}, {3.760136218586227*^9, 
                3.76013623292879*^9}, {3.760139132682067*^9, 
                3.760139187688222*^9}, {3.760466699756212*^9, 
                3.760466720223177*^9}, {3.760466779876137*^9, 
                3.760466795422009*^9}, {3.760478584424692*^9, 
                3.760478596462393*^9}}]}, Open]], 
           Cell[CellGroupData[{Cell["Declare Package Symbols", 
               "Subsubsection", CellChangeTimes -> {{3.760133904591723*^9, 
                3.76013390763874*^9}}], Cell["These are shared between the \
scripts and should be changed up to get new behavior", "Text", 
               CellChangeTimes -> {{3.760201453333609*^9, 
                3.760201489677436*^9}}], Cell[BoxData[RowBox[
                 {RowBox[{"BeginPackage", "[", "\"`Package`\"", "]"}], 
                  ";"}]], "Input", CellChangeTimes -> {{3.760133912396345*^9, 
                3.760133923358386*^9}}, CellLabel -> "In[8]:="], 
              Cell[CellGroupData[{Cell["Inputs", "Subsubsubsection", 
                  CellChangeTimes -> {{3.760134774049533*^9, 
                   3.76013477442416*^9}, {3.7601350024137497*^9, 
                   3.7601350111641083*^9}, {3.760136331278713*^9, 
                   3.760136332158949*^9}}], Cell[BoxData[{RowBox[
                     {RowBox[{RowBox[{"$fullPot", "::", "usage"}], "=", 
                        "\"The 4D potential for the problem\""}], ";"}], 
                    "\[IndentingNewLine]", RowBox[{RowBox[{RowBox[
                         {"$fullDipoleSurf", "::", "usage"}], "=", 
                        "\"The 4D dipole surfaces for the problem\""}], 
                      ";"}]}], "Input", CellChangeTimes -> 
                   {{3.760135013156859*^9, 3.760135097739105*^9}, 
                    {3.760135312872685*^9, 3.760135341847104*^9}, 
                    {3.7601356865884867*^9, 3.760135695721702*^9}, 
                    {3.7601358009599133*^9, 3.7601358289196043*^9}, 
                    {3.760135876217593*^9, 3.7601359049825068*^9}, 
                    3.7601361243582897*^9}, CellLabel -> "In[9]:="]}, Open]], 
              Cell[CellGroupData[{Cell["DVRs", "Subsubsubsection", 
                  CellChangeTimes -> {{3.760136328816495*^9, 
                   3.760136336198545*^9}}], Cell[BoxData[{RowBox[
                     {RowBox[{RowBox[{"$saDVR", "::", "usage"}], "=", 
                        "\"The DVR for the s/a problem\""}], ";"}], 
                    "\[IndentingNewLine]", RowBox[{RowBox[{RowBox[
                         {"$r1r2DVR", "::", "usage"}], "=", 
                        "\"The DVR for the r1/r2 problem\""}], ";"}], 
                    "\[IndentingNewLine]", RowBox[{RowBox[{RowBox[
                         {"$r1r21DDVR", "::", "isage"}], "=", 
                        "\"The DVR to the 1D r1 or r2 problem\""}], ";"}]}], 
                  "Input", CellChangeTimes -> {{3.760135013156859*^9, 
                   3.760135097739105*^9}, {3.760135312872685*^9, 
                   3.760135341847104*^9}, {3.7601356865884867*^9, 
                   3.760135695721702*^9}, {3.7601358009599133*^9, 
                   3.7601358289196043*^9}, {3.760135876217593*^9, 
                   3.7601359049825068*^9}, {3.7601361243582897*^9, 
                   3.7601361251972313*^9}, {3.760137199866077*^9, 
                   3.7601372152643347*^9}}, CellLabel -> "In[11]:="]}, 
                Open]], Cell[CellGroupData[{Cell["End", "Subsubsubsection", 
                  CellChangeTimes -> {{3.7601362718332653*^9, 
                   3.760136285079619*^9}}], Cell[BoxData[RowBox[
                    {RowBox[{"EndPackage", "[", "]"}], ";"}]], "Input", 
                  CellChangeTimes -> {{3.760133924794689*^9, 
                   3.7601339266717157*^9}}, CellLabel -> "In[14]:="]}, 
                Open]]}, Open]]}, Open]], Cell[CellGroupData[
          {Cell["Begin Private Section", "Subsection", CellChangeTimes -> 
             {{3.760133430991992*^9, 3.7601334356227407*^9}}], 
           Cell[BoxData[{RowBox[{RowBox[{"Begin", "[", "\"`Private`\"", 
                  "]"}], ";"}], "\[IndentingNewLine]", RowBox[{"<<", 
                "SpectrumScript`"}]}], "Input", CellChangeTimes -> 
             {{3.760133437282976*^9, 3.760133441606876*^9}, 
             {3.760649263242814*^9, 3.760649263449026*^9}}]}, Open]], 
        Cell[CellGroupData[{Cell["Common", "Subsection", CellChangeTimes -> 
             {{3.7453458818925867*^9, 3.74534588342701*^9}, 
             {3.750011520271427*^9, 3.750011520829*^9}}], 
           Cell["These symbols get shared across all the scripts", "Text", 
            CellChangeTimes -> {{3.760201599410727*^9, 
             3.7602016092645082*^9}}], Cell[BoxData[RowBox[{"Get", "[", 
               "\[IndentingNewLine]", RowBox[{"FileNameJoin", "@", 
                 RowBox[{"{", "\[IndentingNewLine]", RowBox[{RowBox[
                      {"DirectoryName", "[", RowBox[{"$ScriptCommandLine", 
                         "[", RowBox[{"[", RowBox[{"-", "2"}], "]"}], "]"}], 
                       "]"}], ",", "\[IndentingNewLine]", RowBox[
                      {RowBox[{RowBox[{"StringSplit", "[", RowBox[
                          {"$Context", ",", " ", "\"`\""}], "]"}], "[", 
                         RowBox[{"[", "1", "]"}], "]"}], "<>", " ", 
                       "\".wl\""}]}], "\[IndentingNewLine]", "}"}]}], 
               "\[IndentingNewLine]", "]"}]], "Input", CellChangeTimes -> 
             {{3.760646173552374*^9, 3.760646224762083*^9}, 
              {3.7606490993947268*^9, 3.760649103376952*^9}, 
              3.760649185638932*^9}], Cell[CellGroupData[
             {Cell["SA Grid", "Subsubsection", CellChangeTimes -> 
                {{3.7601363778299227*^9, 3.7601363795193777*^9}}], 
              Cell[BoxData[{RowBox[{RowBox[{"saMainGrid", "=", RowBox[
                      {"$saDVR", "[", RowBox[{"\"Grid\"", ",", " ", RowBox[
                          {"\"Points\"", "\[Rule]", RowBox[{"{", RowBox[
                          {"$saBasisSize", ",", " ", "$saBasisSize"}], 
                          "}"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
                 RowBox[{RowBox[{"saGrid", "=", RowBox[{"saMainGrid", "[", 
                       "\"Points\"", "]"}]}], ";"}]}], "Input", 
               CellChangeTimes -> {{3.738600324036819*^9, 
                 3.738600353586584*^9}, {3.7386098225214663*^9, 
                 3.738609824948983*^9}, {3.738614008763254*^9, 
                 3.73861401096229*^9}, {3.7422648406364098*^9, 
                 3.742264852314206*^9}, {3.744750441791654*^9, 
                 3.744750442155787*^9}, {3.7536010008767567*^9, 
                 3.753601026356306*^9}, {3.753602637342009*^9, 
                 3.7536026449468927*^9}, {3.7561499569884663*^9, 
                 3.756149959616074*^9}, {3.7567738095370903*^9, 
                 3.7567738098734818*^9}, {3.7571864852521763*^9, 
                 3.75718648558016*^9}, {3.757306023904344*^9, 
                 3.757306024181562*^9}, {3.7575330512041197*^9, 
                 3.757533052097063*^9}, 3.7597906279487677*^9, 
                 {3.759819658175324*^9, 3.759819674105735*^9}, 
                 {3.759819753439424*^9, 3.759819759759369*^9}, 
                 3.7598198194745913*^9, 3.759866762907168*^9, 
                 {3.7599117286501827*^9, 3.759911729350462*^9}, 
                 {3.760136351353219*^9, 3.76013635183884*^9}, 
                 {3.7601370800850163*^9, 3.760137093902687*^9}, 
                 {3.7601601097942333*^9, 3.7601601107813253*^9}, 
                 {3.760160547393231*^9, 3.760160548373577*^9}}, CellLabel -> 
                "In[29]:="]}, Open]], Cell[CellGroupData[
             {Cell["r1r2Potential/Grid", "Subsubsection", CellChangeTimes -> 
                {{3.7601363058724737*^9, 3.760136312207178*^9}, 
                {3.76013700227542*^9, 3.760137006571597*^9}}], 
              Cell[BoxData[{RowBox[{"r1r2Potential", "//", "Clear"}], 
                 "\[IndentingNewLine]", RowBox[{RowBox[{RowBox[
                      {"r1r2Potential", "[", RowBox[{"{", RowBox[{"a_", ",", 
                          " ", "s_"}], "}"}], "]"}], ":=", 
                     "\[IndentingNewLine]", RowBox[{"getR1R2Potential", "[", 
                       RowBox[{"$fullPot", ",", " ", RowBox[{"{", RowBox[
                          {"a", ",", " ", "s"}], "}"}]}], "]"}]}], ";"}]}], 
               "Input", CellChangeTimes -> {{3.7386003625944366*^9, 
                 3.738600371985814*^9}, {3.738603918225898*^9, 
                 3.7386039551649227*^9}, {3.7386098333648567*^9, 
                 3.738609857182663*^9}, {3.738612068166306*^9, 
                 3.738612070756476*^9}, {3.738612168932646*^9, 
                 3.738612189034616*^9}, {3.7386122527025747*^9, 
                 3.738612261256266*^9}, {3.7386122962959957*^9, 
                 3.738612367358974*^9}, {3.738612400176401*^9, 
                 3.7386124027005177*^9}, {3.742178389715143*^9, 
                 3.742178520395451*^9}, {3.742178562423058*^9, 
                 3.742178594653269*^9}, {3.7421788020189533*^9, 
                 3.742178858384389*^9}, {3.742178902828765*^9, 
                 3.7421789142492313*^9}, {3.7421802654289217*^9, 
                 3.742180266531019*^9}, {3.7421808227131233*^9, 
                 3.742180833792638*^9}, {3.7421808849563513*^9, 
                 3.7421809103475027*^9}, {3.742180965110235*^9, 
                 3.742180965946213*^9}, 3.742181083946302*^9, 
                 {3.742181171293356*^9, 3.742181253937222*^9}, 
                 3.742183486811425*^9, {3.742183924841072*^9, 
                 3.742183926691185*^9}, {3.742184205756753*^9, 
                 3.742184207379163*^9}, {3.742184253444003*^9, 
                 3.742184256130295*^9}, {3.742184642941605*^9, 
                 3.742184643705871*^9}, {3.759790749551409*^9, 
                 3.759790749555571*^9}, {3.7598668010875397*^9, 
                 3.75986680109153*^9}, {3.760136144798627*^9, 
                 3.760136145494673*^9}, {3.760136810142991*^9, 
                 3.760136815271188*^9}, {3.760201571262149*^9, 
                 3.760201585400679*^9}, 3.760204981882679*^9}, CellLabel -> 
                "In[47]:="]}, Open]], Cell[CellGroupData[
             {Cell["r1r2GridObject", "Subsubsection", CellChangeTimes -> 
                {{3.760201626229467*^9, 3.760201627595529*^9}}], 
              Cell[BoxData[{RowBox[{RowBox[{"r1r2GridObject", "=", 
                     "\[IndentingNewLine]", RowBox[{"Catch", "@", RowBox[
                        {"$r1r2DVR", "[", "\"Grid\"", "]"}]}]}], ";"}], 
                 "\[IndentingNewLine]", RowBox[{RowBox[{"r1r2Grid", "=", 
                     RowBox[{"r1r2GridObject", "[", "\"Grid\"", "]"}]}], 
                   ";"}], "\[IndentingNewLine]", RowBox[{RowBox[
                    {"r1r2GridPts", "=", RowBox[{"r1r2GridObject", "[", 
                       "\"Points\"", "]"}]}], ";"}]}], "Input", 
               CellChangeTimes -> {{3.738611680080572*^9, 
                 3.738611684748712*^9}, {3.738611747448289*^9, 
                 3.738611750686493*^9}, {3.741709122250718*^9, 
                 3.741709122456314*^9}, {3.742170319233698*^9, 
                 3.742170321273416*^9}, {3.7421703861089897*^9, 
                 3.7421703956325817*^9}, {3.7421704393663597*^9, 
                 3.742170464102068*^9}, {3.7421753237238207*^9, 
                 3.7421753283346043*^9}, {3.742264917023877*^9, 
                 3.742264931729027*^9}, {3.7535954858299723*^9, 
                 3.753595499763126*^9}, {3.7536009641870823*^9, 
                 3.753600966475205*^9}, {3.756773821746509*^9, 
                 3.7567738219441423*^9}, 3.759790749671049*^9, 
                 {3.7597907906338787*^9, 3.7597907910287333*^9}, 
                 3.759790831086038*^9, 3.759791095917555*^9, 
                 {3.759819420198842*^9, 3.759819421540977*^9}, 
                 {3.7598195907474194*^9, 3.759819620951354*^9}, 
                 {3.7598198304188957*^9, 3.7598198613960752*^9}, 
                 {3.759819943975233*^9, 3.759819952347764*^9}, 
                 {3.7598199860056763*^9, 3.759819991700652*^9}, 
                 {3.759866776669352*^9, 3.7598668012401447*^9}, 
                 {3.760136346898827*^9, 3.7601363653945227*^9}, 
                 {3.7601369562226458*^9, 3.760136970144086*^9}, 
                 {3.76013710052636*^9, 3.7601371440553837*^9}, 
                 3.760204821335688*^9, {3.76025147378218*^9, 
                 3.760251477022559*^9}}]}, Open]]}, Open]], 
        Cell[CellGroupData[{Cell["Core Data", "Subsection", 
            CellChangeTimes -> {{3.745182414387413*^9, 
             3.7451824279780483*^9}, {3.759853128894742*^9, 
             3.759853140035264*^9}, {3.7598643542588797*^9, 
             3.759864355745146*^9}}], Cell[CellGroupData[
             {Cell["r1r2Wavefunctions", "Subsubsection", CellChangeTimes -> 
                {{3.7349066689507923*^9, 3.734906670492128*^9}, 
                 {3.741392660986568*^9, 3.741392677787201*^9}, 
                 {3.741533861513762*^9, 3.741533862723555*^9}, 
                 3.7601370188007317*^9}], Cell[TextData[{"Get ", 
                 Cell[BoxData[FormBox[SubscriptBox[StyleBox["H", FontSlant -> 
                       "Plain"], "2"], TraditionalForm]]], 
                 " wavefunctions parametrized by ", Cell[BoxData[FormBox[
                    RowBox[{"(", RowBox[{"s", ",", " ", "a"}], ")"}], 
                    TraditionalForm]]]}], "Text", CellChangeTimes -> 
                {{3.741382648677244*^9, 3.7413826637718763*^9}, 
                 3.757107597455894*^9}], Cell[BoxData[RowBox[{"debugPrint", 
                  "[", "\"Generating r1/r2 wavefunctions...\"", "]"}]], 
               "Input", CellChangeTimes -> {{3.760187183125944*^9, 
                 3.7601871915315104*^9}, 3.760187392749906*^9}], 
              Cell[BoxData[RowBox[{RowBox[{"r1r2Wavefunctions", "//", 
                    RowBox[{"cachedLoad", "@", "\[IndentingNewLine]", 
                      RowBox[{"getR1R2Wavefunctions", "[", 
                        "\[IndentingNewLine]", RowBox[{"$r1r2DVR", ",", " ", 
                          "r1r2Potential", ",", " ", "\[IndentingNewLine]", 
                          "r1r2GridObject", ",", " ", "saMainGrid"}], 
                        "\[IndentingNewLine]", "]"}]}]}], ";"}]], "Input", 
               CellChangeTimes -> {{3.76013689127212*^9, 
                 3.7601369799726763*^9}, {3.760137031803577*^9, 
                 3.7601370371562443*^9}, {3.760137131931427*^9, 
                 3.760137137401979*^9}, 3.760140136098703*^9, 
                 3.7601603186358843*^9, {3.760187207404633*^9, 
                 3.760187213075883*^9}, {3.760201682613964*^9, 
                 3.760201685907845*^9}, {3.760201738613866*^9, 
                 3.760201773400185*^9}}, CellLabel -> "In[150]:="], 
              Cell[BoxData[RowBox[{RowBox[{"r1r2PotMinima", "//", RowBox[
                     {"cachedLoad", "@", "\[IndentingNewLine]", RowBox[
                       {"getR1R2PotentialMin", "[", "\[IndentingNewLine]", 
                        RowBox[{"r1r2Potential", ",", " ", 
                          "\[IndentingNewLine]", "r1r2GridObject", ",", " ", 
                          "\[IndentingNewLine]", "saMainGrid"}], 
                        "\[IndentingNewLine]", "]"}]}]}], ";"}]], "Input", 
               CellChangeTimes -> {{3.76013689127212*^9, 
                 3.7601369799726763*^9}, {3.760137031803577*^9, 
                 3.7601370371562443*^9}, {3.760137131931427*^9, 
                 3.760137137401979*^9}, 3.760140136098703*^9, 
                 3.7601603186358843*^9, {3.760187207404633*^9, 
                 3.760187213075883*^9}, {3.760201682613964*^9, 
                 3.760201685907845*^9}, {3.760201738613866*^9, 
                 3.760201773400185*^9}, 3.760336297482826*^9, 
                 {3.760336327652169*^9, 3.7603363323051653*^9}, 
                 {3.760407712123085*^9, 3.760407721311943*^9}}], 
              Cell[BoxData[RowBox[{"debugPrint", "[", 
                  "\"Generated r1/r2 wavefunctions\"", "]"}]], "Input", 
               CellChangeTimes -> {{3.760187183125944*^9, 
                 3.760187199723749*^9}, 3.760187393887145*^9}]}, Open]], 
           Cell[CellGroupData[{Cell["SCF Procedure", "Subsubsection", 
               CellChangeTimes -> {{3.755534581540028*^9, 
                 3.755534585722755*^9}, 3.75730612579627*^9}], 
              Cell[CellGroupData[{Cell["SCF Wavefunction Computation", 
                  "Subsubsubsection", CellChangeTimes -> 
                   {{3.75614998871863*^9, 3.756149995784986*^9}}], 
                 Cell[BoxData[RowBox[{RowBox[{"r1r2SCFGrid", "=", RowBox[
                        {"scfGrid", "[", RowBox[{"$r1r2DVR", ",", " ", 
                          "$r1r2SCFBasisSize"}], "]"}]}], ";"}]], "Input", 
                  CellChangeTimes -> {{3.755895939054476*^9, 
                    3.755895973066475*^9}, {3.755896335567666*^9, 
                    3.755896340094911*^9}, 3.7559819005754337*^9, 
                    3.755982533782464*^9, {3.755996592420143*^9, 
                    3.7559965942010183*^9}, {3.755997664115162*^9, 
                    3.7559976665753403*^9}, 3.759790682353331*^9, 
                    3.7598196127892017*^9, {3.759866776683855*^9, 
                    3.759866801331318*^9}, {3.760133058937508*^9, 
                    3.760133067237391*^9}, 3.760133174949843*^9, 
                    {3.760137173180274*^9, 3.760137175202656*^9}, 
                    {3.760137226749943*^9, 3.760137293011792*^9}, 
                    {3.760137323876358*^9, 3.760137325370208*^9}, 
                    {3.760201792389049*^9, 3.7602017982182426*^9}, 
                    {3.760204893057396*^9, 3.760204897554676*^9}, 
                    3.76033653556149*^9}], Cell[BoxData[RowBox[
                    {RowBox[{"r1r2SCFStates", "=", "\[IndentingNewLine]", 
                       RowBox[{"{", "\[IndentingNewLine]", RowBox[
                          {RowBox[{"{", RowBox[{"1", ",", " ", "1"}], "}"}], 
                          ",", "\[IndentingNewLine]", " ", RowBox[{"{", 
                          RowBox[{"1", ",", " ", "2"}], "}"}], ",", " ", 
                          RowBox[{"{", RowBox[{"2", ",", " ", "1"}], "}"}], 
                          ",", " ", "\[IndentingNewLine]", RowBox[{"{", 
                          RowBox[{"3", ",", " ", "1"}], "}"}], ",", " ", 
                          RowBox[{"{", RowBox[{"2", ",", " ", "2"}], "}"}], 
                          ",", " ", RowBox[{"{", RowBox[{"1", ",", " ", 
                          "3"}], "}"}], ",", "\[IndentingNewLine]", RowBox[
                          {"{", RowBox[{"4", ",", " ", "1"}], "}"}], ",", 
                          " ", RowBox[{"{", RowBox[{"2", ",", " ", "3"}], 
                          "}"}], ",", " ", RowBox[{"{", RowBox[{"3", ",", 
                          " ", "2"}], "}"}], ",", " ", RowBox[{"{", RowBox[
                          {"1", ",", " ", "4"}], "}"}]}], 
                         "\[IndentingNewLine]", "}"}]}], ";"}]], "Input", 
                  CellChangeTimes -> {{3.755895939054476*^9, 
                    3.755895973066475*^9}, {3.755896335567666*^9, 
                    3.755896340094911*^9}, 3.7559819005754337*^9, 
                    3.755982533782464*^9, {3.755996592420143*^9, 
                    3.7559965942010183*^9}, {3.755997664115162*^9, 
                    3.7559976665753403*^9}, 3.759790682353331*^9, 
                    3.7598196127892017*^9, {3.759866776683855*^9, 
                    3.759866801331318*^9}, {3.760133058937508*^9, 
                    3.760133067237391*^9}, 3.760133174949843*^9, 
                    {3.760137173180274*^9, 3.760137175202656*^9}, 
                    {3.760137226749943*^9, 3.760137293011792*^9}, 
                    {3.760137323876358*^9, 3.7601373392522907*^9}, 
                    3.760150524774276*^9, 3.760150561487279*^9, 
                    3.76020181361124*^9}, CellLabel -> "In[42]:="], 
                 Cell[BoxData[RowBox[{"debugPrint", "[", 
                     "\"Generating SCF coefficients...\"", "]"}]], "Input", 
                  CellChangeTimes -> {{3.760187091967367*^9, 
                    3.760187114045287*^9}, 3.760187394417204*^9}], 
                 Cell[BoxData[RowBox[{RowBox[{"coeffChunkingLength", "=", 
                       "\[IndentingNewLine]", RowBox[{"Floor", "[", RowBox[
                          {RowBox[{"$saBasisSize", "^", "2"}], "/", 
                          "chunkCount"}], "]"}]}], ";"}]], "Input", 
                  CellChangeTimes -> {{3.7602052543284883*^9, 
                   3.760205277448164*^9}, {3.76020541735324*^9, 
                   3.7602054224476223*^9}, {3.7603365490519*^9, 
                   3.760336550304139*^9}, {3.760366871137122*^9, 
                   3.7603668713333387*^9}}], Cell[BoxData[RowBox[
                    {RowBox[{"coefficientData", "=", "\[IndentingNewLine]", 
                       RowBox[{"Join", "@@", "\[IndentingNewLine]", RowBox[
                          {"Map", "[", "\[IndentingNewLine]", RowBox[
                          {RowBox[{RowBox[{"With", "[", 
                          "\[IndentingNewLine]", RowBox[{RowBox[{"{", 
                          "\[IndentingNewLine]", RowBox[{RowBox[{"chunk", 
                          "=", "\[IndentingNewLine]", RowBox[{"ToExpression", 
                          "[", "\[IndentingNewLine]", RowBox[{RowBox[
                          {"\"coeffChunk\"", "<>", RowBox[{"ToString", "[", 
                          "#", "]"}]}], ",", " ", "\[IndentingNewLine]", 
                          "StandardForm", ",", "\[IndentingNewLine]", RowBox[
                          {"Function", "[", RowBox[{"Null", ",", "  ", RowBox[
                          {RowBox[{"Clear", "[", "#", "]"}], ";", "#"}], ",", 
                          " ", "HoldAllComplete"}], "]"}]}], 
                          "\[IndentingNewLine]", "]"}]}], ",", 
                          "\[IndentingNewLine]", RowBox[{"grid", "=", RowBox[
                          {"saGrid", "[", RowBox[{"[", RowBox[{RowBox[{"1", 
                          "+", RowBox[{RowBox[{"(", RowBox[{"#", "-", "1"}], 
                          ")"}], "*", "coeffChunkingLength"}]}], ";;", RowBox[
                          {"#", "*", "coeffChunkingLength"}]}], "]"}], 
                          "]"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
                          "\[IndentingNewLine]", RowBox[{RowBox[
                          {"cachedLoad", "[", "\[IndentingNewLine]", RowBox[
                          {"chunk", ",", "\[IndentingNewLine]", RowBox[
                          {"AssociationMap", "[", "\[IndentingNewLine]", 
                          RowBox[{RowBox[{RowBox[{"scfCoeffData", "[", 
                          "\[IndentingNewLine]", RowBox[{"$r1r21DDVR", ",", 
                          "\[IndentingNewLine]", "$r1r2DVR", ",", 
                          "\[IndentingNewLine]", "r1r2SCFGrid", ",", 
                          "\[IndentingNewLine]", "r1r2Potential", ",", 
                          "\[IndentingNewLine]", "r1r2SCFStates", ",", 
                          "\[IndentingNewLine]", "#", ",", 
                          "\[IndentingNewLine]", "$r1r2SCFBasisSize"}], 
                          "\[IndentingNewLine]", "]"}], "&"}], ",", " ", 
                          "\[IndentingNewLine]", "grid"}], 
                          "\[IndentingNewLine]", "]"}]}], 
                          "\[IndentingNewLine]", "]"}], ";", 
                          "\[IndentingNewLine]", "chunk"}]}], 
                          "\[IndentingNewLine]", "]"}], "&"}], ",", 
                          "\[IndentingNewLine]", RowBox[{"Range", "[", 
                          "chunkCount", "]"}]}], "\[IndentingNewLine]", 
                          "]"}]}]}], ";"}]], "Input", CellChangeTimes -> 
                   {{3.760205222027186*^9, 3.760205250674943*^9}, 
                    {3.760205280970044*^9, 3.7602054155126867*^9}, 
                    {3.760205446592951*^9, 3.7602054556076517*^9}, 
                    {3.7602054873775377*^9, 3.7602055043115664*^9}, 
                    {3.760205539867585*^9, 3.7602055429616203*^9}, 
                    {3.760205701864077*^9, 3.760205722147728*^9}, 
                    {3.760205778432932*^9, 3.7602058529523783*^9}, 
                    {3.76021556191291*^9, 3.760215563176201*^9}, 
                    3.760336538206601*^9}], Cell[BoxData[RowBox[
                    {"debugPrint", "[", "\"SCF coefficients calculated\"", 
                     "]"}]], "Input", CellChangeTimes -> 
                   {{3.7601871188230143*^9, 3.7601871223570747*^9}, 
                    3.760187394835105*^9}]}, Open]], Cell[CellGroupData[
                {Cell["Rephased Data", "Subsubsubsection", CellChangeTimes -> 
                   {{3.7598700872345467*^9, 3.759870088425372*^9}, 
                   {3.76013296999183*^9, 3.760132971806287*^9}}], 
                 Cell[BoxData[RowBox[{RowBox[{"rephasingData", "=", 
                       "\[IndentingNewLine]", RowBox[{"getPhaseCorrection", 
                         "[", RowBox[{RowBox[{"Values", "@", 
                          "r1r2Wavefunctions"}], ",", " ", RowBox[{"Keys", 
                          "[", "r1r2Wavefunctions", "]"}], ",", " ", RowBox[
                          {"Range", "[", RowBox[{"Length", "@", 
                          "r1r2SCFStates"}], "]"}]}], "]"}]}], ";"}]], 
                  "Input", CellChangeTimes -> {{3.757354866667294*^9, 
                    3.7573548760973597*^9}, {3.757354906250585*^9, 
                    3.757354941508438*^9}, {3.7573549958245277*^9, 
                    3.757355015183893*^9}, {3.757355080246973*^9, 
                    3.7573550946668673*^9}, {3.7573551491228*^9, 
                    3.757355155640161*^9}, {3.7573552817922363*^9, 
                    3.75735532217027*^9}, {3.757355492818199*^9, 
                    3.757355494055044*^9}, 3.757533420086323*^9, 
                    {3.759790749917697*^9, 3.7597907499210873*^9}, 
                    {3.7598532524600363*^9, 3.7598532671226807*^9}, 
                    3.7598621941935043*^9, {3.7598678811568747*^9, 
                    3.75986788115983*^9}, 3.760133228236951*^9, 
                    {3.760137395977487*^9, 3.760137416145588*^9}}, 
                  CellLabel -> "In[286]:="], Cell[BoxData[RowBox[
                    {RowBox[{"rephasedR1R2Wavefunctions", "=", 
                       "\[IndentingNewLine]", RowBox[{"AssociationThread", 
                         "[", "\[IndentingNewLine]", RowBox[{RowBox[{"Keys", 
                          "[", "r1r2Wavefunctions", "]"}], ",", 
                          "\[IndentingNewLine]", RowBox[{"rephasingData", 
                          "[", "\"Wavefunctions\"", "]"}]}], 
                         "\[IndentingNewLine]", "]"}]}], ";"}]], "Input", 
                  CellChangeTimes -> {{3.759911708366727*^9, 
                    3.7599117110878*^9}, 3.7599373190052423*^9, 
                    3.760137427329653*^9, {3.760140045265855*^9, 
                    3.7601400562818213*^9}, 3.760162215740651*^9}], 
                 Cell[BoxData[RowBox[{RowBox[{"phaseInCorrectDVR", "=", 
                       "\[IndentingNewLine]", RowBox[{RowBox[{RowBox[{"If", 
                          "[", RowBox[{RowBox[{"AssociationQ", "[", "#", 
                          "]"}], ",", " ", RowBox[{"#", "[", 
                          "\"DVRWavefunctions\"", "]"}], ",", " ", "#"}], 
                          "]"}], "&"}], "/@", "coefficientData"}]}], ";"}]], 
                  "Input", CellChangeTimes -> {{3.759907914014628*^9, 
                   3.759907922713056*^9}, {3.7601332239969683*^9, 
                   3.760133225306476*^9}}, CellLabel -> "In[288]:="], 
                 Cell[BoxData[RowBox[{RowBox[{"dvrPhaseCorrectionVector", 
                       "=", RowBox[{"{", RowBox[{"1", ",", " ", "1", ",", 
                          "1", ",", " ", "1", ",", " ", "1", ",", " ", "1"}], 
                         "}"}]}], ";"}]], "Input", CellChangeTimes -> 
                   {{3.760137721064549*^9, 3.760137729880919*^9}, 
                    3.760458211431986*^9, {3.760458307277974*^9, 
                    3.760458354174116*^9}}], Cell[BoxData[RowBox[{"(*", 
                     RowBox[{RowBox[{"phaseCorrectDVR", "//", RowBox[
                          {"cachedLoad", "[", "\[IndentingNewLine]", RowBox[
                          {RowBox[{"getPhaseCorrection", "[", 
                          "\[IndentingNewLine]", RowBox[{RowBox[{RowBox[
                          {RowBox[{RowBox[{"If", "[", RowBox[{RowBox[
                          {"AssociationQ", "[", "#", "]"}], ",", " ", RowBox[
                          {"#", "[", "\"DVRWavefunctions\"", "]"}], ",", " ", 
                          "#"}], "]"}], "&"}], "/@", "\[IndentingNewLine]", 
                          "coefficientData"}], "//", "Values"}], ",", " ", 
                          "\[IndentingNewLine]", RowBox[{"Keys", "[", 
                          "r1r2Wavefunctions", "]"}], ",", 
                          "\[IndentingNewLine]", RowBox[{"Range", "[", RowBox[
                          {"Length", "[", "dvrPhaseCorrectionVector", "]"}], 
                          "]"}], ",", "\[IndentingNewLine]", 
                          "dvrPhaseCorrectionVector", ",", 
                          "\[IndentingNewLine]", "True"}], 
                          "\[IndentingNewLine]", "]"}], "[", 
                          "\"Wavefunctions\"", "]"}], "\[IndentingNewLine]", 
                          "]"}]}], ";"}], "*)"}]], "Input", 
                  CellChangeTimes -> {{3.759869253055719*^9, 
                    3.759869284920835*^9}, {3.759869318864256*^9, 
                    3.7598693266562653*^9}, {3.759869369935828*^9, 
                    3.7598694573242702*^9}, 3.75986981212077*^9, 
                    3.75986989817651*^9, {3.7598699985486097*^9, 
                    3.759870017587022*^9}, {3.759870051356366*^9, 
                    3.759870051858138*^9}, {3.759872102003231*^9, 
                    3.759872105432124*^9}, {3.75987219446397*^9, 
                    3.759872198990748*^9}, {3.75987660668225*^9, 
                    3.7598766087149754*^9}, {3.759904938356359*^9, 
                    3.759904948576049*^9}, 3.759906939880468*^9, 
                    3.760137435577183*^9, {3.7601377201154137*^9, 
                    3.760137734945304*^9}, 3.7602180571212254*^9, 
                    3.760218508861575*^9, {3.760222362595249*^9, 
                    3.760222368454954*^9}}], Cell[BoxData[RowBox[
                    {RowBox[{"phaseCorrectSCF", "//", RowBox[{"cachedLoad", 
                         "[", "\[IndentingNewLine]", RowBox[{RowBox[
                          {"getPhaseCorrection", "[", "\[IndentingNewLine]", 
                          RowBox[{RowBox[{RowBox[{RowBox[{RowBox[{"If", "[", 
                          RowBox[{RowBox[{"AssociationQ", "[", "#", "]"}], 
                          ",", " ", RowBox[{"#", "[", "\"SCFWavefunctions\"", 
                          "]"}], ",", " ", "#"}], "]"}], "&"}], "/@", 
                          "\[IndentingNewLine]", "coefficientData"}], "//", 
                          "Values"}], ",", " ", "\[IndentingNewLine]", RowBox[
                          {"Keys", "[", "r1r2Wavefunctions", "]"}], ",", 
                          "\[IndentingNewLine]", RowBox[{"{", "2", "}"}], 
                          ",", "\[IndentingNewLine]", "True"}], 
                          "\[IndentingNewLine]", "]"}], "[", 
                          "\"Wavefunctions\"", "]"}], "\[IndentingNewLine]", 
                         "]"}]}], ";"}]], "Input", CellChangeTimes -> 
                   {3.761415082677841*^9, {3.76141513399758*^9, 
                    3.7614151387873907*^9}}], Cell[BoxData[RowBox[
                    {RowBox[{"scfPhaseCorrectionVector", "=", RowBox[
                        {"{", RowBox[{"1", ",", " ", "1", ",", " ", "1", ",", 
                          " ", "1", ",", " ", "1", ",", " ", "1"}], "}"}]}], 
                     ";"}]], "Input", CellChangeTimes -> 
                   {{3.76013774295205*^9, 3.76013775571097*^9}, 
                    3.760458213504023*^9, 3.7604583531923113*^9}], 
                 Cell[BoxData[RowBox[{"(*", RowBox[{RowBox[
                        {"phaseCorrectSCF", "//", RowBox[{"cachedLoad", "[", 
                          "\[IndentingNewLine]", RowBox[{RowBox[
                          {"getPhaseCorrection", "[", "\[IndentingNewLine]", 
                          RowBox[{RowBox[{RowBox[{RowBox[{RowBox[{"If", "[", 
                          RowBox[{RowBox[{"AssociationQ", "[", "#", "]"}], 
                          ",", " ", RowBox[{"#", "[", "\"SCFWavefunctions\"", 
                          "]"}], ",", " ", "#"}], "]"}], "&"}], "/@", 
                          "\[IndentingNewLine]", "coefficientData"}], "//", 
                          "Values"}], ",", " ", "\[IndentingNewLine]", RowBox[
                          {"Keys", "[", "r1r2Wavefunctions", "]"}], ",", 
                          "\[IndentingNewLine]", RowBox[{"Range", "[", RowBox[
                          {"Length", "[", "scfPhaseCorrectionVector", "]"}], 
                          "]"}], ",", "\[IndentingNewLine]", 
                          "scfPhaseCorrectionVector", ",", 
                          "\[IndentingNewLine]", "True"}], 
                          "\[IndentingNewLine]", "]"}], "[", 
                          "\"Wavefunctions\"", "]"}], "\[IndentingNewLine]", 
                          "]"}]}], ";"}], "*)"}]], "Input", 
                  CellChangeTimes -> {{3.7598700585623426*^9, 
                    3.7598700705457497*^9}, {3.75987016062735*^9, 
                    3.759870160752399*^9}, {3.759870248995981*^9, 
                    3.7598702511993017*^9}, {3.759871156889234*^9, 
                    3.759871159368202*^9}, {3.759871214914813*^9, 
                    3.759871215423099*^9}, {3.759871305239141*^9, 
                    3.759871310279468*^9}, {3.759871426533576*^9, 
                    3.7598714330754232*^9}, {3.759871507160804*^9, 
                    3.759871516009961*^9}, {3.759871572699088*^9, 
                    3.759871624064271*^9}, {3.75987668849154*^9, 
                    3.759876692472672*^9}, 3.760137438521284*^9, 
                    {3.7601377589306087*^9, 3.760137761906929*^9}, 
                    {3.760218051765596*^9, 3.760218053916019*^9}, 
                    3.760218507141535*^9, {3.760222352210609*^9, 
                    3.760222373510797*^9}}], Cell[BoxData[RowBox[
                    {RowBox[{"phaseCorrectSCF", "//", RowBox[{"cachedLoad", 
                         "[", "\[IndentingNewLine]", RowBox[{RowBox[
                          {"getPhaseCorrection", "[", "\[IndentingNewLine]", 
                          RowBox[{RowBox[{RowBox[{RowBox[{RowBox[{"If", "[", 
                          RowBox[{RowBox[{"AssociationQ", "[", "#", "]"}], 
                          ",", " ", RowBox[{"#", "[", "\"SCFWavefunctions\"", 
                          "]"}], ",", " ", "#"}], "]"}], "&"}], "/@", 
                          "\[IndentingNewLine]", "coefficientData"}], "//", 
                          "Values"}], ",", " ", "\[IndentingNewLine]", RowBox[
                          {"Keys", "[", "r1r2Wavefunctions", "]"}], ",", 
                          "\[IndentingNewLine]", RowBox[{"{", "2", "}"}], 
                          ",", "\[IndentingNewLine]", "True"}], 
                          "\[IndentingNewLine]", "]"}], "[", 
                          "\"Wavefunctions\"", "]"}], "\[IndentingNewLine]", 
                         "]"}]}], ";"}]], "Input", CellChangeTimes -> 
                   {3.761415082677841*^9, {3.76141513399758*^9, 
                    3.7614151387873907*^9}}]}, Open]], Cell[CellGroupData[
                {Cell["SCF Phases 1 Quantum", "Subsubsubsection", 
                  CellChangeTimes -> {{3.757779727491561*^9, 
                    3.757779732605317*^9}, 3.759853115985839*^9, 
                    {3.759853147019318*^9, 3.759853159476714*^9}}], 
                 Cell[BoxData[RowBox[{RowBox[{RowBox[{"{", RowBox[
                          {"overlapMatrixOneQuantum", ",", " ", 
                          "goodSparseOneQuantum"}], "}"}], "=", 
                       "\[IndentingNewLine]", RowBox[{"getSCFOverlapMatrix", 
                         "[", RowBox[{"phaseCorrectSCF", ",", " ", 
                          "phaseCorrectDVR", ",", " ", RowBox[{"{", RowBox[
                          {"2", ",", " ", "3"}], "}"}], ",", " ", 
                          "oneQuantumPhaseCorrection"}], "]"}]}], ";"}]], 
                  "Input", CellChangeTimes -> {{3.757354866667294*^9, 
                    3.7573548760973597*^9}, {3.757354906250585*^9, 
                    3.757354941508438*^9}, {3.7573549958245277*^9, 
                    3.757355015183893*^9}, {3.757355080246973*^9, 
                    3.7573550946668673*^9}, {3.7573551491228*^9, 
                    3.757355155640161*^9}, {3.7573552817922363*^9, 
                    3.75735532217027*^9}, {3.757355492818199*^9, 
                    3.757355494055044*^9}, 3.757533420086323*^9, 
                    {3.759790749917697*^9, 3.7597907499210873*^9}, 
                    {3.7598532524600363*^9, 3.759853292147922*^9}, 
                    3.7598678811664753*^9, {3.759867944734968*^9, 
                    3.7598680016292267*^9}, 3.7598683425877237*^9, 
                    {3.7598700964014807*^9, 3.759870155097356*^9}, 
                    {3.759870271822544*^9, 3.759870282606887*^9}, 
                    {3.759870345855404*^9, 3.759870469148584*^9}, 
                    3.7598705327350607*^9, {3.759870563322926*^9, 
                    3.759870563610783*^9}, 3.759871057006386*^9, 
                    {3.759871121706298*^9, 3.759871135157216*^9}, 
                    3.759871167685328*^9, 3.759871769717258*^9, 
                    {3.759871928872045*^9, 3.759872040221674*^9}, 
                    {3.759872216442994*^9, 3.759872425372468*^9}, 
                    {3.759872476368827*^9, 3.759872532794771*^9}, 
                    {3.7598725712536793*^9, 3.75987260036141*^9}, 
                    {3.75987677928537*^9, 3.759876872658758*^9}, 
                    {3.7598781876051207*^9, 3.759878204714904*^9}, 
                    3.759904953852916*^9, {3.759905147431938*^9, 
                    3.759905149958387*^9}, 3.759905215628162*^9, 
                    3.759906954536406*^9, {3.7601377740192137*^9, 
                    3.760137792796372*^9}, {3.760137862405068*^9, 
                    3.7601378674774237*^9}, 3.760138159734466*^9, 
                    {3.76020199958432*^9, 3.760202011576385*^9}, 
                    {3.7602184990223083*^9, 3.76021850571039*^9}, 
                    {3.760458386725739*^9, 3.7604583891282663*^9}}]}, Open]], 
              Cell[CellGroupData[{Cell["SCF Phases 2 Quanta", 
                  "Subsubsubsection", CellChangeTimes -> 
                   {{3.757779727491561*^9, 3.757779732605317*^9}, 
                    3.759853115985839*^9, {3.759853147019318*^9, 
                    3.7598531488514767*^9}, {3.75987151874718*^9, 
                    3.75987151967529*^9}, 3.759910817272098*^9}], 
                 Cell[BoxData[RowBox[{RowBox[{RowBox[{"{", RowBox[
                          {"overlapMatrixTwoQuanta", ",", " ", 
                          "goodSparseTwoQuanta"}], "}"}], "=", 
                       "\[IndentingNewLine]", RowBox[{"getSCFOverlapMatrix", 
                         "[", RowBox[{"phaseCorrectSCF", ",", " ", 
                          "phaseCorrectDVR", ",", " ", RowBox[{"{", RowBox[
                          {"4", ",", " ", "5", ",", " ", "6"}], "}"}], ",", 
                          " ", "twoQuantaPhaseCorrection"}], "]"}]}], ";"}]], 
                  "Input", CellChangeTimes -> {{3.757354866667294*^9, 
                    3.7573548760973597*^9}, {3.757354906250585*^9, 
                    3.757354941508438*^9}, {3.7573549958245277*^9, 
                    3.757355015183893*^9}, {3.757355080246973*^9, 
                    3.7573550946668673*^9}, {3.7573551491228*^9, 
                    3.757355155640161*^9}, {3.7573552817922363*^9, 
                    3.75735532217027*^9}, {3.757355492818199*^9, 
                    3.757355494055044*^9}, 3.757533420086323*^9, 
                    {3.759790749917697*^9, 3.7597907499210873*^9}, 
                    {3.7598532524600363*^9, 3.759853292147922*^9}, 
                    3.7598678811664753*^9, {3.759867944734968*^9, 
                    3.7598680016292267*^9}, 3.7598683425877237*^9, 
                    {3.7598700964014807*^9, 3.759870155097356*^9}, 
                    {3.759870271822544*^9, 3.759870282606887*^9}, 
                    {3.759870345855404*^9, 3.759870469148584*^9}, 
                    {3.759870522259987*^9, 3.759870559820251*^9}, 
                    {3.759877680197548*^9, 3.759877704115224*^9}, 
                    {3.75987773509205*^9, 3.759877751338303*^9}, 
                    {3.759877820234329*^9, 3.759877827067329*^9}, 
                    {3.759878152670156*^9, 3.759878182869166*^9}, 
                    {3.759878530615588*^9, 3.759878552800105*^9}, 
                    3.759878677109784*^9, 3.7598788783732767*^9, 
                    3.759879064343486*^9, 3.7598791450143003*^9, 
                    {3.759879202355783*^9, 3.759879203841838*^9}, 
                    {3.759905232764511*^9, 3.759905237446578*^9}, 
                    {3.759905276745636*^9, 3.759905279382187*^9}, 
                    {3.7599064122335243*^9, 3.759906414048181*^9}, 
                    {3.759906637769578*^9, 3.7599066464706907*^9}, 
                    {3.7599069600041103*^9, 3.759906965193306*^9}, 
                    {3.7599075726022997*^9, 3.759907581888384*^9}, 
                    {3.7599076722016287*^9, 3.759907676493487*^9}, 
                    {3.759907822386586*^9, 3.7599078395711603*^9}, 
                    {3.759907928959003*^9, 3.759907939477274*^9}, 
                    3.759908688432073*^9, 3.7599089327503433*^9, 
                    {3.7599089758889627*^9, 3.7599089935886374*^9}, 
                    {3.75990931946115*^9, 3.759909321531261*^9}, 
                    3.759910814345253*^9, 3.759910961176053*^9, 
                    3.7599110711166077*^9, {3.759911171863608*^9, 
                    3.759911177494233*^9}, {3.75991157065758*^9, 
                    3.759911642464162*^9}, 3.7599117885502377*^9, 
                    {3.75991189124507*^9, 3.759911900241696*^9}, 
                    {3.759912075999827*^9, 3.7599120792563066*^9}, 
                    3.7599123111677313*^9, {3.759912343078109*^9, 
                    3.759912377686839*^9}, 3.759912648421782*^9, 
                    {3.76013807041438*^9, 3.7601380836896267*^9}, 
                    {3.760138129818645*^9, 3.760138160584178*^9}, 
                    3.760202027303288*^9, 3.760458392752924*^9}]}, Open]], 
              Cell[CellGroupData[{Cell["SCF Phases 1 and 2 Quanta", 
                  "Subsubsubsection", CellChangeTimes -> 
                   {{3.757779727491561*^9, 3.757779732605317*^9}, 
                    3.759853115985839*^9, {3.759853147019318*^9, 
                    3.7598531488514767*^9}, {3.75987151874718*^9, 
                    3.75987151967529*^9}, 3.759910817272098*^9, 
                    {3.75991262834321*^9, 3.759912630735252*^9}, 
                    3.7602020756965017*^9}], Cell[BoxData[RowBox[
                    {RowBox[{RowBox[{"{", RowBox[
                          {"overlapMatrixOneAndTwoQuanta", ",", " ", 
                          "goodSparseOneAndTwoQuanta"}], "}"}], "=", 
                       "\[IndentingNewLine]", RowBox[{"getSCFOverlapMatrix", 
                         "[", RowBox[{"phaseCorrectSCF", ",", " ", 
                          "phaseCorrectDVR", ",", " ", RowBox[{"{", RowBox[
                          {"2", ",", " ", "3", ",", " ", "4", ",", " ", "5", 
                          ",", " ", "6"}], "}"}], ",", " ", 
                          "\[IndentingNewLine]", RowBox[{"Join", "[", RowBox[
                          {"oneQuantumPhaseCorrection", ",", " ", 
                          "twoQuantaPhaseCorrection"}], "]"}]}], 
                         "\[IndentingNewLine]", "]"}]}], ";"}]], "Input", 
                  CellChangeTimes -> {{3.757354866667294*^9, 
                    3.7573548760973597*^9}, {3.757354906250585*^9, 
                    3.757354941508438*^9}, {3.7573549958245277*^9, 
                    3.757355015183893*^9}, {3.757355080246973*^9, 
                    3.7573550946668673*^9}, {3.7573551491228*^9, 
                    3.757355155640161*^9}, {3.7573552817922363*^9, 
                    3.75735532217027*^9}, {3.757355492818199*^9, 
                    3.757355494055044*^9}, 3.757533420086323*^9, 
                    {3.759790749917697*^9, 3.7597907499210873*^9}, 
                    {3.7598532524600363*^9, 3.759853292147922*^9}, 
                    3.7598678811664753*^9, {3.759867944734968*^9, 
                    3.7598680016292267*^9}, 3.7598683425877237*^9, 
                    {3.7598700964014807*^9, 3.759870155097356*^9}, 
                    {3.759870271822544*^9, 3.759870282606887*^9}, 
                    {3.759870345855404*^9, 3.759870469148584*^9}, 
                    {3.759870522259987*^9, 3.759870559820251*^9}, 
                    {3.759877680197548*^9, 3.759877704115224*^9}, 
                    {3.75987773509205*^9, 3.759877751338303*^9}, 
                    {3.759877820234329*^9, 3.759877827067329*^9}, 
                    {3.759878152670156*^9, 3.759878182869166*^9}, 
                    {3.759878530615588*^9, 3.759878552800105*^9}, 
                    3.759878677109784*^9, 3.7598788783732767*^9, 
                    3.759879064343486*^9, 3.7598791450143003*^9, 
                    {3.759879202355783*^9, 3.759879203841838*^9}, 
                    {3.759905232764511*^9, 3.759905237446578*^9}, 
                    {3.759905276745636*^9, 3.759905279382187*^9}, 
                    {3.7599064122335243*^9, 3.759906414048181*^9}, 
                    {3.759906637769578*^9, 3.7599066464706907*^9}, 
                    {3.7599069600041103*^9, 3.759906965193306*^9}, 
                    {3.7599075726022997*^9, 3.759907581888384*^9}, 
                    {3.7599076722016287*^9, 3.759907676493487*^9}, 
                    {3.759907822386586*^9, 3.7599078395711603*^9}, 
                    {3.759907928959003*^9, 3.759907939477274*^9}, 
                    3.759908688432073*^9, 3.7599089327503433*^9, 
                    {3.7599089758889627*^9, 3.7599089935886374*^9}, 
                    {3.75990931946115*^9, 3.759909321531261*^9}, 
                    3.759910814345253*^9, 3.759910961176053*^9, 
                    3.7599110711166077*^9, {3.759911171863608*^9, 
                    3.759911177494233*^9}, {3.75991157065758*^9, 
                    3.759911642464162*^9}, 3.7599117885502377*^9, 
                    {3.75991189124507*^9, 3.759911900241696*^9}, 
                    {3.759912075999827*^9, 3.7599120792563066*^9}, 
                    3.7599123111677313*^9, {3.759912343078109*^9, 
                    3.759912377686839*^9}, {3.7599126331062098*^9, 
                    3.7599126651899443*^9}, {3.7599127102264957*^9, 
                    3.75991271362532*^9}, {3.76013811215163*^9, 
                    3.7601381617184973*^9}, 3.7602020318658247*^9, 
                    {3.760458361670746*^9, 3.7604583847390413*^9}}]}, Open]], 
              Cell[CellGroupData[{Cell["$OverlapMatrices", 
                  "Subsubsubsection", CellChangeTimes -> 
                   {3.760139206508644*^9}], Cell[BoxData[RowBox[
                    {RowBox[{"$OverlapMatrices", "=", "\[IndentingNewLine]", 
                       RowBox[{"<|", "\[IndentingNewLine]", RowBox[
                          {RowBox[{"\"NoQuanta\"", "\[Rule]", 
                          "overlapMatrixNoQuanta"}], ",", 
                          "\[IndentingNewLine]", RowBox[{"\"OneQuantum\"", 
                          "\[Rule]", "overlapMatrixOneQuantum"}], ",", 
                          "\[IndentingNewLine]", RowBox[{"\"TwoQuanta\"", 
                          "\[Rule]", "overlapMatrixTwoQuanta"}], ",", 
                          "\[IndentingNewLine]", RowBox[
                          {"\"OneAndTwoQuanta\"", "->", 
                          "overlapMatrixOneAndTwoQuanta"}]}], 
                         "\[IndentingNewLine]", "|>"}]}], ";"}]], "Input", 
                  CellChangeTimes -> {{3.760139207156163*^9, 
                   3.760139238159298*^9}, {3.760163717791626*^9, 
                   3.7601637210835867*^9}}, CellLabel -> "In[466]:="]}, 
                Open]]}, Open]]}, Open]], Cell[CellGroupData[
          {Cell["Wavefunctions", "Subsection", CellChangeTimes -> 
             {{3.745345876844707*^9, 3.7453458789404716*^9}, 
             {3.757188013003214*^9, 3.757188014634042*^9}}], 
           Cell[CellGroupData[{Cell["Results", "Subsubsection", 
               CellChangeTimes -> {{3.755997049266605*^9, 
                3.755997052040826*^9}}], Cell[CellGroupData[
                {Cell["No Quanta", "Subsubsubsection", CellChangeTimes -> 
                   {{3.759863270956705*^9, 3.75986327465889*^9}}], 
                 Cell[BoxData[RowBox[{"debugPrint", "[", 
                     "\"Generating 4D wavefunctions...\"", "]"}]], "Input", 
                  CellChangeTimes -> {{3.7601872871034718*^9, 
                    3.76018730193007*^9}, 3.7601873954374228*^9}], 
                 Cell[BoxData[RowBox[{"noQuantaWfns", "=", 
                     "\[IndentingNewLine]", RowBox[{"getWavefunctions", "[", 
                       "\[IndentingNewLine]", RowBox[{"r1r2Wavefunctions", 
                         ",", "\[IndentingNewLine]", " ", "$saDVR", ",", " ", 
                         "\[IndentingNewLine]", RowBox[{"ConstantArray", "[", 
                          RowBox[{"1", ",", RowBox[{RowBox[{"(", RowBox[
                          {"$saBasisSize", "^", "2"}], ")"}], "*", RowBox[
                          {"{", RowBox[{"1", ",", " ", "1"}], "}"}]}]}], " ", 
                          "]"}], ",", " ", "\[IndentingNewLine]", 
                         "saMainGrid", ",", " ", "\[IndentingNewLine]", 
                         "1"}], "\[IndentingNewLine]", "]"}]}]], "Input", 
                  CellChangeTimes -> {{3.759863278149651*^9, 
                    3.7598633380347147*^9}, {3.7598667630526247*^9, 
                    3.759866763056095*^9}, {3.760147823470819*^9, 
                    3.7601478706641493*^9}, {3.7601500903606863*^9, 
                    3.760150093033263*^9}, 3.760160405152196*^9, 
                    3.7601605176559763*^9, {3.7601605760800056*^9, 
                    3.7601605983008013*^9}, 3.760161285420577*^9, 
                    {3.7602021035551977*^9, 3.7602022650363398*^9}, 
                    {3.760219926814741*^9, 3.760219927360005*^9}}]}, Open]], 
              Cell[CellGroupData[{Cell["One Quantum", "Subsubsubsection", 
                  CellChangeTimes -> {{3.759863201853817*^9, 
                    3.7598632047720013*^9}, 3.759863241299552*^9, 
                    {3.7601381979370327*^9, 3.760138198639455*^9}}], 
                 Cell[BoxData[RowBox[{"oneQuantumWfns", "=", 
                     "\[IndentingNewLine]", RowBox[{"getWavefunctions", "[", 
                       "\[IndentingNewLine]", RowBox[{"r1r2Wavefunctions", 
                         ",", "\[IndentingNewLine]", " ", "$saDVR", ",", " ", 
                         "\[IndentingNewLine]", "goodSparseOneQuantum", ",", 
                         " ", "\[IndentingNewLine]", "saMainGrid", ",", " ", 
                         "\[IndentingNewLine]", "2", ",", " ", "3"}], 
                       "\[IndentingNewLine]", "]"}]}]], "Input", 
                  CellChangeTimes -> {{3.7451704324353943*^9, 
                    3.7451704939708557*^9}, {3.745170636805746*^9, 
                    3.745170637738531*^9}, {3.7451707756518106*^9, 
                    3.745170785832059*^9}, {3.745910750525032*^9, 
                    3.74591076049893*^9}, {3.745936753573188*^9, 
                    3.745936754486637*^9}, {3.7559880313632917*^9, 
                    3.755988051887361*^9}, {3.755988133202392*^9, 
                    3.7559882074390793*^9}, 3.755988354481037*^9, 
                    {3.7559886554565277*^9, 3.755988656471874*^9}, 
                    {3.755991090352387*^9, 3.7559910934634867*^9}, 
                    3.755994621351981*^9, {3.7559963491472197*^9, 
                    3.755996355921508*^9}, {3.755996408002249*^9, 
                    3.75599641758843*^9}, {3.755997293648031*^9, 
                    3.755997294005706*^9}, 3.7559973366490803*^9, 
                    {3.7560469406176777*^9, 3.756046941165394*^9}, 
                    {3.7560469874032173*^9, 3.756047001468123*^9}, 
                    {3.756072246357415*^9, 3.756072246578965*^9}, 
                    {3.756150894900334*^9, 3.756150898233931*^9}, 
                    {3.756156370299522*^9, 3.756156370647628*^9}, 
                    3.756160647431408*^9, {3.756162513639196*^9, 
                    3.756162514317853*^9}, 3.7561688155087013*^9, 
                    {3.7567751180616693*^9, 3.756775118461627*^9}, 
                    {3.756775286597139*^9, 3.7567753057515593*^9}, 
                    {3.756775962376075*^9, 3.756775965951539*^9}, 
                    {3.756776119883643*^9, 3.756776120330359*^9}, 
                    {3.7572682665138893*^9, 3.757268272944707*^9}, 
                    {3.7573097464934998*^9, 3.757309746716404*^9}, 
                    {3.7575463689104137*^9, 3.7575463691883087*^9}, 
                    {3.757805123293702*^9, 3.757805123408701*^9}, 
                    3.759819613172501*^9, {3.7598632082477293*^9, 
                    3.7598632122769012*^9}, {3.759863254080076*^9, 
                    3.759863285400076*^9}, {3.759863476931889*^9, 
                    3.759863480744416*^9}, 3.75986680163024*^9, 
                    3.7598680563237457*^9, 3.760138309569182*^9, 
                    {3.760147851534829*^9, 3.760147889924096*^9}, 
                    3.760150097201185*^9, 3.7601607379330893*^9, 
                    {3.7601607768565693*^9, 3.760160780284992*^9}, 
                    {3.7601608948037767*^9, 3.760160897703988*^9}, 
                    3.760161280778026*^9, {3.760202241291862*^9, 
                    3.760202267285075*^9}, 3.760202307854497*^9, 
                    3.7602199295006943*^9}]}, Open]], Cell[CellGroupData[
                {Cell["Two Quanta", "Subsubsubsection", CellChangeTimes -> 
                   {{3.759863201853817*^9, 3.7598632047720013*^9}, 
                    3.759863241299552*^9, {3.759863559360339*^9, 
                    3.759863562030024*^9}, 3.759864913613227*^9}], 
                 Cell[BoxData[RowBox[{"twoQuantaWfns", "=", 
                     "\[IndentingNewLine]", RowBox[{"getWavefunctions", "[", 
                       "\[IndentingNewLine]", RowBox[{"r1r2Wavefunctions", 
                         ",", "\[IndentingNewLine]", " ", "$saDVR", ",", " ", 
                         "\[IndentingNewLine]", "goodSparseTwoQuanta", ",", 
                         " ", "\[IndentingNewLine]", "saMainGrid", ",", " ", 
                         "\[IndentingNewLine]", "4", ",", " ", "5", ",", " ", 
                         "6"}], "\[IndentingNewLine]", "]"}]}]], "Input", 
                  CellChangeTimes -> {{3.7451704324353943*^9, 
                    3.7451704939708557*^9}, {3.745170636805746*^9, 
                    3.745170637738531*^9}, {3.7451707756518106*^9, 
                    3.745170785832059*^9}, {3.745910750525032*^9, 
                    3.74591076049893*^9}, {3.745936753573188*^9, 
                    3.745936754486637*^9}, {3.7559880313632917*^9, 
                    3.755988051887361*^9}, {3.755988133202392*^9, 
                    3.7559882074390793*^9}, 3.755988354481037*^9, 
                    {3.7559886554565277*^9, 3.755988656471874*^9}, 
                    {3.755991090352387*^9, 3.7559910934634867*^9}, 
                    3.755994621351981*^9, {3.7559963491472197*^9, 
                    3.755996355921508*^9}, {3.755996408002249*^9, 
                    3.75599641758843*^9}, {3.755997293648031*^9, 
                    3.755997294005706*^9}, 3.7559973366490803*^9, 
                    {3.7560469406176777*^9, 3.756046941165394*^9}, 
                    {3.7560469874032173*^9, 3.756047001468123*^9}, 
                    {3.756072246357415*^9, 3.756072246578965*^9}, 
                    {3.756150894900334*^9, 3.756150898233931*^9}, 
                    {3.756156370299522*^9, 3.756156370647628*^9}, 
                    3.756160647431408*^9, {3.756162513639196*^9, 
                    3.756162514317853*^9}, 3.7561688155087013*^9, 
                    {3.7567751180616693*^9, 3.756775118461627*^9}, 
                    {3.756775286597139*^9, 3.7567753057515593*^9}, 
                    {3.756775962376075*^9, 3.756775965951539*^9}, 
                    {3.756776119883643*^9, 3.756776120330359*^9}, 
                    {3.7572682665138893*^9, 3.757268272944707*^9}, 
                    {3.7573097464934998*^9, 3.757309746716404*^9}, 
                    {3.7575463689104137*^9, 3.7575463691883087*^9}, 
                    {3.757805123293702*^9, 3.757805123408701*^9}, 
                    3.759819613172501*^9, {3.7598632082477293*^9, 
                    3.7598632122769012*^9}, {3.759863254080076*^9, 
                    3.759863285400076*^9}, {3.759863476931889*^9, 
                    3.759863480744416*^9}, {3.759863563336294*^9, 
                    3.7598635902979183*^9}, 3.75986680164673*^9, 
                    {3.759868057969713*^9, 3.7598680601286087*^9}, 
                    {3.7599097121079187*^9, 3.759909724486381*^9}, 
                    {3.7599108466628428*^9, 3.759910847942936*^9}, 
                    {3.7599115466992207*^9, 3.759911547244204*^9}, 
                    {3.759911941716371*^9, 3.7599119434203453*^9}, 
                    3.7601383133830853*^9, {3.760138410004464*^9, 
                    3.7601384426639767*^9}, {3.760147896893935*^9, 
                    3.760147910076632*^9}, 3.760150099937036*^9, 
                    {3.760202273992105*^9, 3.760202285372114*^9}, 
                    3.7602199331802464*^9}]}, Open]], Cell[CellGroupData[
                {Cell["One and Two Quanta", "Subsubsubsection", 
                  CellChangeTimes -> {{3.759912693802414*^9, 
                   3.7599126968616858*^9}}], Cell[BoxData[RowBox[
                    {"oneAndTwoQuantaWfns", "=", "\[IndentingNewLine]", 
                     RowBox[{"getWavefunctions", "[", "\[IndentingNewLine]", 
                       RowBox[{"r1r2Wavefunctions", ",", 
                         "\[IndentingNewLine]", " ", "$saDVR", ",", " ", 
                         "\[IndentingNewLine]", "goodSparseOneAndTwoQuanta", 
                         ",", " ", "\[IndentingNewLine]", "saMainGrid", ",", 
                         " ", "\[IndentingNewLine]", "2", ",", " ", "3", ",", 
                         " ", "4", ",", " ", "5", ",", " ", "6"}], 
                       "\[IndentingNewLine]", "]"}]}]], "Input", 
                  CellChangeTimes -> {{3.7451704324353943*^9, 
                    3.7451704939708557*^9}, {3.745170636805746*^9, 
                    3.745170637738531*^9}, {3.7451707756518106*^9, 
                    3.745170785832059*^9}, {3.745910750525032*^9, 
                    3.74591076049893*^9}, {3.745936753573188*^9, 
                    3.745936754486637*^9}, {3.7559880313632917*^9, 
                    3.755988051887361*^9}, {3.755988133202392*^9, 
                    3.7559882074390793*^9}, 3.755988354481037*^9, 
                    {3.7559886554565277*^9, 3.755988656471874*^9}, 
                    {3.755991090352387*^9, 3.7559910934634867*^9}, 
                    3.755994621351981*^9, {3.7559963491472197*^9, 
                    3.755996355921508*^9}, {3.755996408002249*^9, 
                    3.75599641758843*^9}, {3.755997293648031*^9, 
                    3.755997294005706*^9}, 3.7559973366490803*^9, 
                    {3.7560469406176777*^9, 3.756046941165394*^9}, 
                    {3.7560469874032173*^9, 3.756047001468123*^9}, 
                    {3.756072246357415*^9, 3.756072246578965*^9}, 
                    {3.756150894900334*^9, 3.756150898233931*^9}, 
                    {3.756156370299522*^9, 3.756156370647628*^9}, 
                    3.756160647431408*^9, {3.756162513639196*^9, 
                    3.756162514317853*^9}, 3.7561688155087013*^9, 
                    {3.7567751180616693*^9, 3.756775118461627*^9}, 
                    {3.756775286597139*^9, 3.7567753057515593*^9}, 
                    {3.756775962376075*^9, 3.756775965951539*^9}, 
                    {3.756776119883643*^9, 3.756776120330359*^9}, 
                    {3.7572682665138893*^9, 3.757268272944707*^9}, 
                    {3.7573097464934998*^9, 3.757309746716404*^9}, 
                    {3.7575463689104137*^9, 3.7575463691883087*^9}, 
                    {3.757805123293702*^9, 3.757805123408701*^9}, 
                    3.759819613172501*^9, {3.7598632082477293*^9, 
                    3.7598632122769012*^9}, {3.759863254080076*^9, 
                    3.759863285400076*^9}, {3.759863476931889*^9, 
                    3.759863480744416*^9}, {3.759863563336294*^9, 
                    3.7598635902979183*^9}, 3.75986680164673*^9, 
                    {3.759868057969713*^9, 3.7598680601286087*^9}, 
                    {3.7599097121079187*^9, 3.759909724486381*^9}, 
                    {3.7599108466628428*^9, 3.759910847942936*^9}, 
                    {3.7599115466992207*^9, 3.759911547244204*^9}, 
                    {3.759911941716371*^9, 3.7599119434203453*^9}, 
                    {3.759912702612884*^9, 3.7599127056884747*^9}, 
                    {3.759912741833764*^9, 3.7599127517821407*^9}, 
                    {3.7601384213653917*^9, 3.760138438292262*^9}, 
                    3.760138852199086*^9, {3.760147914357531*^9, 
                    3.76014792400429*^9}, 3.7601501029769287*^9, 
                    {3.76020229039077*^9, 3.7602022991719418*^9}, 
                    3.760219935787953*^9}]}, Open]], Cell[CellGroupData[
                {Cell["Adiabatic States", "Subsubsubsection", 
                  CellChangeTimes -> {{3.7604667379678593*^9, 
                   3.7604667454625263*^9}}], Cell[BoxData[RowBox[
                    {RowBox[{"adiabaticWfns", "=", "\[IndentingNewLine]", 
                       RowBox[{RowBox[{RowBox[{"getWavefunctions", "[", 
                          "\[IndentingNewLine]", RowBox[{"r1r2Wavefunctions", 
                          ",", "\[IndentingNewLine]", " ", "$saDVR", ",", 
                          " ", "\[IndentingNewLine]", RowBox[
                          {"ConstantArray", "[", RowBox[{"1", ",", RowBox[
                          {RowBox[{"(", RowBox[{"$saBasisSize", "^", "2"}], 
                          ")"}], "*", RowBox[{"{", RowBox[{"1", ",", " ", 
                          "1"}], "}"}]}]}], " ", "]"}], ",", " ", 
                          "\[IndentingNewLine]", "saMainGrid", ",", " ", 
                          "\[IndentingNewLine]", "#"}], 
                          "\[IndentingNewLine]", "]"}], "&"}], "/@", RowBox[
                          {"Range", "[", RowBox[{"2", ",", " ", "10"}], 
                          "]"}]}]}], ";"}]], "Input", CellChangeTimes -> 
                   {{3.7604668113203573*^9, 3.7604668346291733*^9}, 
                   {3.760466930267353*^9, 3.760466930362845*^9}}]}, Open]], 
              Cell[CellGroupData[{Cell["Results", "Subsubsubsection", 
                  CellChangeTimes -> {{3.7601382044395723*^9, 
                   3.7601382084556627*^9}, {3.760138372708846*^9, 
                   3.7601383752129908*^9}}], Cell[BoxData[RowBox[
                    {"debugPrint", "[", "\"4D wavefunctions generated\"", 
                     "]"}]], "Input", CellChangeTimes -> 
                   {{3.7601872871034718*^9, 3.7601873116498547*^9}, 
                    3.760187396033412*^9}], Cell[BoxData[RowBox[
                    {RowBox[{"$Wavefunctions", "=", "\[IndentingNewLine]", 
                       RowBox[{"<|", "\[IndentingNewLine]", RowBox[
                          {RowBox[{"\"NoQuanta\"", "\[Rule]", 
                          "noQuantaWfns"}], ",", "\[IndentingNewLine]", 
                          RowBox[{"\"OneQuantum\"", "\[Rule]", 
                          "oneQuantumWfns"}], ",", "\[IndentingNewLine]", 
                          RowBox[{"\"TwoQuanta\"", "\[Rule]", 
                          "twoQuantaWfns"}]}], "\[IndentingNewLine]", 
                         "|>"}]}], ";"}]], "Input", CellChangeTimes -> 
                   {{3.760466750715623*^9, 3.760466763918339*^9}}], 
                 Cell[BoxData[RowBox[{RowBox[{"$FullWavefunctions", "=", 
                       "\[IndentingNewLine]", RowBox[{"Join", "[", 
                         "\[IndentingNewLine]", RowBox[{"$Wavefunctions", 
                          ",", "\[IndentingNewLine]", RowBox[{"<|", 
                          "\[IndentingNewLine]", RowBox[{RowBox[
                          {"\"Adiabatic\"", "->", "adiabaticWfns"}], ",", 
                          "\[IndentingNewLine]", RowBox[
                          {"\"OneAndTwoQuanta\"", "->", 
                          "oneAndTwoQuantaWfns"}]}], "\[IndentingNewLine]", 
                          "|>"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], 
                  "Input", CellChangeTimes -> {{3.760138375742167*^9, 
                    3.760138408054091*^9}, {3.7601388608170033*^9, 
                    3.760138870872171*^9}, 3.760139216233149*^9, 
                    {3.760466766527808*^9, 3.760466767094426*^9}, 
                    {3.76046684190619*^9, 3.760466860084598*^9}}], 
                 Cell[BoxData[RowBox[{RowBox[{"$EnergyShifts", "=", 
                       "\[IndentingNewLine]", RowBox[{RowBox[{"Map", "[", 
                          RowBox[{RowBox[{RowBox[{RowBox[{"#", "[", 
                          "\"Energies\"", "]"}], "[", RowBox[{"[", "1", 
                          "]"}], "]"}], "&"}], ",", " ", 
                          "$FullWavefunctions"}], "]"}], "-", RowBox[
                          {RowBox[{"noQuantaWfns", "[", "\"Energies\"", 
                          "]"}], "[", RowBox[{"[", "1", "]"}], "]"}]}]}], 
                     ";"}]], "Input", CellChangeTimes -> 
                   {{3.760138265825625*^9, 3.7601382790625467*^9}, 
                    {3.760138325997889*^9, 3.760138366741652*^9}, 
                    {3.760139048739777*^9, 3.76013905925926*^9}, 
                    3.760466772308756*^9}], Cell[BoxData[RowBox[
                    {RowBox[{"$ZeroPointEnergies", "=", 
                       "\[IndentingNewLine]", RowBox[{"AssociationThread", 
                         "[", "\[IndentingNewLine]", RowBox[{RowBox[{"Keys", 
                          "@", "$FullWavefunctions"}], ",", 
                          "\[IndentingNewLine]", RowBox[{RowBox[{"Map", "[", 
                          RowBox[{RowBox[{RowBox[{RowBox[{"#", "[", 
                          "\"Energies\"", "]"}], "[", RowBox[{"[", "1", 
                          "]"}], "]"}], "&"}], ",", " ", RowBox[{"Values", 
                          "@", "$FullWavefunctions"}]}], "]"}], "-", 
                          "\[IndentingNewLine]", RowBox[{"Map", "[", RowBox[
                          {RowBox[{RowBox[{"Min", "[", RowBox[{"averagedPot", 
                          "[", RowBox[{"r1r2Wavefunctions", ",", " ", "#"}], 
                          "]"}], "]"}], "&"}], ",", " ", 
                          "\[IndentingNewLine]", RowBox[{"Join", "[", RowBox[
                          {RowBox[{"{", RowBox[{"1", ",", " ", "2", ",", " ", 
                          "4", ",", " ", "2"}], "}"}], ",", " ", RowBox[
                          {"Range", "[", RowBox[{"2", ",", " ", "10"}], 
                          "]"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
                         "\[IndentingNewLine]", "]"}]}], ";"}]], "Input", 
                  CellChangeTimes -> {{3.7601382361426277*^9, 
                   3.760138249809506*^9}, {3.760138286934547*^9, 
                   3.7601383017104273*^9}, {3.760139064195313*^9, 
                   3.7601391264807653*^9}, {3.760159421611957*^9, 
                   3.760159423920871*^9}, {3.7601609870160627*^9, 
                   3.760161043686771*^9}, {3.760224213137957*^9, 
                   3.760224218531616*^9}, {3.76046677414758*^9, 
                   3.760466775420145*^9}, {3.7604789729013987*^9, 
                   3.7604789812194*^9}}]}, Open]]}, Open]], 
           Cell[CellGroupData[{Cell["Projections", "Subsubsection", 
               CellChangeTimes -> {{3.7561678647869797*^9, 
                 3.756167869649324*^9}, 3.759864367368926*^9}], 
              Cell[CellGroupData[{Cell["One Quantum", "Subsubsubsection", 
                  CellChangeTimes -> {3.759864375517325*^9}], 
                 Cell[BoxData[RowBox[{RowBox[{"oneQuantumProjections", "=", 
                       "\[IndentingNewLine]", RowBox[{"pullProjections", "[", 
                         RowBox[{"oneQuantumWfns", ",", " ", "saMainGrid", 
                          ",", " ", RowBox[{"{", RowBox[{"2", ",", " ", 
                          "3"}], "}"}]}], "]"}]}], ";"}]], "Input", 
                  CellChangeTimes -> {{3.756167883406499*^9, 
                    3.756167899864807*^9}, {3.756167953535864*^9, 
                    3.756167968596747*^9}, {3.756168028325548*^9, 
                    3.756168039946423*^9}, {3.757271006118342*^9, 
                    3.7572710099389*^9}, {3.7572730700036917*^9, 
                    3.7572730928353443*^9}, {3.75727312979388*^9, 
                    3.757273233669076*^9}, {3.7575464258858967*^9, 
                    3.7575464260053864*^9}, 3.7597906458966303*^9, 
                    {3.7598636039909973*^9, 3.759863615616287*^9}, 
                    3.759866763082143*^9, {3.760139464144062*^9, 
                    3.760139528492684*^9}, {3.760161084737446*^9, 
                    3.760161102269158*^9}, {3.760161137831605*^9, 
                    3.760161161318081*^9}, {3.760202342384798*^9, 
                    3.760202359666938*^9}}]}, Open]], Cell[CellGroupData[
                {Cell["Two Quanta", "Subsubsubsection", CellChangeTimes -> 
                   {{3.759864375517325*^9, 3.7598643830009813*^9}}], 
                 Cell[BoxData[RowBox[{RowBox[{"twoQuantaProjections", "=", 
                       "\[IndentingNewLine]", RowBox[{"pullProjections", "[", 
                         RowBox[{"twoQuantaWfns", ",", " ", "saMainGrid", 
                          ",", " ", RowBox[{"{", RowBox[{"4", ",", " ", "5", 
                          ",", " ", "6"}], "}"}]}], "]"}]}], ";"}]], "Input", 
                  CellChangeTimes -> {{3.756167883406499*^9, 
                    3.756167899864807*^9}, {3.756167953535864*^9, 
                    3.756167968596747*^9}, {3.756168028325548*^9, 
                    3.756168039946423*^9}, {3.757271006118342*^9, 
                    3.7572710099389*^9}, {3.7572730700036917*^9, 
                    3.7572730928353443*^9}, {3.75727312979388*^9, 
                    3.757273233669076*^9}, {3.7575464258858967*^9, 
                    3.7575464260053864*^9}, {3.757804899379428*^9, 
                    3.757804928743814*^9}, {3.759261276882699*^9, 
                    3.759261280871253*^9}, {3.759261591112032*^9, 
                    3.759261611009453*^9}, {3.759261651562992*^9, 
                    3.7592616531051893*^9}, {3.759790645909379*^9, 
                    3.759790645917495*^9}, {3.7598636233518467*^9, 
                    3.759863636249715*^9}, {3.759866763092395*^9, 
                    3.7598667631000347*^9}, {3.759909359492629*^9, 
                    3.759909388740205*^9}, {3.759913778901389*^9, 
                    3.759913797802547*^9}, {3.759914004557048*^9, 
                    3.759914008006399*^9}, {3.759914050046172*^9, 
                    3.75991406886657*^9}, {3.760139445713163*^9, 
                    3.760139451836277*^9}, {3.760139536534636*^9, 
                    3.7601395425228662*^9}, 3.760161158212228*^9, 
                    {3.760202362478916*^9, 3.760202372221574*^9}}]}, 
                Closed]], Cell[CellGroupData[{Cell["One and Two Quanta", 
                  "Subsubsubsection", CellChangeTimes -> 
                   {{3.7599127687021303*^9, 3.759912774116561*^9}}], 
                 Cell[BoxData[RowBox[{RowBox[{"oneAndTwoQuantaProjections", 
                       "=", "\[IndentingNewLine]", RowBox[{"pullProjections", 
                         "[", RowBox[{"oneAndTwoQuantaWfns", ",", " ", 
                          "saMainGrid", ",", " ", RowBox[{"{", RowBox[{"2", 
                          ",", " ", "3", ",", " ", "4", ",", " ", "5", ",", 
                          " ", "6"}], "}"}]}], "]"}]}], ";"}]], "Input", 
                  CellChangeTimes -> {{3.756167883406499*^9, 
                    3.756167899864807*^9}, {3.756167953535864*^9, 
                    3.756167968596747*^9}, {3.756168028325548*^9, 
                    3.756168039946423*^9}, {3.757271006118342*^9, 
                    3.7572710099389*^9}, {3.7572730700036917*^9, 
                    3.7572730928353443*^9}, {3.75727312979388*^9, 
                    3.757273233669076*^9}, {3.7575464258858967*^9, 
                    3.7575464260053864*^9}, {3.757804899379428*^9, 
                    3.757804928743814*^9}, {3.759261276882699*^9, 
                    3.759261280871253*^9}, {3.759261591112032*^9, 
                    3.759261611009453*^9}, {3.759261651562992*^9, 
                    3.7592616531051893*^9}, {3.759790645909379*^9, 
                    3.759790645917495*^9}, {3.7598636233518467*^9, 
                    3.759863636249715*^9}, {3.759866763092395*^9, 
                    3.7598667631000347*^9}, {3.759909359492629*^9, 
                    3.759909388740205*^9}, {3.7599127823058577*^9, 
                    3.759912870666901*^9}, {3.759913436450172*^9, 
                    3.759913461158238*^9}, {3.759913506431849*^9, 
                    3.759913512718473*^9}, {3.760139405161585*^9, 
                    3.7601394542042913*^9}, {3.76013954591436*^9, 
                    3.760139554762659*^9}, 3.760161166367044*^9, 
                    {3.760202376573612*^9, 3.76020238462621*^9}}]}, 
                Closed]]}, Open]]}, Open]], 
        Cell[CellGroupData[{Cell["Spectrum", "Subsection", CellChangeTimes -> 
             {{3.759864388824855*^9, 3.759864390216895*^9}}], 
           Cell[CellGroupData[{Cell["Transition Moments", "Subsubsection", 
               CellChangeTimes -> {{3.74042009424655*^9, 
                3.740420098492478*^9}}], Cell[CellGroupData[
                {Cell["Build Base Dipole Vectors", "Subsubsubsection", 
                  CellChangeTimes -> {{3.757310355612214*^9, 
                   3.75731036145855*^9}}], Cell[BoxData[RowBox[
                    {RowBox[{"newInterp", "=", RowBox[
                        {"rebuildInterpolation", "@", RowBox[
                          {"$fullDipoleSurf", "[", RowBox[{"[", "1", "]"}], 
                          "]"}]}]}], ";"}]], "Input", CellChangeTimes -> 
                   {{3.741151599032167*^9, 3.7411516152656507*^9}, 
                    {3.7411516536812887*^9, 3.741151669897037*^9}, 
                    {3.741151702330139*^9, 3.741151801705586*^9}, 
                    {3.741151834256665*^9, 3.741151886855463*^9}, 
                    {3.741151930880084*^9, 3.741151949677331*^9}, 
                    {3.741152031500819*^9, 3.741152033364304*^9}, 
                    {3.741152287432192*^9, 3.741152289026104*^9}, 
                    {3.741152458896369*^9, 3.741152459403281*^9}, 
                    {3.7411526787286377*^9, 3.741152705279117*^9}, 
                    {3.741152763282712*^9, 3.741152853171748*^9}, 
                    {3.7422701589773893*^9, 3.742270163127624*^9}, 
                    {3.756478440237261*^9, 3.756478440564061*^9}, 
                    {3.7572229156102667*^9, 3.7572229939803753*^9}, 
                    {3.757223206017478*^9, 3.757223207626034*^9}, 
                    {3.757268350722116*^9, 3.757268356407729*^9}, 
                    3.75979075020986*^9, 3.759866801662209*^9, 
                    {3.7601396882209883*^9, 3.7601397229593983*^9}, 
                    3.760160981753954*^9, 3.7601611744061623*^9, 
                    {3.760202403932209*^9, 3.7602024333746443*^9}}], 
                 Cell[BoxData[RowBox[{RowBox[{"r1r2DipoleVectors", "//", 
                       RowBox[{"cachedLoad", "[", "\[IndentingNewLine]", 
                         RowBox[{"getDipoleVecs", "[", RowBox[
                          {"r1r2Wavefunctions", ",", "r1r2GridPts", " ", ",", 
                          " ", "newInterp"}], "]"}], "\[IndentingNewLine]", 
                         "]"}]}], ";"}]], "Input", CellChangeTimes -> 
                   {{3.740421636241317*^9, 3.7404217970745897*^9}, 
                    {3.740421871564698*^9, 3.7404218818765593*^9}, 
                    {3.740421960037055*^9, 3.740421965602729*^9}, 
                    3.740422110271852*^9, {3.7404223227152*^9, 
                    3.740422328178351*^9}, {3.740424002376114*^9, 
                    3.740424064425633*^9}, {3.7404332784627333*^9, 
                    3.740433309125947*^9}, {3.740434439432356*^9, 
                    3.7404344627586*^9}, 3.7404349810163603*^9, 
                    {3.741148287015574*^9, 3.741148308850835*^9}, 
                    {3.741149729722797*^9, 3.741149799245707*^9}, 
                    {3.741149845020452*^9, 3.7411499306153097*^9}, 
                    3.7411501551803713*^9, {3.741150436262117*^9, 
                    3.7411504621993504*^9}, {3.741151630102854*^9, 
                    3.741151650842063*^9}, {3.741151746713331*^9, 
                    3.741151751424386*^9}, {3.74115204914859*^9, 
                    3.741152119357419*^9}, {3.741153005283437*^9, 
                    3.741153046048668*^9}, {3.741154443939692*^9, 
                    3.741154491379589*^9}, {3.74115453612136*^9, 
                    3.74115457492109*^9}, {3.741369714645455*^9, 
                    3.74136971923771*^9}, {3.741376631803238*^9, 
                    3.741376649649929*^9}, {3.741376704806162*^9, 
                    3.741376705226481*^9}, {3.741378137521867*^9, 
                    3.741378178504554*^9}, {3.741378299789171*^9, 
                    3.7413783078700933*^9}, {3.7413809854086237*^9, 
                    3.7413810184530354*^9}, 3.741381052973338*^9, 
                    {3.741381092601544*^9, 3.7413810945484667*^9}, 
                    {3.741381581182963*^9, 3.741381607666194*^9}, 
                    {3.741383071952972*^9, 3.7413831066601467*^9}, 
                    {3.741383141314911*^9, 3.741383144975553*^9}, 
                    {3.741383460088784*^9, 3.74138346211865*^9}, 
                    {3.7413889730940123*^9, 3.741388980541914*^9}, 
                    {3.741389014401251*^9, 3.741389017567774*^9}, 
                    {3.741389066473247*^9, 3.741389092785081*^9}, 
                    {3.741389137557341*^9, 3.741389154398452*^9}, 
                    {3.741389212882389*^9, 3.741389216038817*^9}, 
                    {3.741389272711375*^9, 3.741389291619053*^9}, 
                    {3.741391089335146*^9, 3.7413910917700872*^9}, 
                    {3.741562470384266*^9, 3.741562473757059*^9}, 
                    {3.741562601427658*^9, 3.741562603229766*^9}, 
                    {3.742172068914383*^9, 3.742172079891963*^9}, 
                    {3.7561638137652693*^9, 3.756163815225609*^9}, 
                    {3.7561639564989223*^9, 3.7561639601316023*^9}, 
                    {3.756164044946827*^9, 3.7561640457348337*^9}, 
                    {3.75616435953876*^9, 3.756164398533539*^9}, 
                    {3.757106931989356*^9, 3.7571069324443398*^9}, 
                    {3.757188047316923*^9, 3.757188085394204*^9}, 
                    {3.757223002176095*^9, 3.757223054004418*^9}, 
                    3.757223266717329*^9, {3.757224726955052*^9, 
                    3.757224729386899*^9}, {3.757306860291027*^9, 
                    3.757306867542041*^9}, {3.757306933443737*^9, 
                    3.7573069348582363*^9}, {3.757307779577258*^9, 
                    3.757307781489191*^9}, 3.757533725378337*^9, 
                    {3.7597907502264843*^9, 3.759790750233574*^9}, 
                    {3.759866801679742*^9, 3.759866801688509*^9}, 
                    {3.760139725460759*^9, 3.760139782686528*^9}, 
                    3.760140066638695*^9, {3.760140097988659*^9, 
                    3.760140144181252*^9}, 3.7601402366422577*^9, 
                    {3.7601872303675547*^9, 3.760187235307496*^9}, 
                    {3.76020247823876*^9, 3.760202502575696*^9}}]}, Open]], 
              Cell[CellGroupData[{Cell["Extract Transition Moments", 
                  "Subsubsubsection", CellChangeTimes -> 
                   {{3.757310355612214*^9, 3.75731037046618*^9}}], 
                 Cell[CellGroupData[{Cell["Calc moments", 
                     "Subsubsubsubsection", CellChangeTimes -> 
                      {{3.757804972288328*^9, 3.757804995769597*^9}}], 
                    Cell[BoxData[RowBox[{"debugPrint", "[", 
                        "\"Generating transition moments...\"", "]"}]], 
                     "Input", CellChangeTimes -> {{3.7601872871034718*^9, 
                       3.760187335481534*^9}, 3.760187396783267*^9}], 
                    Cell[BoxData[RowBox[{"r1r2TransitionMoments", "//", 
                        RowBox[{"cachedLoad", "[", "\[IndentingNewLine]", 
                          RowBox[{"getTransitionMoments", "[", 
                          "\[IndentingNewLine]", RowBox[
                          {"rephasedR1R2Wavefunctions", ",", 
                          "\[IndentingNewLine]", "r1r2DipoleVectors"}], 
                          "\[IndentingNewLine]", "]"}], 
                          "\[IndentingNewLine]", "]"}]}]], "Input", 
                     CellChangeTimes -> {{3.741389225519876*^9, 
                       3.7413892322456217*^9}, {3.741389263315156*^9, 
                       3.741389264299038*^9}, {3.7413897220351257*^9, 
                       3.741389733683709*^9}, {3.741391404606308*^9, 
                       3.7413914194819117*^9}, {3.741392140001916*^9, 
                       3.741392157206468*^9}, {3.741392388186488*^9, 
                       3.741392391792953*^9}, {3.741448005526219*^9, 
                       3.741448053354413*^9}, {3.741448105354643*^9, 
                       3.741448128243527*^9}, {3.741448209053697*^9, 
                       3.741448209759305*^9}, {3.75616406536051*^9, 
                       3.756164096061324*^9}, {3.756165100126627*^9, 
                       3.756165117218646*^9}, {3.756165163561924*^9, 
                       3.756165169351871*^9}, {3.756165623458214*^9, 
                       3.756165624206149*^9}, {3.756167073850114*^9, 
                       3.756167112468685*^9}, {3.756167143865016*^9, 
                       3.756167147788957*^9}, 3.75717519703391*^9, 
                       3.757175250358272*^9, 3.757176274529272*^9, 
                       {3.757179909676662*^9, 3.757179945129881*^9}, 
                       {3.757179997855344*^9, 3.75717999879618*^9}, 
                       {3.757188121923444*^9, 3.757188152502252*^9}, 
                       3.757188323423812*^9, {3.7572232925366287*^9, 
                       3.7572233165748568*^9}, {3.757224740715437*^9, 
                       3.757224742061837*^9}, {3.757225695204612*^9, 
                       3.757225695356678*^9}, {3.75722576197027*^9, 
                       3.757225783402687*^9}, 3.7572908872159023*^9, 
                       3.7573069560993443*^9, 3.75731695531295*^9, 
                       {3.757355180884164*^9, 3.757355191028234*^9}, 
                       {3.757533333383546*^9, 3.757533333734641*^9}, 
                       {3.757533482273286*^9, 3.7575334828735313*^9}, 
                       {3.7575335393090973*^9, 3.7575335663081083*^9}, 
                       {3.7575339514878397*^9, 3.757533954197106*^9}, 
                       {3.759790750290756*^9, 3.759790750294116*^9}, 
                       3.759819613588475*^9, {3.759866801702435*^9, 
                       3.7598668017093287*^9}, {3.7601401744649067*^9, 
                       3.7601402347162848*^9}, {3.7601874076433487*^9, 
                       3.7601874113444777*^9}, {3.760202553592355*^9, 
                       3.760202562363714*^9}}], Cell[BoxData[RowBox[
                       {"debugPrint", "[", 
                        "\"Generated transition moments\"", "]"}]], "Input", 
                     CellChangeTimes -> {{3.7601872871034718*^9, 
                      3.760187335481534*^9}, {3.760187396783267*^9, 
                      3.7601874233599777*^9}}]}, Open]], Cell[CellGroupData[
                   {Cell["Full moments", "Subsubsubsubsection", 
                     CellChangeTimes -> {{3.757317020302462*^9, 
                      3.757317022828332*^9}, {3.759865289891618*^9, 
                      3.759865297169354*^9}}], Cell[BoxData[RowBox[
                       {RowBox[{"r1r2GridTMs", "=", "\[IndentingNewLine]", 
                          RowBox[{"Transpose", "@", "\[IndentingNewLine]", 
                          RowBox[{"Map", "[", "\[IndentingNewLine]", RowBox[
                          {RowBox[{RowBox[{"If", "[", RowBox[{RowBox[{"#", 
                          "===", "$Failed"}], ",", " ", RowBox[
                          {"ConstantArray", "[", RowBox[{"0.", ",", " ", 
                          RowBox[{"{", RowBox[{"10", ",", " ", "3"}], 
                          "}"}]}], "]"}], ",", " ", "#"}], "]"}], "&"}], ",", 
                          " ", "\[IndentingNewLine]", RowBox[{"Values", "@", 
                          "r1r2TransitionMoments"}]}], "\[IndentingNewLine]", 
                          "]"}]}]}], ";"}]], "Input", CellChangeTimes -> 
                      {{3.741383247791429*^9, 3.7413832589385443*^9}, 
                       {3.741391495531871*^9, 3.7413915182719803*^9}, 
                       {3.741392530385466*^9, 3.741392560895166*^9}, 
                       {3.75677393047303*^9, 3.756773933855681*^9}, 
                       3.757175945402092*^9, {3.75717654238063*^9, 
                       3.757176545125881*^9}, 3.757183640156383*^9, 
                       {3.7572258606416388*^9, 3.757225860939289*^9}, 
                       {3.757291097012814*^9, 3.75729109901075*^9}, 
                       3.757356442173778*^9, {3.7575333660967293*^9, 
                       3.757533366325798*^9}, {3.759790750385055*^9, 
                       3.759790750388754*^9}, {3.759866801733375*^9, 
                       3.759866801736659*^9}, {3.760140247465241*^9, 
                       3.7601402519826927*^9}}, CellLabel -> "In[400]:="]}, 
                   Open]]}, Open]]}, Open]], Cell[CellGroupData[
             {Cell["Intensities", "Subsubsection", CellChangeTimes -> 
                {{3.757317038605698*^9, 3.757317045252878*^9}, 
                {3.7598645500946836*^9, 3.7598645507662163*^9}}], 
              Cell[BoxData[RowBox[{"debugPrint", "[", 
                  "\"Generating spectra\"", "]"}]], "Input", 
               CellChangeTimes -> {{3.7601872871034718*^9, 
                 3.760187335481534*^9}, 3.760187396783267*^9, 
                 {3.760187464121263*^9, 3.760187466486858*^9}}], 
              Cell["Ground state stuff", "Text", CellChangeTimes -> 
                {{3.75780501334137*^9, 3.757805015702262*^9}}], 
              Cell[BoxData[RowBox[{RowBox[{"zaWfn", "=", RowBox[
                     {"noQuantaWfns", "[", RowBox[{"[", "1", "]"}], "]"}]}], 
                  ";"}]], "Input", CellChangeTimes -> 
                {{3.7572260376988163*^9, 3.757226044364921*^9}, 
                 {3.757552885146144*^9, 3.757552885390151*^9}, 
                 {3.7575529647666273*^9, 3.757553002033923*^9}, 
                 3.7598646667772503*^9}, CellLabel -> "In[401]:="], 
              Cell[CellGroupData[{Cell["Base Wfns", "Subsubsubsection", 
                  CellChangeTimes -> {{3.759864759019826*^9, 
                   3.759864760793888*^9}}], Cell[CellGroupData[
                   {Cell["One Quantum", "Subsubsubsubsection", 
                     CellChangeTimes -> {{3.759864579558324*^9, 
                      3.7598645825802383*^9}}], Cell[
                     "Get sets of projection wavefunctions to moment over", 
                     "Text", CellChangeTimes -> {{3.757805517522911*^9, 
                      3.757805528073351*^9}}], Cell[BoxData[RowBox[
                       {RowBox[{"oneQuantumTransWfs", "=", 
                          "\[IndentingNewLine]", RowBox[
                          {"getTransitionWavefunctions", "[", RowBox[
                          {"oneQuantumProjections", ",", " ", "zaWfn"}], 
                          "]"}]}], ";"}]], "Input", CellChangeTimes -> 
                      {{3.7571781322341146*^9, 3.757178137192602*^9}, 
                       {3.75717908057475*^9, 3.757179091132702*^9}, 
                       3.757180123362417*^9, {3.759864612199798*^9, 
                       3.759864622460889*^9}, {3.7602025875989113*^9, 
                       3.760202598245037*^9}}]}, Open]], Cell[CellGroupData[
                   {Cell["Two Quanta", "Subsubsubsubsection", 
                     CellChangeTimes -> {{3.759864719492529*^9, 
                      3.759864722482595*^9}}], Cell[BoxData[RowBox[
                       {RowBox[{"twoQuantaTransWfs", "=", 
                          "\[IndentingNewLine]", RowBox[
                          {"getTransitionWavefunctions", "[", RowBox[
                          {"twoQuantaProjections", ",", " ", "zaWfn"}], 
                          "]"}]}], ";"}]], "Input", CellChangeTimes -> 
                      {{3.757805480853015*^9, 3.757805512439332*^9}, 
                      {3.7598647377681828*^9, 3.759864745986329*^9}, 
                      {3.75990877343007*^9, 3.759908773931344*^9}, 
                      {3.7602026049753733*^9, 3.760202611196072*^9}}]}, 
                   Open]], Cell[CellGroupData[{Cell["One and Two Quanta", 
                     "Subsubsubsubsection", CellChangeTimes -> 
                      {{3.759864719492529*^9, 3.759864722482595*^9}, 
                      {3.7599128834363422*^9, 3.759912884882333*^9}}], 
                    Cell[BoxData[RowBox[{RowBox[{"oneAndTwoQuantaTransWfs", 
                          "=", "\[IndentingNewLine]", RowBox[
                          {"getTransitionWavefunctions", "[", RowBox[
                          {"oneAndTwoQuantaProjections", ",", " ", "zaWfn"}], 
                          "]"}]}], ";"}]], "Input", CellChangeTimes -> 
                      {{3.757805480853015*^9, 3.757805512439332*^9}, 
                      {3.7598647377681828*^9, 3.759864745986329*^9}, 
                      {3.75990877343007*^9, 3.759908773931344*^9}, 
                      {3.759912887159689*^9, 3.75991289634823*^9}, 
                      {3.760202614255754*^9, 3.760202618913129*^9}}]}, 
                   Open]]}, Open]], Cell[CellGroupData[{Cell["Ints", 
                  "Subsubsubsection", CellChangeTimes -> 
                   {{3.759870646080632*^9, 3.75987064675135*^9}}], 
                 Cell[BoxData[{RowBox[{RowBox[{"noQuantaInts", "=", RowBox[
                         {"getIntensities", "[", RowBox[{RowBox[{"{", 
                          "noQuantaWfns", "}"}], ",", " ", RowBox[{"{", "1", 
                          "}"}], ",", " ", "r1r2GridTMs"}], "]"}]}], ";"}], 
                    "\[IndentingNewLine]", RowBox[{RowBox[{"oneQuantumInts", 
                        "=", RowBox[{"getIntensities", "[", RowBox[
                          {"oneQuantumTransWfs", ",", " ", RowBox[{"{", 
                          RowBox[{"2", ",", " ", "3"}], "}"}], ",", " ", 
                          "r1r2GridTMs"}], "]"}]}], ";"}], 
                    "\[IndentingNewLine]", RowBox[{RowBox[{"twoQuantaInts", 
                        "=", RowBox[{"getIntensities", "[", RowBox[
                          {"twoQuantaTransWfs", ",", " ", RowBox[{"{", 
                          RowBox[{"4", ",", " ", "5", ",", " ", "6"}], "}"}], 
                          ",", " ", "r1r2GridTMs"}], "]"}]}], ";"}], "\n", 
                    RowBox[{RowBox[{"oneAndTwoQuantaInts", "=", RowBox[
                         {"getIntensities", "[", RowBox[
                          {"oneAndTwoQuantaTransWfs", ",", " ", RowBox[
                          {"{", RowBox[{"2", ",", " ", "3", ",", " ", "4", 
                          ",", " ", "5", ",", " ", "6"}], "}"}], ",", " ", 
                          "r1r2GridTMs"}], "]"}]}], ";"}], 
                    "\[IndentingNewLine]", RowBox[{RowBox[{"adiabaticInts", 
                        "=", "\[IndentingNewLine]", RowBox[{"MapIndexed", 
                          "[", "\[IndentingNewLine]", RowBox[{RowBox[
                          {RowBox[{"getIntensities", "[", RowBox[{RowBox[
                          {"{", RowBox[{"Join", "[", RowBox[{RowBox[
                          {"noQuantaWfns", "[", RowBox[{"[", RowBox[{";;", 
                          "1"}], "]"}], "]"}], ",", " ", "#"}], "]"}], "}"}], 
                          ",", " ", RowBox[{"1", "+", "#2"}], ",", " ", 
                          "r1r2GridTMs"}], "]"}], "&"}], ",", " ", 
                          "\[IndentingNewLine]", "adiabaticWfns"}], 
                          "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input", 
                  CellChangeTimes -> {{3.759870650312489*^9, 
                    3.759870672105134*^9}, {3.759912940023509*^9, 
                    3.7599129557063713*^9}, 3.759913848252474*^9, 
                    3.760140658762829*^9, {3.760163146076015*^9, 
                    3.760163148661748*^9}, {3.7601634254879293*^9, 
                    3.7601634277401876*^9}, {3.760202660883165*^9, 
                    3.76020270528391*^9}, {3.760233059774988*^9, 
                    3.760233070472025*^9}, {3.760466895117652*^9, 
                    3.760466919643639*^9}, {3.760466955419318*^9, 
                    3.760466970626194*^9}, {3.760475126291648*^9, 
                    3.7604751484326563*^9}, {3.7604784411329317*^9, 
                    3.760478457534307*^9}}]}, Open]]}, Open]], 
           Cell[CellGroupData[{Cell["Frequencies", "Subsubsection", 
               CellChangeTimes -> {{3.759864854210003*^9, 
                3.759864858720619*^9}}], Cell[
               "We then turn these into intensities and plot them:", "Text", 
               CellChangeTimes -> {{3.7414484889676113*^9, 
                3.741448507544737*^9}}], Cell[CellGroupData[
                {Cell["No Quanta", "Subsubsubsection", CellChangeTimes -> 
                   {{3.759864861818479*^9, 3.759864863184408*^9}}], 
                 Cell[BoxData[{RowBox[{RowBox[{"noQuantaFreqs", "=", 
                        RowBox[{"getFreqs", "[", RowBox[{"noQuantaWfns", ",", 
                          " ", "zaWfn"}], "]"}]}], ";"}], "\n", RowBox[
                     {RowBox[{"oneQuantumFreqs", "=", RowBox[{"getFreqs", 
                          "[", RowBox[{"oneQuantumWfns", ",", " ", "zaWfn"}], 
                          "]"}]}], ";"}], "\[IndentingNewLine]", RowBox[
                     {RowBox[{"twoQuantaFreqs", "=", RowBox[{"getFreqs", "[", 
                          RowBox[{"twoQuantaWfns", ",", " ", "zaWfn"}], 
                          "]"}]}], ";"}], "\n", RowBox[{RowBox[
                       {"oneAndTwoQuantaFreqs", "=", RowBox[{"getFreqs", "[", 
                          RowBox[{"oneAndTwoQuantaWfns", ",", " ", "zaWfn"}], 
                          "]"}]}], ";"}], "\[IndentingNewLine]", RowBox[
                     {"adiabaticFreqs", "=", RowBox[{RowBox[{RowBox[
                          {"getFreqs", "[", RowBox[{"#", ",", " ", "zaWfn"}], 
                          "]"}], "&"}], "/@", "adiabaticWfns"}]}]}], "Input", 
                  CellChangeTimes -> {{3.756247443625925*^9, 
                    3.756247471549491*^9}, {3.756773990966756*^9, 
                    3.7567739932844877*^9}, 3.757180516299687*^9, 
                    {3.757805590356824*^9, 3.757805608905981*^9}, 
                    {3.759864866449009*^9, 3.759864886650084*^9}, 
                    {3.759865317187899*^9, 3.75986533049946*^9}, 
                    {3.759878364239934*^9, 3.759878367767899*^9}, 
                    {3.759912962572397*^9, 3.759913002730926*^9}, 
                    3.759913851837104*^9, {3.7601406657209682*^9, 
                    3.760140668327977*^9}, 3.760163430116976*^9, 
                    {3.76020274003907*^9, 3.760202777710144*^9}, 
                    {3.760466938637019*^9, 3.7604669540853033*^9}}], 
                 Cell[BoxData[RowBox[{"debugPrint", "[", 
                     "\"Spectra generated\"", "]"}]], "Input", 
                  CellChangeTimes -> {{3.7601872871034718*^9, 
                    3.760187335481534*^9}, 3.760187396783267*^9, 
                    {3.760187464121263*^9, 3.760187481694985*^9}}], 
                 Cell[BoxData[RowBox[{RowBox[{"$RawSpectra", "=", 
                       "\[IndentingNewLine]", RowBox[{"<|", 
                         "\[IndentingNewLine]", RowBox[{RowBox[
                          {"\"Frequencies\"", "\[Rule]", 
                          "\[IndentingNewLine]", RowBox[{"Join", "[", 
                          "\[IndentingNewLine]", RowBox[{RowBox[{"{", 
                          "\[IndentingNewLine]", RowBox[{"noQuantaFreqs", 
                          ",", "\[IndentingNewLine]", "oneQuantumFreqs", ",", 
                          "\[IndentingNewLine]", "twoQuantaFreqs", ",", 
                          "\[IndentingNewLine]", "oneAndTwoQuantaFreqs"}], 
                          "\[IndentingNewLine]", "}"}], ",", 
                          "\[IndentingNewLine]", "adiabaticFreqs"}], 
                          "\[IndentingNewLine]", "]"}]}], ",", 
                          "\[IndentingNewLine]", RowBox[{"\"Intensities\"", 
                          "\[Rule]", "\[IndentingNewLine]", RowBox[{"Join", 
                          "[", "\[IndentingNewLine]", RowBox[{RowBox[{"{", 
                          "\[IndentingNewLine]", RowBox[{"noQuantaInts", ",", 
                          "\[IndentingNewLine]", "oneQuantumInts", ",", 
                          "\[IndentingNewLine]", "twoQuantaInts", ",", 
                          "\[IndentingNewLine]", "oneAndTwoQuantaInts"}], 
                          "\[IndentingNewLine]", "}"}], ",", 
                          "\[IndentingNewLine]", "adiabaticInts"}], 
                          "\[IndentingNewLine]", "]"}]}]}], 
                         "\[IndentingNewLine]", "|>"}]}], ";"}]], "Input", 
                  CellChangeTimes -> {{3.7604785329293833*^9, 
                   3.760478567952643*^9}}]}, Open]]}, Open]], 
           Cell[CellGroupData[{Cell["Spectra", "Subsubsection", 
               CellChangeTimes -> {{3.742230059783856*^9, 
                 3.7422300633970213*^9}, 3.760147942370723*^9, 
                 3.7601874750714912*^9}], Cell[
               "After we build the transition moments we can plot them:", 
               "Text", CellChangeTimes -> {{3.742230070549181*^9, 
                3.742230079429571*^9}}], Cell[BoxData[RowBox[
                 {RowBox[{"$Spectra", "=", "\[IndentingNewLine]", RowBox[
                     {"buildSpectra", "[", RowBox[{RowBox[{"$RawSpectra", 
                          "[", "\"Frequencies\"", "]"}], ",", " ", RowBox[
                         {"$RawSpectra", "[", "\"Intensities\"", "]"}]}], 
                      "]"}]}], ";"}]], "Input", CellChangeTimes -> 
                {{3.7567739765255823*^9, 3.756774019084448*^9}, 
                 {3.7571804375788116*^9, 3.757180466479905*^9}, 
                 {3.7571805879092197*^9, 3.75718063750918*^9}, 
                 {3.7572697000574493*^9, 3.7572697222422447*^9}, 
                 {3.757269795922861*^9, 3.757269944000833*^9}, 
                 {3.7572708163725233*^9, 3.757270818524991*^9}, 
                 3.757290366667061*^9, 3.757291859945497*^9, 
                 {3.757534464645267*^9, 3.7575344656088257*^9}, 
                 {3.757805613873693*^9, 3.7578056400500927*^9}, 
                 {3.759865341935062*^9, 3.759865393872827*^9}, 
                 {3.759865550394931*^9, 3.759865608790259*^9}, 
                 {3.759870675255396*^9, 3.759870691392745*^9}, 
                 3.759910676139492*^9, {3.759910763477028*^9, 
                 3.759910785169384*^9}, {3.759911285465448*^9, 
                 3.759911287997594*^9}, 3.75991252280932*^9, 
                 {3.759913010943143*^9, 3.759913083922379*^9}, 
                 3.759913541191367*^9, {3.759913590598276*^9, 
                 3.75991362190088*^9}, {3.759913680924652*^9, 
                 3.75991371302218*^9}, 3.75991374644666*^9, 
                 {3.75991385954161*^9, 3.759913888080482*^9}, 
                 {3.7599414873277493*^9, 3.759941489664658*^9}, 
                 {3.760124915652465*^9, 3.7601249167247353*^9}, 
                 {3.7601333996738977*^9, 3.760133405673573*^9}, 
                 {3.760140676735969*^9, 3.760140751134885*^9}, 
                 {3.7601631566535*^9, 3.7601631857752457*^9}, 
                 {3.760163225305951*^9, 3.7601633292505503*^9}, 
                 {3.7601966022789516*^9, 3.76019661351126*^9}, 
                 {3.760202781922645*^9, 3.760202834934634*^9}, 
                 {3.7604669767486687*^9, 3.7604669971461487*^9}, 
                 {3.760469425188727*^9, 3.76046942755681*^9}, 
                 {3.760478560840588*^9, 3.76047858023787*^9}}]}, Open]]}, 
          Open]], Cell[CellGroupData[{Cell["Dump Environment", "Subsection", 
            CellChangeTimes -> {{3.760133494597701*^9, 3.760133495269823*^9}, 
             {3.760133684723515*^9, 3.760133687386086*^9}}], 
           Cell[CellGroupData[{Cell["End Private Context", "Subsubsection", 
               CellChangeTimes -> {{3.760133775816683*^9, 
                3.760133781688686*^9}}], Cell[BoxData[RowBox[
                 {RowBox[{"End", "[", "]"}], ";"}]], "Input", 
               CellChangeTimes -> {{3.760133772603644*^9, 
                3.760133774170273*^9}}, CellLabel -> "In[524]:="]}, Open]], 
           Cell[CellGroupData[{Cell["DumpSave Symbols", "Subsubsection", 
               CellChangeTimes -> {{3.7601337835366383*^9, 
                3.760133786592404*^9}}], Cell[BoxData[RowBox[{"ToExpression", 
                  "[", RowBox[{RowBox[{"Names", "[", RowBox[{"$Context", 
                        "<>", "\"*\""}], "]"}], ",", " ", "StandardForm", 
                    ",", " ", "dumpSymbol"}], "]"}]], "Input", 
               CellChangeTimes -> {{3.760133704146496*^9, 
                3.760133704594008*^9}, {3.760133753365116*^9, 
                3.760133769613534*^9}, {3.760140820379633*^9, 
                3.760140849649631*^9}, {3.760163797974395*^9, 
                3.760163800027424*^9}}, CellLabel -> "In[474]:="]}, Open]], 
           Cell[CellGroupData[{Cell["EndPackage", "Subsubsection", 
               CellChangeTimes -> {{3.7601338200117693*^9, 
                3.760133823807939*^9}, {3.7601416629504766*^9, 
                3.760141663156736*^9}}], Cell[BoxData[RowBox[
                 {RowBox[{"EndPackage", "[", "]"}], ";"}]], "Input", 
               CellChangeTimes -> {3.760133402064843*^9}, CellLabel -> 
                "In[525]:="]}, Open]]}, Open]]}, Open]], 
     Cell[CellGroupData[{Cell["Scriptify", "Section", CellChangeTimes -> 
          {{3.760124629428643*^9, 3.760124632852586*^9}}], 
        Cell[BoxData[{RowBox[{RowBox[{RowBox[{"scriptify", "[", "\n", "  ", 
                 RowBox[{"c", ":", RowBox[{"Cell", "[", RowBox[{"_", ",", 
                       " ", RowBox[{"k", ":", RowBox[{"\"Title\"", "|", 
                          "\"Chapter\"", "|", "\"Subchapter\"", "|", 
                          "\"Section\"", "|", "\"Subsection\""}]}], ",", " ", 
                       "___"}], "]"}]}], "\n", "  ", "]"}], ":=", "\n", "  ", 
               RowBox[{"TemplateApply", "[", RowBox[
                  {"\"(* ::`style`:: *)\\n(*`body`*)\"", ",", "\n", "    ", 
                   RowBox[{"<|", "\n", "      ", RowBox[{RowBox[{"\"style\"", 
                         "\[Rule]", "k"}], ",", "\n", "      ", RowBox[
                        {"\"body\"", "->", RowBox[{RowBox[{"FrontEndExecute", 
                          "[", RowBox[{"ExportPacket", "[", RowBox[{"c", ",", 
                          " ", "\"PlainText\""}], "]"}], "]"}], "[", RowBox[
                          {"[", "1", "]"}], "]"}]}]}], "\n", "      ", 
                     "|>"}]}], "\n", "    ", "]"}]}], ";"}], "\n", 
           RowBox[{RowBox[{RowBox[{"scriptify", "[", "\n", "  ", 
                 RowBox[{"c", ":", RowBox[{"Cell", "[", RowBox[{"t_", ",", 
                       " ", RowBox[{"k", ":", RowBox[{"\"Subsubsection\"", 
                          "|", "\"Subsubsubsection\"", "|", 
                          "\"Subsubsubsubsection\""}]}], ",", " ", "___"}], 
                     "]"}]}], "\n", "  ", "]"}], ":=", "\n", "  ", RowBox[
                {"TemplateApply", "[", RowBox[
                  {"\"(* ::`style`::Closed:: *)\\n(*`body`*)\"", ",", "\n", 
                   "    ", RowBox[{"<|", "\n", "      ", RowBox[
                      {RowBox[{"\"style\"", "\[Rule]", "k"}], ",", "\n", 
                       "      ", RowBox[{"\"body\"", "->", RowBox[
                          {RowBox[{"FrontEndExecute", "[", RowBox[
                          {"ExportPacket", "[", RowBox[{"c", ",", " ", 
                          "\"PlainText\""}], "]"}], "]"}], "[", RowBox[
                          {"[", "1", "]"}], "]"}]}]}], "\n", "      ", 
                     "|>"}]}], "\n", "    ", "]"}]}], ";"}], "\n", 
           RowBox[{RowBox[{RowBox[{"scriptify", "[", "\n", "  ", 
                 RowBox[{"c", ":", RowBox[{"Cell", "[", RowBox[{"_", ",", 
                       " ", "\"Input\"", ",", " ", "___"}], "]"}]}], "\n", 
                 "  ", "]"}], ":=", "\n", "  ", RowBox[
                {RowBox[{"FrontEndExecute", "[", RowBox[{"ExportPacket", "[", 
                     RowBox[{"c", ",", " ", "\"InputText\""}], "]"}], "]"}], 
                 "[", RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\n", 
           RowBox[{RowBox[{RowBox[{"scriptify", "[", "c_Cell", "]"}], ":=", 
               "\n", "  ", RowBox[{"TemplateApply", "[", RowBox[
                  {"\"(* ::Text:: *)\\n(*`body`*)\"", ",", "\n", "    ", 
                   RowBox[{"<|", "\n", "      ", RowBox[{"\"body\"", "->", 
                       RowBox[{RowBox[{"FrontEndExecute", "[", RowBox[
                          {"ExportPacket", "[", RowBox[{"c", ",", " ", 
                          "\"PlainText\""}], "]"}], "]"}], "[", RowBox[
                          {"[", "1", "]"}], "]"}]}], "\n", "      ", 
                     "|>"}]}], "\n", "    ", "]"}]}], ";"}], "\n", 
           RowBox[{RowBox[{RowBox[{"scriptify", "[", RowBox[
                  {"nb_NotebookObject", ",", " ", "file_"}], "]"}], ":=", 
               "\n", "  ", RowBox[{"Module", "[", "\n", "    ", 
                 RowBox[{RowBox[{"{", "\n", "      ", RowBox[{RowBox[
                        {"scriptFile", "=", "file"}], ",", "\n", "      ", 
                       RowBox[{"cells", "=", RowBox[{"Cells", "[", "nb", 
                          "]"}]}], ",", "\n", "      ", "cellChunks", ",", 
                       "\n", "      ", "notebookRender"}], "\n", "      ", 
                     "}"}], ",", "\n", "    ", RowBox[{RowBox[{"cellChunks", 
                       "=", "\n", "      ", RowBox[{RowBox[{"SplitBy", "[", 
                          RowBox[{RowBox[{"NotebookRead", "@", "cells"}], 
                          ",", " ", RowBox[{RowBox[{RowBox[{"#", "[", RowBox[
                          {"[", "1", "]"}], "]"}], "===", "\"Scriptify\""}], 
                          "&"}]}], "]"}], "[", RowBox[{"[", "1", "]"}], 
                         "]"}]}], ";", "\n", "    ", RowBox[
                      {"notebookRender", "=", RowBox[{"scriptify", "/@", 
                         "cellChunks"}]}], ";", "\n", "    ", RowBox[
                      {"Export", "[", RowBox[{"file", ",", " ", "\n", 
                         "      ", RowBox[{"StringRiffle", "[", RowBox[
                          {"notebookRender", ",", " ", "\"\\n\\n\""}], "]"}], 
                         ",", "\n", "      ", "\"Text\""}], "\n", "      ", 
                       "]"}]}]}], "\n", "    ", "]"}]}], ";"}], "\n", 
           RowBox[{RowBox[{RowBox[{"scriptify", "[", "]"}], ":=", "\n", "  ", 
               RowBox[{"scriptify", "[", RowBox[{RowBox[
                    {"EvaluationNotebook", "[", "]"}], ",", " ", RowBox[
                    {"StringReplace", "[", RowBox[{RowBox[
                        {"NotebookFileName", "[", "]"}], ",", " ", RowBox[
                        {"\".nb\"", "\[Rule]", "\".wl\""}]}], "]"}]}], 
                 "]"}]}], ";"}]}], "Code", CellChangeTimes -> 
          {{3.7601246341426*^9, 3.7601247023077602*^9}, 
          {3.760124803046224*^9, 3.760124875998035*^9}, 
          {3.760133556911179*^9, 3.760133580144149*^9}, 
          {3.760133638151579*^9, 3.760133675682761*^9}, 
          {3.760141001311739*^9, 3.7601410455786467*^9}, 
          {3.760141093004216*^9, 3.76014110357028*^9}, {3.760141159761582*^9, 
          3.760141314637411*^9}, {3.760141396371109*^9, 
          3.760141740276697*^9}, {3.7601417869832373*^9, 
          3.7601417872116833*^9}, {3.760141817910193*^9, 
          3.760141824317189*^9}}, CellLabel -> "In[1]:="], 
        Cell[CellGroupData[{Cell[BoxData[RowBox[{"scriptify", "[", "]"}]], 
            "Input", CellLabel -> "In[15]:="], 
           Cell[BoxData[
             "\"/Users/Mark/Documents/UW/Research/H5+/Spectrum_Script.wl\""], 
            "Output", CellChangeTimes -> {3.760163846596425*^9, 
              3.760166087995743*^9, 3.760187498059122*^9, 
              3.7601876956209307*^9, 3.760187732319466*^9, 
              3.760189047096698*^9, 3.760202856368332*^9, 
              {3.760206153220973*^9, 3.760206161039693*^9}, 
              3.760215591352077*^9, 3.7602182497123823*^9, 
              3.76021852057907*^9, 3.760219966132472*^9, 
              3.7602225245076027*^9, 3.760224247700428*^9, 
              3.760224330723472*^9, 3.760224418710229*^9, 
              3.760233080176124*^9, 3.760251504144229*^9, 
              3.760336369734445*^9, 3.760336569713771*^9, 
              3.760399054177587*^9, 3.7604076253559437*^9, 
              3.7604078876197863*^9, 3.76045852920158*^9, 
              3.760458567784769*^9, 3.760467011709893*^9, 
              3.760469443659639*^9, 3.760469538828949*^9, 
              3.7604751889377317*^9, 3.760478606444703*^9, 
              3.7606462486461897*^9}, CellLabel -> "Out[15]="]}, Open]]}, 
       Open]]}, Open]]}, Evaluator -> "Research", WindowSize -> {974, 843}, 
 WindowMargins -> {{Automatic, 232}, {Automatic, 0}}, 
 FrontEndVersion -> 
  "11.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 5, 2018)", 
 StyleDefinitions -> FrontEnd`FileName[{"UWTools"}, "ExplorationStyle.nb", 
   CharacterEncoding -> "UTF-8"]]
