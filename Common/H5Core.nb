Notebook[{Cell[CellGroupData[{Cell["H5+ Core Code", "CodeSection"], 
     Cell[CellGroupData[
       {Cell[BoxData[RowBox[{RowBox[{"BeginPackage", "[", "\"H5Core`\"", 
              "]"}], ";"}]], "InputSection"], 
        Cell[CellGroupData[
          {Cell["\[LeftCeiling]Dirs and things\[RightFloor]", 
            "CodeSubsubsection", Evaluatable -> True], 
           Cell[BoxData[{RowBox[{RowBox[{RowBox[{"$H5Directory", "::", 
                    "usage"}], "=", "\"dooooooop\""}], ";"}], "\n", 
              RowBox[{RowBox[{RowBox[{"H5PackageFile", "::", "usage"}], "=", 
                  "\"doooooooooooooooop\""}], ";"}], "\n", 
              RowBox[{RowBox[{"$H5CalculationMode", "::", "\";____;\""}], 
                ";"}]}], "CodeInput"]}, Open]], 
        Cell[CellGroupData[{Cell["\[LeftCeiling]ReloadDVR\[RightFloor]", 
            "CodeSubsubsection", Evaluatable -> True], 
           Cell[BoxData[RowBox[{RowBox[{RowBox[{"ReloadDVRPackage", "::", 
                   "usage"}], "=", "\"\""}], ";"}]], "CodeInput"]}, Closed]], 
        Cell[CellGroupData[{Cell["\[LeftCeiling]Core Data\[RightFloor]", 
            "CodeSubsubsection", Evaluatable -> True], 
           Cell[BoxData[{RowBox[{RowBox[{RowBox[{"CompiledSAPot", "::", 
                    "usage"}], "=", "\"\""}], ";"}], "\n", 
              RowBox[{RowBox[{RowBox[{"H5PointwiseInterpCut", "::", 
                    "usage"}], "=", "\"\""}], ";"}], "\n", 
              RowBox[{RowBox[{RowBox[{"H5VectorizedInterpCut", "::", 
                    "usage"}], "=", "\"\""}], ";"}], "\n", 
              RowBox[{RowBox[{RowBox[{"h5PotCut", "::", "usage"}], "=", 
                  "\"\""}], ";"}], "\n", RowBox[{RowBox[
                 {RowBox[{"h5PotCutVec", "::", "usage"}], "=", "\"\""}], 
                ";"}]}], "CodeInput"], Cell[CellGroupData[
             {Cell["\[LeftCeiling] Base Geom\[RightFloor]", 
               "CodeSubsubsubsection", Evaluatable -> True], Cell[BoxData[
                RowBox[{RowBox[{RowBox[{"$H5PotentialRegion", "::", 
                      "usage"}], "=", "\"\""}], ";"}]], "CodeInput"], 
              Cell[BoxData[{RowBox[{RowBox[{RowBox[{"H5FullInterpPot", "::", 
                       "usage"}], "=", "\"\""}], ";"}], "\n", RowBox[
                  {RowBox[{RowBox[{"H5FullPot", "::", "usage"}], "=", 
                     "\"\""}], ";"}], "\n", RowBox[{RowBox[{RowBox[
                      {"H5FullVecPot", "::", "usage"}], "=", "\"\""}], 
                   ";"}]}], "CodeInput"], Cell[BoxData[RowBox[
                 {RowBox[{RowBox[{"H5OptDistances", "::", "usage"}], "=", 
                    "\"\""}], ";"}]], "CodeInput"], Cell[BoxData[
                {RowBox[{RowBox[{RowBox[{"$H5DipoleSurfaceQuantityArray", 
                       "::", "usage"}], "=", "\"\""}], ";"}], "\n", 
                 RowBox[{RowBox[{RowBox[{"$H5DipoleSurfaceInterps", "::", 
                       "usage"}], "=", "\"\""}], ";"}], "\n", RowBox[
                  {RowBox[{RowBox[{"$H5DipoleSurfaceVec", "::", "usage"}], 
                     "=", "\"\""}], ";"}]}], "CodeInput"]}, Open]], 
           Cell[CellGroupData[
             {Cell["\[LeftCeiling]Parallel Geom\[RightFloor]", 
               "CodeSubsubsubsection", Evaluatable -> True], Cell[BoxData[
                {RowBox[{RowBox[{RowBox[{"$H5OldInterpPot", "::", "usage"}], 
                     "=", "\"\""}], ";"}], "\n", RowBox[{RowBox[
                    {RowBox[{"$H5OldPot", "::", "usage"}], "=", "\"\""}], 
                   ";"}], "\n", RowBox[{RowBox[{RowBox[{"$H5OldVecPot", "::", 
                       "usage"}], "=", "\"\""}], ";"}]}], "CodeInput"], 
              Cell[BoxData[{RowBox[{RowBox[{RowBox[
                      {"$H5ParallelFullInterpPot", "::", "usage"}], "=", 
                     "\"\""}], ";"}], "\n", RowBox[{RowBox[{RowBox[
                      {"$H5ParallelFullPot", "::", "usage"}], "=", "\"\""}], 
                   ";"}], "\n", RowBox[{RowBox[{RowBox[
                      {"$H5ParallelFullVecPot", "::", "usage"}], "=", 
                     "\"\""}], ";"}]}], "CodeInput"], Cell[BoxData[
                {RowBox[{RowBox[{RowBox[
                      {"$H5ParallelDipoleSurfaceQuantityArray", "::", 
                       "usage"}], "=", "\"\""}], ";"}], "\n", RowBox[
                  {RowBox[{RowBox[{"$H5ParallelDipoleSurfaceInterps", "::", 
                       "usage"}], "=", "\"\""}], ";"}], "\n", RowBox[
                  {RowBox[{RowBox[{"$H5ParallelDipoleSurfaceVec", "::", 
                       "usage"}], "=", "\"\""}], ";"}]}], "CodeInput"]}, 
             Open]]}, Open]], Cell[CellGroupData[
          {Cell["\[LeftCeiling]Potentials\[RightFloor]", "CodeSubsubsection", 
            Evaluatable -> True], Cell[BoxData[
             {RowBox[{RowBox[{RowBox[{"outerH2Pot", "::", "usage"}], "=", 
                  "\"\""}], ";"}], "\n", RowBox[{RowBox[
                 {RowBox[{"sharedHPot", "::", "usage"}], "=", "\"\""}], 
                ";"}], "\n", RowBox[{RowBox[{RowBox[{"h2SinglePot", "::", 
                    "usage"}], "=", "\"\""}], ";"}], "\n", 
              RowBox[{RowBox[{RowBox[{"h2OldSinglePot", "::", "usage"}], "=", 
                  "\"\""}], ";"}], "\n", RowBox[{RowBox[
                 {RowBox[{"h2ParallelSinglePot", "::", "usage"}], "=", 
                  "\"\""}], ";"}], "\n", RowBox[{RowBox[{RowBox[{"h2Pot", 
                    "::", "usage"}], "=", "\"\""}], ";"}]}], "CodeInput"]}, 
          Open]], Cell[CellGroupData[{Cell["\[LeftCeiling]DVRs\[RightFloor]", 
            "CodeSubsubsection", Evaluatable -> True], 
           Cell[BoxData[{RowBox[{RowBox[{RowBox[{"$H5DVR", "::", "usage"}], 
                  "=", "\"\""}], ";"}], "\n", RowBox[{RowBox[
                 {RowBox[{"$H2DVR", "::", "usage"}], "=", "\"\""}], ";"}], 
              "\n", RowBox[{RowBox[{RowBox[{"$H2SingleDVR", "::", "usage"}], 
                  "=", "\"\""}], ";"}], "\n", RowBox[{RowBox[
                 {RowBox[{"$H54DDVR", "::", "usage"}], "=", "\"\""}], 
                ";"}]}], "CodeInput"], Cell[BoxData[
             {RowBox[{RowBox[{RowBox[{"$D5DVR", "::", "usage"}], "=", 
                  "\"\""}], ";"}], "\n", RowBox[{RowBox[{RowBox[{"$D2DVR", 
                    "::", "usage"}], "=", "\"\""}], ";"}], "\n", 
              RowBox[{RowBox[{RowBox[{"$D2SingleDVR", "::", "usage"}], "=", 
                  "\"\""}], ";"}]}], "CodeInput"]}, Open]], 
        Cell[CellGroupData[{Cell["\[LeftCeiling]Plots\[RightFloor]", 
            "CodeSubsubsection", Evaluatable -> True], 
           Cell[BoxData[{RowBox[{RowBox[{RowBox[{"ListPlot5D", "::", 
                    "usage"}], "=", "\"\""}], ";"}], "\n", 
              RowBox[{RowBox[{RowBox[{"ListDensityPlot5D", "::", "usage"}], 
                  "=", "\"\""}], ";"}], "\n", RowBox[{RowBox[
                 {RowBox[{"H54DPlot", "::", "usage"}], "=", "\"\""}], ";"}], 
              "\n", RowBox[{RowBox[{RowBox[{"H54DDensityPlot", "::", 
                    "usage"}], "=", "\"\""}], ";"}]}], "CodeInput"]}, 
          Closed]], Cell[CellGroupData[
          {Cell["\[LeftCeiling]Misc\[RightFloor]", "CodeSubsubsection", 
            Evaluatable -> True], Cell[BoxData[RowBox[{RowBox[
                {RowBox[{"$H2StateAssignments", "::", "usage"}], "=", 
                 "\"\""}], ";"}]], "CodeInput"]}, Closed]]}, Open]], 
     Cell[CellGroupData[
       {Cell[BoxData[RowBox[{RowBox[{"Begin", "[", "\"`Private`\"", "]"}], 
            ";"}]], "InputSection"], 
        Cell[BoxData[RowBox[{"<<", "ChemTools`DVR`"}]], "CodeInput", 
         CellChangeTimes -> {{3.734891785515036*^9, 3.734891788905822*^9}}, 
         CellLabel -> "In[1]:="], 
        Cell[BoxData[RowBox[{RowBox[{"$H5PotentialRegion", "=", "\n", "\t", 
              RowBox[{"{", "\n", "\t\t", RowBox[{RowBox[{"{", RowBox[
                     {"0.15", ",", " ", "2.00"}], "}"}], ",", "\n", "\t\t", 
                  RowBox[{"{", RowBox[{"0.15", ",", " ", "2.00"}], "}"}], 
                  ",", "\n", "\t\t", RowBox[{"{", RowBox[{"0.45", ",", " ", 
                      "4.00"}], "}"}], ",", "\n", "\t\t", RowBox[
                   {"{", RowBox[{"0.45", ",", " ", "4.00"}], "}"}]}], "\n", 
                "\t\t", "}"}]}], ";"}]], "CodeInput"], 
        Cell[BoxData[RowBox[{RowBox[{"If", "[", RowBox[{RowBox[
                 {"!", RowBox[{"ValueQ", "[", "$H5CalculationMode", "]"}]}], 
                ",", " ", "\n", "\t", RowBox[{"$H5CalculationMode", " ", "=", 
                  " ", "\"CoreGrid\""}]}], RowBox[{"(*", "\"Minimal\"", 
                "*)"}], "\n", "\t", "]"}], ";", " ", 
            RowBox[{"(*", RowBox[{"choices", " ", "are", " ", RowBox[
                 {RowBox[{"\"CoreGrid\"", " ", "/", " ", 
                    "\"Extrapolated\""}], " ", "/", " ", "\"Minimal\""}]}], 
              "*)"}]}]], "CodeInput"]}, Open]], 
     Cell[CellGroupData[{Cell["\[LeftCeiling]Directories\[RightFloor]", 
         "CodeSubsection", Evaluatable -> True], 
        Cell[BoxData[RowBox[{RowBox[{"$H5Directory", " ", "=", " ", "\n", 
              "\t", RowBox[{"Nest", "[", RowBox[{"DirectoryName", ",", " ", 
                  "$InputFileName", ",", " ", "2"}], "]"}]}], ";"}]], 
         "CodeInput"], Cell[BoxData[RowBox[{RowBox[{"H5PackageFile", "[", 
              "path__", "]"}], ":=", "\n", "\t", RowBox[{"FileNameJoin", "@", 
              RowBox[{"Flatten", "@", RowBox[{"{", RowBox[{"$H5Directory", 
                    ",", " ", "path"}], "}"}]}]}]}]], "CodeInput"]}, 
       Closed]], Cell[CellGroupData[
       {Cell["\[LeftCeiling]ReloadDVRPackage\[RightFloor]", "CodeSubsection", 
         Evaluatable -> True], Cell[BoxData[RowBox[
           {RowBox[{"ReloadDVRPackage", "[", "]"}], ":=", 
            RowBox[{"(", "\n", "\t", RowBox[{RowBox[{"ChemTools", "[", 
                  RowBox[{"\"Get\"", ",", " ", "\"DVR/Package/Object\""}], 
                  "]"}], ";", "\n", "\t", RowBox[{"ChemTools", "[", 
                  RowBox[{"\"Get\"", ",", " ", "\"DVR/Package/Grid\""}], 
                  "]"}], ";", "\n", "\t", RowBox[{"ChemTools", "[", 
                  RowBox[{"\"Get\"", ",", " ", 
                    "\"DVR/Package/KineticEnergy\""}], "]"}], ";", "\n", 
                "\t", RowBox[{"ChemTools", "[", RowBox[{"\"Get\"", ",", " ", 
                    "\"DVR/Package/PotentialEnergy\""}], "]"}], ";", "\n", 
                "\t", RowBox[{"ChemTools", "[", RowBox[{"\"Get\"", ",", " ", 
                    "\"DVR/Package/PotentialOptimization\""}], "]"}], ";", 
                "\n", "\t", RowBox[{"ChemTools", "[", RowBox[{"\"Get\"", ",", 
                    " ", "\"DVR/Package/Wavefunctions\""}], "]"}], ";", "\n", 
                "\t", RowBox[{"ChemTools", "[", RowBox[{"\"Get\"", ",", " ", 
                    "\"DVR/Package/Plots\""}], "]"}], ";"}], "\n", "\t", 
              ")"}]}]], "CodeInput"]}, Closed]], 
     Cell[CellGroupData[
       {Cell["\[LeftCeiling]Compiled SA Potential\[RightFloor]", 
         "CodeSubsection", CellMargins -> {{55, Inherited}, 
           {Inherited, Inherited}}, Evaluatable -> True, 
         CellChangeTimes -> {{3.738598778071834*^9, 3.738598788517665*^9}}], 
        Cell[CellGroupData[{Cell["compiledSAPot", "CodeSubsubsection", 
            CellChangeTimes -> {3.740170183152598*^9}], 
           Cell[BoxData[RowBox[{RowBox[{RowBox[{"compiledSAPot", "[", 
                   "potInterp_", "]"}], ":=", "\n", "\t", RowBox[{"With", 
                   "[", RowBox[{RowBox[{"{", RowBox[{"dom", "=", RowBox[
                          {"potInterp", "[", RowBox[{"[", "1", "]"}], 
                          "]"}]}], "}"}], ",", "\n", "\t", "\t", RowBox[
                      {"Compile", "[", RowBox[{RowBox[{"{", RowBox[{"{", 
                          RowBox[{"sa", ",", "_Real", ",", "1"}], "}"}], 
                          "}"}], ",", "\n", "\t", "\t\t", RowBox[{"With", 
                          "[", "\n", "\t", "\t\t\t", RowBox[{RowBox[{"{", 
                          "\n", "\t", "\t\t\t\t", RowBox[{RowBox[{"R1", "=", 
                          RowBox[{RowBox[{"1", "/", RowBox[{"Sqrt", "[", "2", 
                          "]"}]}], RowBox[{"(", RowBox[{RowBox[{"sa", "[", 
                          RowBox[{"[", "2", "]"}], "]"}], "+", RowBox[{"sa", 
                          "[", RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], 
                          ",", "\n", "\t", "\t\t\t\t", RowBox[{"R2", "=", 
                          RowBox[{RowBox[{"1", "/", RowBox[{"Sqrt", "[", "2", 
                          "]"}]}], RowBox[{"(", RowBox[{RowBox[{"sa", "[", 
                          RowBox[{"[", "2", "]"}], "]"}], "-", RowBox[{"sa", 
                          "[", RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}]}], 
                          "\n", "\t", "\t\t\t\t", "}"}], ",", "\n", "\t", 
                          "\t\t\t", RowBox[{"If", "[", RowBox[{RowBox[
                          {RowBox[{RowBox[{"dom", "[", RowBox[{"[", RowBox[
                          {"1", ",", "1"}], "]"}], "]"}], "\[LessEqual]", 
                          "R2", "\[LessEqual]", RowBox[{"dom", "[", RowBox[
                          {"[", RowBox[{"1", ",", "2"}], "]"}], "]"}]}], 
                          "&&", "\n", "\t", "\t\t\t\t", RowBox[{RowBox[
                          {"dom", "[", RowBox[{"[", RowBox[{"2", ",", "1"}], 
                          "]"}], "]"}], "\[LessEqual]", "R1", "\[LessEqual]", 
                          RowBox[{"dom", "[", RowBox[{"[", RowBox[{"2", ",", 
                          "2"}], "]"}], "]"}]}]}], ",", "\n", "\t", 
                          "\t\t\t\t", RowBox[{"potInterp", "[", RowBox[{"R1", 
                          ",", " ", "R2"}], "]"}], ",", "\n", "\t", 
                          "\t\t\t\t", RowBox[{"10", "^", "9"}]}], "\n", "\t", 
                          "\t\t\t\t", "]"}]}], "\n", "\t", "\t\t\t", "]"}], 
                         ",", "\n", "\t", "\t\t", RowBox[{"RuntimeOptions", 
                          "\[Rule]", RowBox[{"{", "\n", "\t", "\t\t\t", 
                          RowBox[{RowBox[{"\"EvaluateSymbolically\"", 
                          "\[Rule]", "False"}], ",", "\n", "\t", "\t\t\t", 
                          RowBox[{"\"WarningMessages\"", "\[Rule]", 
                          "False"}]}], "\n", "\t", "\t\t\t", "}"}]}]}], "\n", 
                       "\t", "\t\t", "]"}]}], "\n", "\t", "\t", "]"}]}], 
               ";"}]], "CodeInput"]}, Closed]], 
        Cell[CellGroupData[{Cell["CompiledSAPot", "CodeSubsubsection"], 
           Cell[BoxData[RowBox[{"CompiledSAPot", "=", "compiledSAPot"}]], 
            "CodeInput"]}, Closed]]}, Open]], 
     Cell[CellGroupData[{Cell["\[LeftCeiling]Domains\[RightFloor]", 
         "CodeSubsection", Evaluatable -> True], 
        Cell[BoxData[RowBox[{"domainSpecs", "=", RowBox[
             {RowBox[{"{", RowBox[{"Repeated", "[", RowBox[{RowBox[
                     {"{", RowBox[{"_", ",", " ", "_"}], "}"}], ",", " ", 
                    RowBox[{"{", "4", "}"}]}], "]"}], "}"}], "|", 
              "\"Extrapolated\"", "|", "\"CoreGrid\"", "|", "\"Minimal\"", 
              "|", "Automatic"}]}]], "CodeInput"], 
        Cell[BoxData[RowBox[{RowBox[{"getDomain", "[", RowBox[{"interp_", 
                ",", " ", "domain_"}], "]"}], ":=", "\n", "\t", 
            RowBox[{"Replace", "[", "\n", "\t\t", RowBox[{RowBox[{"Replace", 
                  "[", RowBox[{"domain", ",", " ", RowBox[{"Automatic", ":>", 
                      "$H5CalculationMode"}]}], "]"}], ",", "\n", "\t\t", 
                RowBox[{"{", "\n", "\t\t\t", RowBox[{RowBox[
                     {"\"Extrapolated\"", ":>", "$H5PotentialRegion"}], ",", 
                    "\n", "\t\t\t", RowBox[{"\"Minimal\"", ":>", "\n", 
                      "\t\t\t\t", RowBox[{"MapThread", "[", "\n", 
                        "\t\t\t\t\t", RowBox[{RowBox[{RowBox[{"{", RowBox[
                          {RowBox[{"Max", "@", RowBox[{"{", RowBox[{RowBox[
                          {"#", "[", RowBox[{"[", "1", "]"}], "]"}], ",", 
                          " ", RowBox[{"#2", "[", RowBox[{"[", "1", "]"}], 
                          "]"}]}], "}"}]}], ",", " ", RowBox[{"Min", "@", 
                          RowBox[{"{", RowBox[{RowBox[{"#", "[", RowBox[{"[", 
                          "2", "]"}], "]"}], ",", " ", RowBox[{"#2", "[", 
                          RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}]}], "}"}], 
                          "&"}], ",", "\n", "\t\t\t\t\t", RowBox[{"{", "\n", 
                          "\t\t\t\t\t\t", RowBox[{RowBox[{"interp", "[", 
                          RowBox[{"[", "1", "]"}], "]"}], ",", "\n", 
                          "\t\t\t\t\t\t", "$H5PotentialRegion"}], "\n", 
                          "\t\t\t\t\t\t", "}"}]}], "\n", "\t\t\t\t\t", 
                        "]"}]}], ",", "\n", "\t\t\t", RowBox[{"\"CoreGrid\"", 
                      ":>", RowBox[{"interp", "[", RowBox[{"[", "1", "]"}], 
                        "]"}]}]}], "\n", "\t\t\t", "}"}]}], "\n", "\t\t", 
              "]"}]}]], "CodeInput"]}, Open]], 
     Cell[CellGroupData[
       {Cell["\[LeftCeiling]Interpolation Cuts\[RightFloor]", 
         "CodeSubsection", Evaluatable -> True, CellChangeTimes -> 
          {{3.7413270565203123*^9, 3.741327063416196*^9}}], 
        Cell[CellGroupData[{Cell["\[LeftCeiling]Pointwise\[RightFloor]", 
            "CodeSubsubsection", Evaluatable -> True, CellChangeTimes -> 
             {{3.738605817394455*^9, 3.738605818808558*^9}}], 
           Cell[BoxData[{RowBox[{"H5PointwiseInterpCut", "//", "Clear"}], 
              "\n", RowBox[{RowBox[{RowBox[{"H5PointwiseInterpCut", "[", 
                    "\n", "\t", RowBox[{RowBox[{"{", RowBox[{"HA_", ",", " ", 
                          "HS_", ",", " ", "h2r1_", ",", " ", "h2r2_"}], 
                        "}"}], ",", " ", "\n", "\t", "interp_", ",", " ", 
                      "\n", "\t", RowBox[{"domain", ":", "domainSpecs", ":", 
                        "Automatic"}], ",", "\n", "\t", RowBox[{"def", ":", 
                        RowBox[{"_", "?", "NumericQ"}], ":", RowBox[{"10.", 
                          "^", "9"}]}], ",", " ", "\n", "\t", RowBox[
                       {"min", ":", RowBox[{"_", "?", "NumericQ"}], ":", 
                        "0."}]}], "\n", "\t", "]"}], ":=", "\n", 
                  RowBox[{"With", "[", "\n", "\t", RowBox[{RowBox[{"{", "\n", 
                        "\t\t", RowBox[{RowBox[{"potInterp", "=", "interp"}], 
                          ",", "\n", "\t\t", RowBox[{"dom", "=", RowBox[
                          {"getDomain", "[", RowBox[{"interp", ",", " ", 
                          "domain"}], "]"}]}]}], "\n", "\t\t", "}"}], ",", 
                      "\n", "\t", RowBox[{"Block", "[", RowBox[{RowBox[
                          {"{", "asr1r2", "}"}], ",", "\n", "\t\t", RowBox[
                          {"Compile", "@@", "\n", "\t\t", RowBox[{"With", 
                          "[", "\n", "\t\t\t", RowBox[{RowBox[{"{", "\n", 
                          "\t\t\t\t", RowBox[{RowBox[{"r1Min", "=", RowBox[
                          {"dom", "[", RowBox[{"[", RowBox[{"1", ",", "1"}], 
                          "]"}], "]"}]}], ",", " ", RowBox[{"r1Max", "=", 
                          RowBox[{"dom", "[", RowBox[{"[", RowBox[{"1", ",", 
                          "2"}], "]"}], "]"}]}], ",", "\n", "\t\t\t\t", 
                          RowBox[{"r2Min", "=", RowBox[{"dom", "[", RowBox[
                          {"[", RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ",", 
                          " ", RowBox[{"r2Max", "=", RowBox[{"dom", "[", 
                          RowBox[{"[", RowBox[{"2", ",", "2"}], "]"}], 
                          "]"}]}], ",", "\n", "\t\t\t\t", RowBox[{"R1Min", 
                          "=", RowBox[{"dom", "[", RowBox[{"[", RowBox[{"3", 
                          ",", "1"}], "]"}], "]"}]}], ",", " ", RowBox[
                          {"R1Max", "=", RowBox[{"dom", "[", RowBox[{"[", 
                          RowBox[{"3", ",", "2"}], "]"}], "]"}]}], ",", "\n", 
                          "\t\t\t\t", RowBox[{"R2Min", "=", RowBox[{"dom", 
                          "[", RowBox[{"[", RowBox[{"4", ",", "1"}], "]"}], 
                          "]"}]}], ",", " ", RowBox[{"R2Max", "=", RowBox[
                          {"dom", "[", RowBox[{"[", RowBox[{"4", ",", "2"}], 
                          "]"}], "]"}]}], ",", "\n", "\t\t\t\t", RowBox[
                          {"varBlock", "=", "\n", "\t\t\t\t", RowBox[
                          {"Quiet", "@", "\n", "\t\t\t\t", RowBox[{"{", "\n", 
                          "\t\t\t\t\t", RowBox[{RowBox[{"\"R1\"", "\[Rule]", 
                          "\n", "\t\t\t\t\t", RowBox[{"Switch", "[", "\n", 
                          "\t\t\t\t\t\t", RowBox[{RowBox[{"{", RowBox[{"HA", 
                          ",", " ", "HS"}], "}"}], ",", "\n", "\t\t\t\t\t\t", 
                          RowBox[{"{", RowBox[{"Automatic", ",", " ", 
                          "Automatic"}], "}"}], ",", "\n", "\t\t\t\t\t\t", 
                          RowBox[{RowBox[{"1", "/", RowBox[{"Sqrt", "[", 
                          "2.", "]"}]}], RowBox[{"(", RowBox[{RowBox[{
                          "asr1r2", "[", RowBox[{"[", "2", "]"}], "]"}], "+", 
                          RowBox[{"asr1r2", "[", RowBox[{"[", "1", "]"}], 
                          "]"}]}], ")"}]}], ",", "\n", "\t\t\t\t\t\t", RowBox[
                          {"{", RowBox[{"Automatic", ",", " ", "_"}], "}"}], 
                          ",", "\n", "\t\t\t\t\t\t", RowBox[{RowBox[{"1", 
                          "/", RowBox[{"Sqrt", "[", "2.", "]"}]}], RowBox[
                          {"(", RowBox[{"HS", "+", RowBox[{"asr1r2", "[", 
                          RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], ",", 
                          "\n", "\t\t\t\t\t\t", RowBox[{"{", RowBox[{"_", 
                          ",", " ", "Automatic"}], "}"}], ",", "\n", 
                          "\t\t\t\t\t\t", RowBox[{RowBox[{"1", "/", RowBox[
                          {"Sqrt", "[", "2.", "]"}]}], RowBox[{"(", RowBox[
                          {RowBox[{"asr1r2", "[", RowBox[{"[", "1", "]"}], 
                          "]"}], "+", "HA"}], ")"}]}], ",", "\n", 
                          "\t\t\t\t\t\t", RowBox[{"{", RowBox[{"_", ",", " ", 
                          "_"}], "}"}], ",", "\n", "\t\t\t\t\t\t", RowBox[
                          {RowBox[{"1", "/", RowBox[{"Sqrt", "[", "2.", 
                          "]"}]}], RowBox[{"(", RowBox[{"HA", "+", "HS"}], 
                          ")"}]}]}], "\n", "\t\t\t\t\t\t", "]"}]}], ",", 
                          "\n", "\t\t\t\t\t", RowBox[{"\"R2\"", "\[Rule]", 
                          "\n", "\t\t\t\t\t", RowBox[{"Switch", "[", "\n", 
                          "\t\t\t\t\t\t", RowBox[{RowBox[{"{", RowBox[{"HA", 
                          ",", " ", "HS"}], "}"}], ",", "\n", "\t\t\t\t\t\t", 
                          RowBox[{"{", RowBox[{"Automatic", ",", " ", 
                          "Automatic"}], "}"}], ",", "\n", "\t\t\t\t\t\t", 
                          RowBox[{RowBox[{"1", "/", RowBox[{"Sqrt", "[", 
                          "2.", "]"}]}], RowBox[{"(", RowBox[{RowBox[{
                          "asr1r2", "[", RowBox[{"[", "2", "]"}], "]"}], "-", 
                          RowBox[{"asr1r2", "[", RowBox[{"[", "1", "]"}], 
                          "]"}]}], ")"}]}], ",", "\n", "\t\t\t\t\t\t", RowBox[
                          {"{", RowBox[{"Automatic", ",", " ", "_"}], "}"}], 
                          ",", "\n", "\t\t\t\t\t\t", RowBox[{RowBox[{"1", 
                          "/", RowBox[{"Sqrt", "[", "2.", "]"}]}], RowBox[
                          {"(", RowBox[{"HS", "-", RowBox[{"asr1r2", "[", 
                          RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], ",", 
                          "\n", "\t\t\t\t\t\t", RowBox[{"{", RowBox[{"_", 
                          ",", " ", "Automatic"}], "}"}], ",", "\n", 
                          "\t\t\t\t\t\t", RowBox[{RowBox[{"1", "/", RowBox[
                          {"Sqrt", "[", "2.", "]"}]}], RowBox[{"(", RowBox[
                          {RowBox[{"asr1r2", "[", RowBox[{"[", "1", "]"}], 
                          "]"}], "-", "HA"}], ")"}]}], ",", "\n", 
                          "\t\t\t\t\t\t", RowBox[{"{", RowBox[{"_", ",", " ", 
                          "_"}], "}"}], ",", "\n", "\t\t\t\t\t\t", RowBox[
                          {RowBox[{"1", "/", RowBox[{"Sqrt", "[", "2.", 
                          "]"}]}], RowBox[{"(", RowBox[{"HS", "-", "HA"}], 
                          ")"}]}]}], "\n", "\t\t\t\t\t\t", "]"}]}], ",", 
                          "\n", "\t\t\t\t\t", RowBox[{"\"r1\"", "\[Rule]", 
                          "\n", "\t\t\t\t\t", RowBox[{"If", "[", RowBox[
                          {RowBox[{"h2r1", "===", "Automatic"}], ",", "\n", 
                          "\t\t\t\t\t\t", RowBox[{"asr1r2", "[", RowBox[{"[", 
                          RowBox[{RowBox[{"Count", "[", RowBox[{RowBox[{"{", 
                          RowBox[{"HA", ",", " ", "HS"}], "}"}], ",", " ", 
                          "Automatic"}], "]"}], "+", "1"}], "]"}], "]"}], 
                          ",", "\n", "\t\t\t\t\t\t", "h2r1"}], "\n", 
                          "\t\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t\t\t", 
                          RowBox[{"\"r2\"", "\[Rule]", "\n", "\t\t\t\t\t", 
                          RowBox[{"If", "[", RowBox[{RowBox[{"h2r2", "===", 
                          "Automatic"}], ",", "\n", "\t\t\t\t\t\t", RowBox[
                          {"asr1r2", "[", RowBox[{"[", RowBox[{RowBox[{
                          "Count", "[", RowBox[{RowBox[{"{", RowBox[{"HA", 
                          ",", " ", "HS", ",", " ", "h2r1"}], "}"}], ",", 
                          " ", "Automatic"}], "]"}], "+", "1"}], "]"}], 
                          "]"}], ",", "\n", "\t\t\t\t\t\t", "h2r2"}], "\n", 
                          "\t\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t\t\t", 
                          "}"}]}]}]}], "\n", "\t\t\t\t", "}"}], ",", "\n", 
                          "\t\t\t", RowBox[{"With", "[", "\n", "\t\t\t\t", 
                          RowBox[{RowBox[{"{", "\n", "\t\t\t\t\t", RowBox[
                          {"test", "=", "\n", "\t\t\t\t\t", RowBox[{"With", 
                          "[", RowBox[{RowBox[{"{", RowBox[{"tests", "=", 
                          RowBox[{RowBox[{"{", RowBox[{RowBox[{"r1Min", 
                          "\[LessEqual]", "\"r1\"", "\[LessEqual]", 
                          "r1Max"}], ",", RowBox[{"r2Min", "\[LessEqual]", 
                          "\"r2\"", "\[LessEqual]", "r2Max"}], ",", "\n", 
                          "\t\t\t\t\t\t\t", RowBox[{"R1Min", "\[LessEqual]", 
                          "\"R1\"", "\[LessEqual]", "R1Max"}], ",", RowBox[
                          {"R2Min", "\[LessEqual]", "\"R2\"", "\[LessEqual]", 
                          "R2Max"}]}], "}"}], "/.", "varBlock"}]}], "}"}], 
                          ",", "\n", "\t\t\t\t\t\t", RowBox[{"If", "[", 
                          RowBox[{RowBox[{"MemberQ", "[", RowBox[{"tests", 
                          ",", " ", RowBox[{"False", "&"}]}], "]"}], ",", 
                          "\n", "\t\t\t\t\t\t\t", "False", ",", "\n", 
                          "\t\t\t\t\t\t\t", RowBox[{"And", "@@", RowBox[
                          {"DeleteCases", "[", RowBox[{"tests", ",", " ", 
                          "True"}], "]"}]}]}], "\n", "\t\t\t\t\t\t\t", 
                          "]"}]}], "\n", "\t\t\t\t\t\t", "]"}]}], "\n", 
                          "\t\t\t\t\t", "}"}], ",", "\n", "\t\t\t\t", RowBox[
                          {RowBox[{"Hold", "[", "\n", "\t\t\t\t\t", RowBox[
                          {RowBox[{"{", RowBox[{"{", RowBox[{"asr1r2", ",", 
                          "_Real", ",", "1"}], "}"}], "}"}], ",", "\n", 
                          "\t\t\t\t\t", RowBox[{"With", "[", "\n", 
                          "\t\t\t\t\t\t", RowBox[{RowBox[{"{", "\n", 
                          "\t\t\t\t\t\t\t", RowBox[{RowBox[{"R1", "=", 
                          "\"R1\""}], ",", "\n", "\t\t\t\t\t\t\t", RowBox[
                          {"R2", "=", "\"R2\""}], ",", "\n", 
                          "\t\t\t\t\t\t\t", RowBox[{"r1", "=", "\"r1\""}], 
                          ",", "\n", "\t\t\t\t\t\t\t", RowBox[{"r2", "=", 
                          "\"r2\""}]}], "\n", "\t\t\t\t\t\t\t", "}"}], ",", 
                          "\n", "\t\t\t\t\t\t", RowBox[{"Module", "[", RowBox[
                          {RowBox[{"{", RowBox[{RowBox[{"default", "=", 
                          "def"}], ",", " ", RowBox[{"mininmum", "=", 
                          "min"}]}], "}"}], ",", "\n", "\t\t\t\t\t\t\t", 
                          RowBox[{"If", "[", RowBox[{"test", ",", "\n", 
                          "\t\t\t\t\t\t\t\t", RowBox[{RowBox[{"potInterp", 
                          "[", RowBox[{"r1", ",", " ", "r2", ",", " ", "R1", 
                          ",", " ", "R2"}], "]"}], "-", "mininmum"}], ",", 
                          "\n", "\t\t\t\t\t\t\t\t", "default"}], "\n", 
                          "\t\t\t\t\t\t\t\t", "]"}]}], "\n", 
                          "\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t", 
                          "]"}], ",", "\n", "\t\t\t\t\t", RowBox[{
                          "RuntimeOptions", "\[Rule]", RowBox[{"{", "\n", 
                          "\t\t\t\t\t\t", RowBox[{RowBox[{
                          "\"EvaluateSymbolically\"", "\[Rule]", "False"}], 
                          ",", "\n", "\t\t\t\t\t\t", RowBox[{
                          "\"WarningMessages\"", "\[Rule]", "False"}]}], 
                          "\n", "\t\t\t\t\t\t", "}"}]}], ",", "\n", 
                          "\t\t\t\t\t", RowBox[{"RuntimeAttributes", 
                          "\[Rule]", RowBox[{"{", "Listable", "}"}]}]}], 
                          "\n", "\t\t\t\t\t", "]"}], "/.", "varBlock"}]}], 
                          "\n", "\t\t\t\t", "]"}]}], "\n", "\t\t\t", 
                          "]"}]}]}], "\n", "\t\t", "]"}]}], "\n", "\t", 
                    "]"}]}], ";"}]}], "CodeInput"], 
           Cell[BoxData[RowBox[{RowBox[{"h5PotCut", "[", RowBox[
                  {RowBox[{"{", RowBox[{"HA_", ",", " ", "HS_", ",", " ", 
                       "h2r1_", ",", " ", "h2r2_"}], "}"}], ",", " ", 
                   RowBox[{"min_:", "0."}]}], "]"}], ":=", "\n", "\t", RowBox[
                {"H5PointwiseInterpCut", "[", "\n", "\t\t", RowBox[
                  {RowBox[{"{", RowBox[{"HA", ",", " ", "HS", ",", " ", 
                       "h2r1", ",", " ", "h2r2"}], "}"}], ",", "\n", "\t", 
                   "\t", "H5FullInterpPot", ",", "\n", "\t", "\t", 
                   RowBox[{"10.", "^", "9"}], ",", "\n", "\t", "\t", "min"}], 
                 "\n", "\t", "\t", "]"}]}]], "CodeInput"]}, Open]], 
        Cell[CellGroupData[{Cell["\[LeftCeiling]Vectorized\[RightFloor]", 
            "CodeSubsubsection", Evaluatable -> True, CellChangeTimes -> 
             {{3.738605821218403*^9, 3.738605822584381*^9}}], 
           Cell[BoxData[RowBox[{"(*", RowBox[{RowBox[{"RotationTransform", 
                   "[", RowBox[{RowBox[{"-", "\[Pi]"}], "/", "4"}], "]"}], 
                 "@", RowBox[{"{", RowBox[{"a", ",", " ", "s"}], "}"}]}], 
               "*)"}]], "CodeInput", CellChangeTimes -> 
             {{3.742184357103009*^9, 3.7421843655451*^9}}, 
            CellLabel -> "In[5]:="], Cell[BoxData[
             {RowBox[{"H5VectorizedInterpCut", "//", "Clear"}], "\n", 
              RowBox[{RowBox[{RowBox[{"H5VectorizedInterpCut", "[", 
                    RowBox[{RowBox[{"{", RowBox[{"HA_", ",", " ", "HS_", ",", 
                          " ", "h2r1_", ",", " ", "h2r2_"}], "}"}], ",", " ", 
                      "\n", "\t", "interp_", ",", " ", "\n", "\t", RowBox[
                       {"domain", ":", "domainSpecs", ":", "Automatic"}], 
                      ",", "\n", "\t", RowBox[{"def", ":", RowBox[{"_", "?", 
                          "NumericQ"}], ":", RowBox[{"10.", "^", "9"}]}], 
                      ",", " ", "\n", "\t", RowBox[{"min", ":", RowBox[
                         {"_", "?", "NumericQ"}], ":", "0."}]}], "\n", "\t", 
                    "]"}], ":=", "\n", RowBox[{"With", "[", "\n", "\t", 
                    RowBox[{RowBox[{"{", "\n", "\t\t", RowBox[{RowBox[
                          {"potInterp", "=", "interp"}], ",", "\n", "\t\t", 
                          RowBox[{"dom", "=", RowBox[{"getDomain", "[", 
                          RowBox[{"interp", ",", " ", "domain"}], "]"}]}]}], 
                        "\n", "\t\t", "}"}], ",", "\n", "\t", RowBox[
                       {"Block", "[", RowBox[{RowBox[{"{", RowBox[{"asr1r2", 
                          ",", " ", "pt"}], "}"}], ",", "\n", "\t\t", 
                          RowBox[{"(*", " ", RowBox[{"Protect", " ", "the", 
                          " ", "variables", " ", "that", " ", "will", " ", 
                          "be", " ", "fed", " ", "in"}], "*)"}], "\n", 
                          "\t\t", RowBox[{"With", "[", "\n", "\t\t\t", 
                          RowBox[{RowBox[{"{", "\n", "\t\t\t\t", RowBox[
                          {"(*", " ", RowBox[{"Decrease", " ", "function", 
                          " ", "size"}], " ", "*)"}], "\n", "\t\t\t\t", 
                          RowBox[{RowBox[{"r1Min", "=", RowBox[{"dom", "[", 
                          RowBox[{"[", RowBox[{"1", ",", "1"}], "]"}], 
                          "]"}]}], ",", " ", RowBox[{"r1Max", "=", RowBox[
                          {"dom", "[", RowBox[{"[", RowBox[{"1", ",", "2"}], 
                          "]"}], "]"}]}], ",", "\n", "\t\t\t\t", RowBox[
                          {"r2Min", "=", RowBox[{"dom", "[", RowBox[{"[", 
                          RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ",", " ", 
                          RowBox[{"r2Max", "=", RowBox[{"dom", "[", RowBox[
                          {"[", RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ",", 
                          "\n", "\t\t\t\t", RowBox[{"R1Min", "=", RowBox[
                          {"dom", "[", RowBox[{"[", RowBox[{"3", ",", "1"}], 
                          "]"}], "]"}]}], ",", " ", RowBox[{"R1Max", "=", 
                          RowBox[{"dom", "[", RowBox[{"[", RowBox[{"3", ",", 
                          "2"}], "]"}], "]"}]}], ",", "\n", "\t\t\t\t", 
                          RowBox[{"R2Min", "=", RowBox[{"dom", "[", RowBox[
                          {"[", RowBox[{"4", ",", "1"}], "]"}], "]"}]}], ",", 
                          " ", RowBox[{"R2Max", "=", RowBox[{"dom", "[", 
                          RowBox[{"[", RowBox[{"4", ",", "2"}], "]"}], 
                          "]"}]}]}], "\n", "\t\t\t\t", "}"}], ",", "\n", 
                          "\t\t\t", RowBox[{"Module", "[", "\n", "\t\t\t\t", 
                          RowBox[{RowBox[{"{", "\n", "\t\t\t\t\t", RowBox[
                          {"getPot", ",", "\n", "\t\t\t\t\t", "varBlock", 
                          ",", "\n", "\t\t\t\t\t", "varBlock2"}], "\n", 
                          "\t\t\t\t\t", "}"}], ",", "\n", "\t\t\t\t", RowBox[
                          {RowBox[{"varBlock", "=", "\n", "\t\t\t\t", RowBox[
                          {"Quiet", "@", "\n", "\t\t\t\t", RowBox[{"{", 
                          RowBox[{"(*", " ", RowBox[{"flexible", " ", 
                          "symbolic", " ", "form", " ", "for", " ", 
                          "Compile", " ", "vars"}], " ", "*)"}], "\n", 
                          "\t\t\t\t\t", RowBox[{RowBox[{"\"R1\"", "\[Rule]", 
                          "\n", "\t\t\t\t\t", RowBox[{"Switch", "[", "\n", 
                          "\t\t\t\t\t\t", RowBox[{RowBox[{"{", RowBox[{"HA", 
                          ",", " ", "HS"}], "}"}], ",", "\n", "\t\t\t\t\t\t", 
                          RowBox[{"{", RowBox[{"Automatic", ",", " ", 
                          "Automatic"}], "}"}], ",", "\n", "\t\t\t\t\t\t", 
                          RowBox[{RowBox[{"1", "/", RowBox[{"Sqrt", "[", 
                          "2.", "]"}]}], RowBox[{"(", RowBox[{RowBox[{
                          "asr1r2", "[", RowBox[{"[", "2", "]"}], "]"}], "+", 
                          RowBox[{"asr1r2", "[", RowBox[{"[", "1", "]"}], 
                          "]"}]}], ")"}]}], ",", "\n", "\t\t\t\t\t\t", RowBox[
                          {"{", RowBox[{"Automatic", ",", " ", "_"}], "}"}], 
                          ",", "\n", "\t\t\t\t\t\t", RowBox[{RowBox[{"1", 
                          "/", RowBox[{"Sqrt", "[", "2.", "]"}]}], RowBox[
                          {"(", RowBox[{"HS", "+", RowBox[{"asr1r2", "[", 
                          RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], ",", 
                          "\n", "\t\t\t\t\t\t", RowBox[{"{", RowBox[{"_", 
                          ",", " ", "Automatic"}], "}"}], ",", "\n", 
                          "\t\t\t\t\t\t", RowBox[{RowBox[{"1", "/", RowBox[
                          {"Sqrt", "[", "2.", "]"}]}], RowBox[{"(", RowBox[
                          {RowBox[{"asr1r2", "[", RowBox[{"[", "1", "]"}], 
                          "]"}], "+", "HA"}], ")"}]}], ",", "\n", 
                          "\t\t\t\t\t\t", RowBox[{"{", RowBox[{"_", ",", " ", 
                          "_"}], "}"}], ",", "\n", "\t\t\t\t\t\t", RowBox[
                          {RowBox[{"1", "/", RowBox[{"Sqrt", "[", "2.", 
                          "]"}]}], RowBox[{"(", RowBox[{"HA", "+", "HS"}], 
                          ")"}]}]}], "\n", "\t\t\t\t\t\t", "]"}]}], ",", 
                          "\n", "\t\t\t\t\t", RowBox[{"\"R2\"", "\[Rule]", 
                          "\n", "\t\t\t\t\t", RowBox[{"Switch", "[", "\n", 
                          "\t\t\t\t\t\t", RowBox[{RowBox[{"{", RowBox[{"HA", 
                          ",", " ", "HS"}], "}"}], ",", "\n", "\t\t\t\t\t\t", 
                          RowBox[{"{", RowBox[{"Automatic", ",", " ", 
                          "Automatic"}], "}"}], ",", "\n", "\t\t\t\t\t\t", 
                          RowBox[{RowBox[{"1", "/", RowBox[{"Sqrt", "[", 
                          "2.", "]"}]}], RowBox[{"(", RowBox[{RowBox[{
                          "asr1r2", "[", RowBox[{"[", "2", "]"}], "]"}], "-", 
                          RowBox[{"asr1r2", "[", RowBox[{"[", "1", "]"}], 
                          "]"}]}], ")"}]}], ",", "\n", "\t\t\t\t\t\t", RowBox[
                          {"{", RowBox[{"Automatic", ",", " ", "_"}], "}"}], 
                          ",", "\n", "\t\t\t\t\t\t", RowBox[{RowBox[{"1", 
                          "/", RowBox[{"Sqrt", "[", "2.", "]"}]}], RowBox[
                          {"(", RowBox[{"HS", "-", RowBox[{"asr1r2", "[", 
                          RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], ",", 
                          "\n", "\t\t\t\t\t\t", RowBox[{"{", RowBox[{"_", 
                          ",", " ", "Automatic"}], "}"}], ",", "\n", 
                          "\t\t\t\t\t\t", RowBox[{RowBox[{"1", "/", RowBox[
                          {"Sqrt", "[", "2.", "]"}]}], RowBox[{"(", RowBox[
                          {RowBox[{"asr1r2", "[", RowBox[{"[", "1", "]"}], 
                          "]"}], "-", "HA"}], ")"}]}], ",", "\n", 
                          "\t\t\t\t\t\t", RowBox[{"{", RowBox[{"_", ",", " ", 
                          "_"}], "}"}], ",", "\n", "\t\t\t\t\t\t", RowBox[
                          {RowBox[{"1", "/", RowBox[{"Sqrt", "[", "2.", 
                          "]"}]}], RowBox[{"(", RowBox[{"HS", "-", "HA"}], 
                          ")"}]}]}], "\n", "\t\t\t\t\t\t", "]"}]}], ",", 
                          "\n", "\t\t\t\t\t", RowBox[{"\"r1\"", "\[Rule]", 
                          "\n", "\t\t\t\t\t", RowBox[{"If", "[", RowBox[
                          {RowBox[{"h2r1", "===", "Automatic"}], ",", "\n", 
                          "\t\t\t\t\t\t", RowBox[{"asr1r2", "[", RowBox[{"[", 
                          RowBox[{RowBox[{"Count", "[", RowBox[{RowBox[{"{", 
                          RowBox[{"HA", ",", " ", "HS"}], "}"}], ",", " ", 
                          "Automatic"}], "]"}], "+", "1"}], "]"}], "]"}], 
                          ",", "\n", "\t\t\t\t\t\t", "h2r1"}], "\n", 
                          "\t\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t\t\t", 
                          RowBox[{"\"r2\"", "\[Rule]", "\n", "\t\t\t\t\t", 
                          RowBox[{"If", "[", RowBox[{RowBox[{"h2r2", "===", 
                          "Automatic"}], ",", "\n", "\t\t\t\t\t\t", RowBox[
                          {"asr1r2", "[", RowBox[{"[", RowBox[{RowBox[{
                          "Count", "[", RowBox[{RowBox[{"{", RowBox[{"HA", 
                          ",", " ", "HS", ",", " ", "h2r1"}], "}"}], ",", 
                          " ", "Automatic"}], "]"}], "+", "1"}], "]"}], 
                          "]"}], ",", "\n", "\t\t\t\t\t\t", "h2r2"}], "\n", 
                          "\t\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t\t\t", 
                          RowBox[{"\"Function\"", "\[Rule]", "Function"}]}], 
                          "\n", "\t\t\t\t\t", "}"}]}]}], ";", "\n", 
                          "\t\t\t\t", RowBox[{"(*", " ", RowBox[{"flexible", 
                          " ", "symbolic", " ", "form", " ", "for", " ", 
                          "Compile", " ", "vars"}], " ", "*)"}], "\n", 
                          "\t\t\t\t", RowBox[{RowBox[{"getPot", "[", "pts_", 
                          "]"}], ":=", RowBox[{"Apply", "[", RowBox[
                          {"potInterp", ",", " ", "pts"}], "]"}]}], ";", 
                          "\n", "\t\t\t\t", RowBox[{"(*", " ", RowBox[
                          {"bounds", " ", "checking", " ", "for", " ", 
                          "test"}], " ", "*)"}], "\n", "\t\t\t\t", RowBox[
                          {"With", "[", "\n", "\t\t\t\t\t", RowBox[{RowBox[
                          {"{", "\n", "\t\t\t\t\t\t", RowBox[{RowBox[{"domo", 
                          "=", "\n", "\t\t\t\t\t\t\t", RowBox[{"{", RowBox[
                          {RowBox[{"{", RowBox[{"r1Min", ",", " ", "r1Max"}], 
                          "}"}], ",", RowBox[{"{", RowBox[{"r2Min", ",", " ", 
                          "r2Max"}], "}"}], ",", "\n", "\t", 
                          "\t\t\t\t\t\t\t", RowBox[{"{", RowBox[{"R1Min", 
                          ",", "R1Max"}], "}"}], ",", RowBox[{"{", RowBox[
                          {"R2Min", ",", "R2Max"}], "}"}]}], "}"}]}], ",", 
                          "\n", "\t\t\t\t\t\t", RowBox[{"testos", "=", "\n", 
                          "\t\t\t\t\t\t", RowBox[{RowBox[{"{", RowBox[{RowBox[
                          {"r1Min", "\[LessEqual]", RowBox[{"pt", "[", RowBox[
                          {"[", "1", "]"}], "]"}], "\[LessEqual]", "r1Max"}], 
                          ",", RowBox[{"r2Min", "\[LessEqual]", RowBox[{"pt", 
                          "[", RowBox[{"[", "2", "]"}], "]"}], 
                          "\[LessEqual]", "r2Max"}], ",", "\n", 
                          "\t\t\t\t\t\t\t", RowBox[{"R1Min", "\[LessEqual]", 
                          RowBox[{"pt", "[", RowBox[{"[", "3", "]"}], "]"}], 
                          "\[LessEqual]", "R1Max"}], ",", RowBox[{"R2Min", 
                          "\[LessEqual]", RowBox[{"pt", "[", RowBox[{"[", 
                          "4", "]"}], "]"}], "\[LessEqual]", "R2Max"}]}], 
                          "}"}], "//", "Quiet"}]}], ",", "\n", 
                          "\t\t\t\t\t\t", RowBox[{"test", "=", "\n", 
                          "\t\t\t\t\t\t", RowBox[{"With", "[", RowBox[{RowBox[
                          {"{", RowBox[{"tests", "=", "\n", 
                          "\t\t\t\t\t\t\t\t", RowBox[{RowBox[{"{", RowBox[
                          {RowBox[{"r1Min", "\[LessEqual]", RowBox[{"pt", 
                          "[", RowBox[{"[", "1", "]"}], "]"}], 
                          "\[LessEqual]", "r1Max"}], ",", RowBox[{"r2Min", 
                          "\[LessEqual]", RowBox[{"pt", "[", RowBox[{"[", 
                          "2", "]"}], "]"}], "\[LessEqual]", "r2Max"}], ",", 
                          "\n", "\t\t\t\t\t\t\t\t\t", RowBox[{"R1Min", 
                          "\[LessEqual]", RowBox[{"pt", "[", RowBox[{"[", 
                          "3", "]"}], "]"}], "\[LessEqual]", "R1Max"}], ",", 
                          RowBox[{"R2Min", "\[LessEqual]", RowBox[{"pt", "[", 
                          RowBox[{"[", "4", "]"}], "]"}], "\[LessEqual]", 
                          "R2Max"}]}], "}"}], "//", "Quiet"}]}], "\n", 
                          "\t\t\t\t\t\t\t\t", "}"}], ",", "\n", 
                          "\t\t\t\t\t\t\t", RowBox[{"If", "[", RowBox[{RowBox[
                          {"MemberQ", "[", RowBox[{"tests", ",", " ", RowBox[
                          {"False", "&"}]}], "]"}], ",", "\n", 
                          "\t\t\t\t\t\t\t\t", "False", ",", "\n", 
                          "\t\t\t\t\t\t\t\t", RowBox[{"And", "@@", "\n", 
                          "\t\t\t\t\t\t\t\t", RowBox[{"DeleteCases", "[", 
                          "\n", "\t\t\t\t\t\t\t\t\t", RowBox[{"tests", ",", 
                          " ", "\n", "\t\t\t\t\t\t\t\t\t", "True"}], "\n", 
                          "\t\t\t\t\t\t\t\t\t", "]"}]}]}], "\n", 
                          "\t\t\t\t\t\t\t\t", "]"}]}], "\n", 
                          "\t\t\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t\t\t\t", 
                          "}"}], ",", "\n", "\t\t\t\t\t", RowBox[{"Compile", 
                          "@@", "\n", "\t\t\t\t\t", RowBox[{"ReplaceAll", 
                          "[", "\n", "\t\t\t\t\t\t", RowBox[{RowBox[{"Hold", 
                          "[", RowBox[{"(*", " ", RowBox[{"True", " ", 
                          "Compile", " ", "body", " ", "but", " ", "with", 
                          " ", "Hold", " ", "for", " ", "code", " ", 
                          "injection"}], " ", "*)"}], "\n", "\t\t\t\t\t\t\t", 
                          RowBox[{RowBox[{"{", RowBox[{"{", RowBox[{"gps", 
                          ",", "_Real", ",", "2"}], "}"}], "}"}], ",", "\n", 
                          "\t\t\t\t\t\t\t", RowBox[{"Module", "[", "\n", 
                          "\t\t\t\t\t\t\t\t", RowBox[{RowBox[{"{", "\n", 
                          "\t\t\t\t\t\t\t\t\t", RowBox[{RowBox[{"pts", "=", 
                          "\n", "\t\t\t\t\t\t\t\t\t", RowBox[{RowBox[{
                          "\"Function\"", "[", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                          RowBox[{"asr1r2", ",", "\n", 
                          "\t\t\t\t\t\t\t\t\t\t", RowBox[{"{", "\n", 
                          "\t\t\t\t\t\t\t\t\t\t\t", RowBox[{"\"r1\"", ",", 
                          "\n", "\t\t\t\t\t\t\t\t\t\t\t", "\"r2\"", ",", 
                          "\n", "\t\t\t\t\t\t\t\t\t\t\t", "\"R1\"", ",", 
                          "\n", "\t\t\t\t\t\t\t\t\t\t\t", "\"R2\""}], "\n", 
                          "\t\t\t\t\t\t\t\t\t\t\t", "}"}]}], "\n", 
                          "\t\t\t\t\t\t\t\t\t\t", "]"}], "/@", "gps"}]}], 
                          ",", "\n", "\t\t\t\t\t\t\t\t\t", RowBox[{"ongrid", 
                          "=", RowBox[{"Table", "[", RowBox[{"0", ",", " ", 
                          RowBox[{"{", RowBox[{"i", ",", " ", RowBox[{
                          "Length", "@", "gps"}]}], "}"}]}], "]"}]}], ",", 
                          "\n", "\t\t\t\t\t\t\t\t\t", "intres", ",", "\n", 
                          "\t\t\t\t\t\t\t\t\t", RowBox[{"midpt", "=", RowBox[
                          {"Mean", "/@", "dom"}]}], ",", "\n", 
                          "\t\t\t\t\t\t\t\t\t", "interpvals", ",", "\n", 
                          "\t\t\t\t\t\t\t\t\t", "interpcounter", ",", "\n", 
                          "\t\t\t\t\t\t\t\t\t", "interppts", ",", "\n", 
                          "\t\t\t\t\t\t\t\t\t", RowBox[{"i", "=", "1"}], ",", 
                          "\n", "\t\t\t\t\t\t\t\t\t", RowBox[{"barrier", "=", 
                          "def"}], ",", "\n", "\t\t\t\t\t\t\t\t\t", RowBox[
                          {"minimum", "=", "min"}]}], "\n", 
                          "\t\t\t\t\t\t\t\t\t", "}"}], ",", "\n", 
                          "\t\t\t\t\t\t\t\t", RowBox[{RowBox[{"interppts", 
                          "=", RowBox[{"Table", "[", RowBox[{"midpt", ",", 
                          " ", RowBox[{"{", RowBox[{"i", ",", " ", RowBox[
                          {"Length", "@", "pts"}]}], "}"}]}], "]"}]}], ";", 
                          "\n", "\t\t\t\t\t\t\t\t", RowBox[{"(*", " ", RowBox[
                          {"Find", " ", "points", " ", "in", " ", "domain"}], 
                          " ", "*)"}], "\n", "\t\t\t\t\t\t\t\t", RowBox[
                          {"interpcounter", "=", "0"}], ";", "\n", 
                          "\t\t\t\t\t\t\t\t", RowBox[{"Do", "[", "\n", 
                          "\t\t\t\t\t\t\t\t\t", RowBox[{RowBox[{RowBox[{"If", 
                          "[", RowBox[{"test", ",", "\n", 
                          "\t\t\t\t\t\t\t\t\t\t", RowBox[{RowBox[{RowBox[
                          {"ongrid", "[", RowBox[{"[", "i", "]"}], "]"}], 
                          "=", "1"}], ";", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                          RowBox[{RowBox[{"interppts", "[", RowBox[{"[", 
                          RowBox[{"++", "interpcounter"}], "]"}], "]"}], "=", 
                          RowBox[{"pts", "[", RowBox[{"[", "i", "]"}], 
                          "]"}]}]}]}], RowBox[{"(*", RowBox[{",", "\n", 
                          "\t\t\t\t\t\t\t\t\t\t", RowBox[{"Echo", "@", RowBox[
                          {"{", RowBox[{"pt", ",", " ", "testos", ",", " ", 
                          "domo"}], "}"}]}]}], "*)"}], "\n", 
                          "\t\t\t\t\t\t\t\t\t\t", "]"}], ";", "\n", 
                          "\t\t\t\t\t\t\t\t\t", RowBox[{"i", "++"}]}], ",", 
                          "\n", "\t\t\t\t\t\t\t\t\t", RowBox[{"{", RowBox[
                          {"pt", ",", " ", "pts"}], "}"}]}], "\n", 
                          "\t\t\t\t\t\t\t\t\t", "]"}], ";", "\n", 
                          "\t\t\t\t\t\t\t\t", RowBox[{"(*", " ", RowBox[
                          {"Apply", " ", "InterpolatingFunction", " ", 
                          "only", " ", "once", " ", RowBox[{"(", RowBox[
                          {"one", " ", "MainEval", " ", "call"}], ")"}]}], 
                          " ", "*)"}], "\n", "\t\t\t\t\t\t\t\t", RowBox[
                          {"If", "[", RowBox[{RowBox[{"interpcounter", ">", 
                          "0"}], ",", "\n", "\t\t\t\t\t\t\t\t\t", RowBox[
                          {RowBox[{"intres", "=", RowBox[{"interppts", "[", 
                          RowBox[{"[", RowBox[{";;", "interpcounter"}], 
                          "]"}], "]"}]}], ";", "\n", "\t\t\t\t\t\t\t\t\t", 
                          RowBox[{"interpvals", "=", RowBox[{RowBox[{
                          "getPot", "[", RowBox[{"Transpose", "@", 
                          "intres"}], "]"}], "-", "minimum"}]}], ";", "\n", 
                          "\t\t\t\t\t\t\t\t\t", RowBox[{"(*", " ", RowBox[
                          {"Pick", " ", "points", " ", "that", " ", "are", 
                          " ", "in", " ", "domain"}], " ", "*)"}], "\n", 
                          "\t\t\t\t\t\t\t\t\t", RowBox[{"interpcounter", "=", 
                          "0"}], ";", "\n", "\t\t\t\t\t\t\t\t\t", RowBox[
                          {"Map", "[", "\n", "\t\t\t\t\t\t\t\t\t\t", RowBox[
                          {RowBox[{RowBox[{"If", "[", RowBox[{RowBox[{"#", 
                          "\[Equal]", "1"}], ",", " ", RowBox[{"interpvals", 
                          "[", RowBox[{"[", RowBox[{"++", "interpcounter"}], 
                          "]"}], "]"}], ",", " ", "barrier"}], "]"}], "&"}], 
                          ",", "\n", "\t\t\t\t\t\t\t\t\t\t", "ongrid"}], 
                          "\n", "\t\t\t\t\t\t\t\t\t\t", "]"}]}], ",", "\n", 
                          "\t\t\t\t\t\t\t\t\t", RowBox[{"Table", "[", RowBox[
                          {"barrier", ",", " ", RowBox[{"{", RowBox[{"i", 
                          ",", " ", RowBox[{"Length", "@", "gps"}]}], 
                          "}"}]}], "]"}]}], "\n", "\t\t\t\t\t\t\t\t\t", 
                          "]"}]}]}], "\n", "\t\t\t\t\t\t\t\t", "]"}], ",", 
                          "\n", "\t\t\t\t\t\t\t", RowBox[{"{", RowBox[{"{", 
                          RowBox[{RowBox[{"getPot", "[", "_", "]"}], ",", 
                          " ", "_Real", ",", " ", "1"}], "}"}], "}"}], ",", 
                          "\n", "\t\t\t\t\t\t\t", RowBox[{"RuntimeOptions", 
                          "\[Rule]", RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t", 
                          RowBox[{RowBox[{"\"EvaluateSymbolically\"", 
                          "\[Rule]", "False"}], ",", "\n", 
                          "\t\t\t\t\t\t\t\t", RowBox[{"\"WarningMessages\"", 
                          "\[Rule]", "False"}]}], "\n", "\t\t\t\t\t\t\t\t", 
                          "}"}]}]}], "\n", "\t\t\t\t\t\t\t", "]"}], ",", 
                          "\n", "\t\t\t\t\t\t", RowBox[{"Quiet", "@", 
                          "varBlock"}]}], "\n", "\t\t\t\t\t\t", "]"}]}]}], 
                          "\n", "\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t\t", 
                          "]"}]}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", 
                        "]"}]}], "\n", "\t", "]"}]}], ";"}]}], "CodeInput"], 
           Cell[BoxData[RowBox[{RowBox[{"h5PotCutVec", "[", RowBox[
                  {RowBox[{"{", RowBox[{"HA_", ",", " ", "HS_", ",", " ", 
                       "h2r1_", ",", " ", "h2r2_"}], "}"}], ",", " ", 
                   RowBox[{"min_:", "0."}]}], "]"}], ":=", "\n", "\t", RowBox[
                {"H5VectorizedInterpCut", "[", RowBox[{RowBox[{"{", 
                     RowBox[{"HA", ",", " ", "HS", ",", " ", "h2r1", ",", 
                       " ", "h2r2"}], "}"}], ",", " ", "H5FullInterpPot", 
                   ",", " ", RowBox[{"10.", "^", "9"}], ",", " ", "min"}], 
                 "]"}]}]], "CodeInput"]}, Open]]}, Open]], 
     Cell[CellGroupData[{Cell["\[LeftCeiling]Full Potential\[RightFloor]", 
         "CodeSubsection", Evaluatable -> True, CellChangeTimes -> 
          {{3.7350770738749723*^9, 3.7350770749132833*^9}, 
          {3.735077247217723*^9, 3.735077248311865*^9}, 
          {3.735079373308299*^9, 3.73507937595433*^9}}], 
        Cell[CellGroupData[{Cell["\[LeftCeiling]setPotQA\[RightFloor]", 
            "CodeSubsubsection", Evaluatable -> True], 
           Cell[CellGroupData[{Cell["\[LeftCeiling]Bowtie\[RightFloor]", 
               "CodeSubsubsubsection", Evaluatable -> True], Cell[BoxData[
                RowBox[{RowBox[{"setPotQA", "[", "file_", "]"}], ":=", "\n", 
                  "\t", RowBox[{"If", "[", RowBox[{RowBox[{RowBox[{"Length", 
                          "@", RowBox[{"OwnValues", "@", "H5FullPotQA"}]}], 
                        "\[Equal]", "0"}], ",", "\n", "\t\t", RowBox[
                       {"H5FullPotQA", ":=", "\n", "\t\t\t", RowBox[
                         {"H5FullPotQA", "=", "\n", "\t", "\t\t\t", RowBox[
                          {RowBox[{"Import", "[", "\n", "\t", "\t\t\t\t", 
                          RowBox[{"file", ",", "\n", "\t", "\t", "\t", "\t", 
                          "\t", RowBox[{"{", RowBox[{"\"GaussianLog\"", ",", 
                          " ", "\"ScanQuantityArray\""}], "}"}]}], "\n", 
                          "\t", "\t", "\t", "\t", "\t", "]"}], "[", RowBox[
                          {"[", "2", "]"}], "]"}]}]}]}], "\n", "\t\t", 
                    "]"}]}]], "CodeInput"], Cell[BoxData[RowBox[
                 {RowBox[{"setPotQARaw", "[", "file_", "]"}], ":=", "\n", 
                  "\t", RowBox[{"H5FullPotQARaw", ":=", "\n", "\t\t", 
                    RowBox[{"H5FullPotQARaw", "=", "\n", "\t\t\t", RowBox[
                       {"Import", "[", "file", "]"}]}]}]}]], "CodeInput"]}, 
             Open]], Cell[CellGroupData[
             {Cell["\[LeftCeiling]Parallel\[RightFloor]", 
               "CodeSubsubsubsection", Evaluatable -> True], Cell[BoxData[
                RowBox[{RowBox[{"setPotQAParallel", "[", "file_", "]"}], 
                  ":=", "\n", "\t", RowBox[{"If", "[", RowBox[
                     {RowBox[{RowBox[{"Length", "@", RowBox[{"OwnValues", 
                          "@", "$H5ParallelFullPotQA"}]}], "\[Equal]", "0"}], 
                      ",", "\n", "\t\t", RowBox[{"$H5ParallelFullPotQA", 
                        ":=", "\n", "\t\t\t", RowBox[{"$H5ParallelFullPotQA", 
                          "=", "\n", "\t\t\t\t", RowBox[{RowBox[{"Import", 
                          "[", "\n", "\t", "\t\t\t\t", RowBox[{"file", ",", 
                          "\n", "\t", "\t", "\t", "\t", "\t", RowBox[{"{", 
                          RowBox[{"\"GaussianLog\"", ",", " ", 
                          "\"ScanQuantityArray\""}], "}"}]}], "\n", "\t", 
                          "\t", "\t", "\t", "\t", "]"}], "[", RowBox[{"[", 
                          "2", "]"}], "]"}]}]}]}], "\n", "\t\t", "]"}]}]], 
               "CodeInput"], Cell[BoxData[RowBox[{RowBox[
                   {"setPotQAParallelRaw", "[", "file_", "]"}], ":=", "\n", 
                  "\t", RowBox[{"$H5ParallelFullPotQARaw", ":=", "\n", 
                    "\t\t", RowBox[{"$H5ParallelFullPotQARaw", "=", "\n", 
                      "\t\t\t", RowBox[{"Import", "[", "file", "]"}]}]}]}]], 
               "CodeInput"]}, Closed]], Cell[CellGroupData[
             {Cell["\[LeftCeiling]Old\[RightFloor]", "CodeSubsubsubsection", 
               Evaluatable -> True], Cell[BoxData[RowBox[
                 {RowBox[{"setPotQAOld", "[", "file_", "]"}], ":=", "\n", 
                  "\t", RowBox[{"If", "[", RowBox[{RowBox[{RowBox[{"Length", 
                          "@", RowBox[{"OwnValues", "@", "$H5OldPotQA"}]}], 
                        "\[Equal]", "0"}], ",", "\n", "\t\t", RowBox[
                       {"$H5OldPotQA", ":=", "\n", "\t\t\t", RowBox[
                         {"$H5OldPotQA", "=", "\n", "\t\t\t\t", RowBox[
                          {RowBox[{"Import", "[", "\n", "\t", "\t\t\t\t", 
                          RowBox[{"file", ",", "\n", "\t", "\t", "\t", "\t", 
                          "\t", RowBox[{"{", RowBox[{"\"GaussianLog\"", ",", 
                          " ", "\"ScanQuantityArray\""}], "}"}]}], "\n", 
                          "\t", "\t", "\t", "\t", "\t", "]"}], "[", RowBox[
                          {"[", "2", "]"}], "]"}]}]}]}], "\n", "\t\t", 
                    "]"}]}]], "CodeInput"], Cell[BoxData[RowBox[
                 {RowBox[{"setPotQAOldRaw", "[", "file_", "]"}], ":=", "\n", 
                  "\t", RowBox[{"$H5OldPotQARaw", ":=", "\n", "\t\t", 
                    RowBox[{"$H5OldPotQARaw", "=", "\n", "\t\t\t", RowBox[
                       {"Import", "[", "file", "]"}]}]}]}]], "CodeInput"]}, 
             Open]]}, Open]], Cell[CellGroupData[
          {Cell["\[LeftCeiling]QuantityArray\[RightFloor]", 
            "CodeSubsubsection", Evaluatable -> True, CellChangeTimes -> 
             {{3.734891849679302*^9, 3.734891851718679*^9}, 
             {3.735136347362494*^9, 3.7351363503445177*^9}, 
             {3.738518746072603*^9, 3.738518746942134*^9}}], 
           Cell[CellGroupData[{Cell["\[LeftCeiling]Bowtie\[RightFloor]", 
               "CodeSubsubsubsection", Evaluatable -> True], 
              Cell["?______?", "Text"], Cell[BoxData[RowBox[{"(*", 
                  RowBox[{RowBox[{"setPotQA", "@", "\n", "\t", RowBox[
                       {"H5PackageFile", "[", RowBox[{"\"scans\"", ",", " ", 
                          "\"outer_H2_scan.log\""}], "]"}]}], ";", "\n", 
                    RowBox[{"setPotQA", "@", "\n", "\t", RowBox[
                       {"H5PackageFile", "[", RowBox[{"\"scans\"", ",", " ", 
                          "\"h5_4D_H_center_scan.log\""}], "]"}]}], ";", 
                    "\n", RowBox[{"setPotQARaw", "@", "\n", "\t", RowBox[
                       {"H5PackageFile", "[", RowBox[{"\"inputs\"", ",", " ", 
                          "\"h5_4D_H_center_scan_pot_QA.mx\""}], "]"}]}], 
                    ";"}], "*)"}]], "CodeInput"], Cell[BoxData[
                RowBox[{RowBox[{"setPotQARaw", "@", "\n", "\t", RowBox[
                     {"H5PackageFile", "[", RowBox[{"\"inputs\"", ",", " ", 
                        "\"potential.mx\""}], "]"}]}], ";"}]], "CodeInput"], 
              Cell[BoxData[RowBox[{RowBox[{"getSymmetrizedPotentialSurface", 
                    "[", "]"}], ":=", "\n", "\t", RowBox[{"Module", "[", 
                    "\n", "\t\t", RowBox[{RowBox[{"{", RowBox[{"qa", ",", 
                          " ", "pvs", ",", " ", "lhPVs", ",", " ", "eqPVs"}], 
                        "}"}], ",", "\n", "\t", "\t", RowBox[{RowBox[{"qa", 
                          "=", "H5FullPotQARaw"}], ";", "\n", "\t", "\t", 
                        RowBox[{"pvs", "=", RowBox[{"QuantityMagnitude", "@", 
                          "qa"}]}], ";", "\n", "\t", "\t", RowBox[{"lhPVs", 
                          "=", RowBox[{"Select", "[", RowBox[{"pvs", ",", 
                          " ", RowBox[{RowBox[{RowBox[{"#", "[", RowBox[{"[", 
                          "3", "]"}], "]"}], "<", RowBox[{"#", "[", RowBox[
                          {"[", "4", "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
                        "\n", "\t", "\t", RowBox[{"eqPVs", "=", RowBox[
                          {"Select", "[", RowBox[{"pvs", ",", " ", RowBox[
                          {RowBox[{RowBox[{"#", "[", RowBox[{"[", "3", "]"}], 
                          "]"}], "==", RowBox[{"#", "[", RowBox[{"[", "4", 
                          "]"}], "]"}]}], "&"}]}], "]"}]}], ";", "\n", "\t", 
                        "\t", RowBox[{"pvs", "=", "\n", "\t", "\t", RowBox[
                          {"Join", "[", "\n", "\t", "\t\t", RowBox[{"lhPVs", 
                          ",", "\n", "\t", "\t\t", "eqPVs", ",", "\n", "\t", 
                          "\t\t", RowBox[{"lhPVs", "[", RowBox[{"[", RowBox[
                          {RowBox[{RowBox[{"-", "1"}], ";;", "1", ";;", 
                          RowBox[{"-", "1"}]}], ",", " ", RowBox[{"{", RowBox[
                          {"1", ",", " ", "2", ",", " ", "4", ",", " ", "3", 
                          ",", " ", "5"}], "}"}]}], "]"}], "]"}]}], "\n", 
                          "\t", "\t\t", "]"}]}], ";", "\n", "\t", "\t", 
                        RowBox[{"QuantityArray", "[", RowBox[{"pvs", ",", 
                          RowBox[{RowBox[{"QuantityUnit", "[", "qa", "]"}], 
                          "[", RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], 
                    "\n", "\t", "\t", "]"}]}]], "CodeInput"], 
              Cell[BoxData[RowBox[{"(*", RowBox[{"H5FullPotQA", ":=", 
                    "\[IndentingNewLine]", RowBox[{"H5FullPotQA", "=", 
                      RowBox[{"getSymmetrizedPotentialSurface", "[", 
                        "]"}]}]}], "*)"}]], "CodeInput", CellChangeTimes -> 
                {{3.742315177129431*^9, 3.742315178825304*^9}, 
                 3.742315288930142*^9, 3.742510208490856*^9}, CellLabel -> 
                "In[14]:="], Cell[BoxData[RowBox[{"H5FullPotQA", ":=", 
                  "\[IndentingNewLine]", RowBox[{"H5FullPotQA", "=", 
                    "H5FullPotQARaw"}]}]], "CodeInput", CellChangeTimes -> 
                {{3.742315177129431*^9, 3.742315178825304*^9}, 
                 3.742315288930142*^9, {3.742510208490856*^9, 
                 3.742510218298419*^9}}, CellLabel -> "In[15]:="]}, Open]], 
           Cell[CellGroupData[{Cell["\[LeftCeiling]Parallel\[RightFloor]", 
               "CodeSubsubsubsection", Evaluatable -> True], Cell[BoxData[
                RowBox[{RowBox[{"setPotQAParallelRaw", "@", "\n", "\t", 
                    RowBox[{"H5PackageFile", "[", RowBox[{"\"inputs\"", ",", 
                        " ", "\"potential_parallel.mx\""}], "]"}]}], ";"}]], 
               "CodeInput"]}, Open]], Cell[CellGroupData[
             {Cell["\[LeftCeiling]Old\[RightFloor]", "CodeSubsubsubsection", 
               Evaluatable -> True], Cell[BoxData[RowBox[
                 {RowBox[{"setPotQAOldRaw", "@", "\n", "\t", RowBox[
                     {"H5PackageFile", "[", RowBox[{"\"inputs\"", ",", " ", 
                        "\"potential_old.mx\""}], "]"}]}], ";"}]], 
               "CodeInput"]}, Open]]}, Closed]], 
        Cell[CellGroupData[{Cell["\[LeftCeiling]Interpolation\[RightFloor]", 
            "CodeSubsubsection", Evaluatable -> True, CellChangeTimes -> 
             {{3.734891849679302*^9, 3.734891851718679*^9}, 
             {3.7351363517683153*^9, 3.735136353352437*^9}}], 
           Cell[CellGroupData[{Cell["\[LeftCeiling]Bowtie\[RightFloor]", 
               "CodeSubsubsubsection", Evaluatable -> True], Cell[BoxData[
                RowBox[{RowBox[{"H5FullInterpPot", ":=", "\n", "\t", 
                    RowBox[{"H5FullInterpPot", "=", "\n", "\t\t", RowBox[
                       {"With", "[", RowBox[{RowBox[{"{", RowBox[{"arr", "=", 
                          RowBox[{"QuantityMagnitude", "@", 
                          "H5FullPotQA"}]}], "}"}], ",", "\n", "\t\t\t", 
                          RowBox[{"Interpolation", "[", "\n", "\t\t\t\t", 
                          RowBox[{RowBox[{RowBox[{RowBox[{"Transpose", "[", 
                          RowBox[{"{", RowBox[{RowBox[{"#", "[", RowBox[{"[", 
                          RowBox[{"All", ",", " ", RowBox[{";;", RowBox[{"-", 
                          "2"}]}]}], "]"}], "]"}], ",", " ", RowBox[{"#", 
                          "[", RowBox[{"[", RowBox[{"All", ",", " ", RowBox[
                          {"-", "1"}]}], "]"}], "]"}]}], "}"}], "]"}], "&"}], 
                          "@", RowBox[{"With", "[", RowBox[{RowBox[{"{", 
                          RowBox[{"tr", "=", RowBox[{"Transpose", "[", "arr", 
                          "]"}]}], "}"}], ",", "\n", "\t", "\t\t\t\t", RowBox[
                          {"Transpose", "@", "\n", "\t", "\t\t\t\t\t", RowBox[
                          {"ReplacePart", "[", RowBox[{"tr", ",", "\n", "\t", 
                          "\t\t\t\t\t\t", RowBox[{RowBox[{"-", "1"}], 
                          "\[Rule]", RowBox[{"(", RowBox[{RowBox[{"tr", "[", 
                          RowBox[{"[", RowBox[{"-", "1"}], "]"}], "]"}], "-", 
                          RowBox[{"Min", "[", RowBox[{"tr", "[", RowBox[{"[", 
                          RowBox[{"-", "1"}], "]"}], "]"}], "]"}]}], 
                          ")"}]}]}], "\n", "\t", "\t\t\t\t\t\t", "]"}]}]}], 
                          "\n", "\t", "\t\t\t\t", "]"}]}], ",", "\n", "\t", 
                          "\t\t\t", RowBox[{"{", "\n", "\t", "\t\t\t\t", 
                          RowBox[{"\"ExtrapolationHandler\"", "\[Rule]", 
                          RowBox[{"{", RowBox[{"(*", "Automatic", "*)"}], 
                          RowBox[{RowBox[{"(", RowBox[{RowBox[{"10.", "^", 
                          "9"}], "&"}], ")"}], ",", " ", RowBox[
                          {"\"WarningMessage\"", "\[Rule]", "False"}]}], 
                          "}"}]}], "\n", "\t", "\t\t\t\t", "}"}]}], "\n", 
                          "\t", "\t\t\t", "]"}]}], "\n", "\t", "\t\t", 
                        "]"}]}]}], ";"}]], "CodeInput"]}, Closed]], 
           Cell[CellGroupData[{Cell["\[LeftCeiling]Parallel\[RightFloor]", 
               "CodeSubsubsubsection", Evaluatable -> True], Cell[BoxData[
                RowBox[{RowBox[{"$H5ParallelFullInterpPot", ":=", "\n", "\t", 
                    RowBox[{"$H5ParallelFullInterpPot", "=", "\n", "\t\t", 
                      RowBox[{"With", "[", RowBox[{RowBox[{"{", RowBox[
                          {"arr", "=", RowBox[{"QuantityMagnitude", "@", 
                          "$H5ParallelFullPotQARaw"}]}], "}"}], ",", "\n", 
                          "\t\t\t", RowBox[{"Interpolation", "[", "\n", 
                          "\t\t\t\t", RowBox[{RowBox[{RowBox[{RowBox[
                          {"Transpose", "[", RowBox[{"{", RowBox[{RowBox[
                          {"#", "[", RowBox[{"[", RowBox[{"All", ",", " ", 
                          RowBox[{";;", RowBox[{"-", "2"}]}]}], "]"}], "]"}], 
                          ",", " ", RowBox[{"#", "[", RowBox[{"[", RowBox[
                          {"All", ",", " ", RowBox[{"-", "1"}]}], "]"}], 
                          "]"}]}], "}"}], "]"}], "&"}], "@", RowBox[{"With", 
                          "[", RowBox[{RowBox[{"{", RowBox[{"tr", "=", RowBox[
                          {"Transpose", "[", "arr", "]"}]}], "}"}], ",", 
                          "\n", "\t", "\t\t\t\t", RowBox[{"Transpose", "@", 
                          "\n", "\t", "\t\t\t\t\t", RowBox[{"ReplacePart", 
                          "[", RowBox[{"tr", ",", "\n", "\t", "\t\t\t\t\t\t", 
                          RowBox[{RowBox[{"-", "1"}], "\[Rule]", RowBox[{"(", 
                          RowBox[{RowBox[{"tr", "[", RowBox[{"[", RowBox[
                          {"-", "1"}], "]"}], "]"}], "-", RowBox[{"Min", "[", 
                          RowBox[{"tr", "[", RowBox[{"[", RowBox[{"-", "1"}], 
                          "]"}], "]"}], "]"}]}], ")"}]}]}], "\n", "\t", 
                          "\t\t\t\t\t\t", "]"}]}]}], "\n", "\t", "\t\t\t\t", 
                          "]"}]}], ",", "\n", "\t", "\t\t\t", RowBox[{"{", 
                          "\n", "\t", "\t\t\t\t", RowBox[
                          {"\"ExtrapolationHandler\"", "\[Rule]", RowBox[
                          {"{", RowBox[{RowBox[{"(", RowBox[{RowBox[{"10.", 
                          "^", "9"}], "&"}], ")"}], ",", " ", RowBox[
                          {"\"WarningMessage\"", "\[Rule]", "False"}]}], 
                          "}"}]}], "\n", "\t", "\t\t\t\t", "}"}]}], "\n", 
                          "\t", "\t\t\t", "]"}]}], "\n", "\t", "\t\t", 
                        "]"}]}]}], ";"}]], "CodeInput"]}, Closed]], 
           Cell[CellGroupData[{Cell["\[LeftCeiling]Old\[RightFloor]", 
               "CodeSubsubsubsection", Evaluatable -> True], Cell[BoxData[
                RowBox[{RowBox[{"$H5OldInterpPot", ":=", "\n", "\t", 
                    RowBox[{"$H5OldInterpPot", "=", "\n", "\t\t", RowBox[
                       {"With", "[", RowBox[{RowBox[{"{", RowBox[{"arr", "=", 
                          RowBox[{"QuantityMagnitude", "@", 
                          "$H5OldPotQARaw"}]}], "}"}], ",", "\n", "\t\t\t", 
                          RowBox[{"Interpolation", "[", "\n", "\t\t\t\t", 
                          RowBox[{RowBox[{RowBox[{RowBox[{"Transpose", "[", 
                          RowBox[{"{", RowBox[{RowBox[{"#", "[", RowBox[{"[", 
                          RowBox[{"All", ",", " ", RowBox[{";;", RowBox[{"-", 
                          "2"}]}]}], "]"}], "]"}], ",", " ", RowBox[{"#", 
                          "[", RowBox[{"[", RowBox[{"All", ",", " ", RowBox[
                          {"-", "1"}]}], "]"}], "]"}]}], "}"}], "]"}], "&"}], 
                          "@", RowBox[{"With", "[", RowBox[{RowBox[{"{", 
                          RowBox[{"tr", "=", RowBox[{"Transpose", "[", "arr", 
                          "]"}]}], "}"}], ",", "\n", "\t", "\t\t\t\t", RowBox[
                          {"Transpose", "@", "\n", "\t", "\t\t\t\t\t", RowBox[
                          {"ReplacePart", "[", RowBox[{"tr", ",", "\n", "\t", 
                          "\t\t\t\t\t\t", RowBox[{RowBox[{"-", "1"}], 
                          "\[Rule]", RowBox[{"(", RowBox[{RowBox[{"tr", "[", 
                          RowBox[{"[", RowBox[{"-", "1"}], "]"}], "]"}], "-", 
                          RowBox[{"Min", "[", RowBox[{"tr", "[", RowBox[{"[", 
                          RowBox[{"-", "1"}], "]"}], "]"}], "]"}]}], 
                          ")"}]}]}], "\n", "\t", "\t\t\t\t\t\t", "]"}]}]}], 
                          "\n", "\t", "\t\t\t\t", "]"}]}], ",", "\n", "\t", 
                          "\t\t\t", RowBox[{"{", "\n", "\t", "\t\t\t\t", 
                          RowBox[{"\"ExtrapolationHandler\"", "\[Rule]", 
                          RowBox[{"{", RowBox[{RowBox[{"(", RowBox[{RowBox[
                          {"10.", "^", "9"}], "&"}], ")"}], ",", " ", RowBox[
                          {"\"WarningMessage\"", "\[Rule]", "False"}]}], 
                          "}"}]}], "\n", "\t", "\t\t\t\t", "}"}]}], "\n", 
                          "\t", "\t\t\t", "]"}]}], "\n", "\t", "\t\t", 
                        "]"}]}]}], ";"}]], "CodeInput"]}, Closed]]}, Open]], 
        Cell[CellGroupData[{Cell["\[LeftCeiling]CompiledForm\[RightFloor]", 
            "CodeSubsubsection", Evaluatable -> True, CellChangeTimes -> 
             {{3.734891849679302*^9, 3.734891851718679*^9}, 
             {3.7351363517683153*^9, 3.7351363608404713*^9}}], 
           Cell[CellGroupData[{Cell["\[LeftCeiling]Pointwise\[RightFloor]", 
               "CodeSubsubsubsection", Evaluatable -> True, 
               CellChangeTimes -> {{3.738605753890942*^9, 
                3.738605755217082*^9}}], Cell[CellGroupData[
                {Cell["\[LeftCeiling]Bowtie\[RightFloor]", 
                  "CodeSubsubsubsubsection", Evaluatable -> True], 
                 Cell[BoxData[RowBox[{RowBox[{"H5FullPot", ":=", "\n", "\t", 
                       RowBox[{"H5FullPot", "=", "\n", "\t\t", RowBox[
                          {"With", "[", "\n", "\t\t\t", RowBox[{RowBox[
                          {"{", "\n", "\t\t\t\t", RowBox[{RowBox[
                          {"potInterp", "=", "H5FullInterpPot"}], ",", "\n", 
                          "\t", "\t", "\t\t", RowBox[{"dom", "=", 
                          "$H5PotentialRegion"}]}], "\n", "\t", "\t\t\t", 
                          "}"}], ",", "\n", "\t\t\t", RowBox[
                          {"H5PointwiseInterpCut", "[", "\n", "\t\t\t\t", 
                          RowBox[{RowBox[{"{", RowBox[{"Automatic", ",", " ", 
                          "Automatic", ",", " ", "Automatic", ",", " ", 
                          "Automatic"}], "}"}], ",", "\n", "\t\t\t\t", 
                          "potInterp", ",", "\n", "\t\t\t\t", "dom", ",", 
                          "\n", "\t", "\t\t\t", RowBox[{"10.", "^", "9"}]}], 
                          "\n", "\t\t\t\t", "]"}]}], "\n", "\t\t\t", 
                          "]"}]}]}], ";"}]], "CodeInput"]}, Closed]], 
              Cell[CellGroupData[{Cell["\[LeftCeiling]Parallel\[RightFloor]", 
                  "CodeSubsubsubsubsection", Evaluatable -> True], 
                 Cell[BoxData[RowBox[{RowBox[{"$H5ParallelFullPot", ":=", 
                       "\n", "\t", RowBox[{"$H5ParallelFullPot", "=", "\n", 
                         "\t\t", RowBox[{"With", "[", "\n", "\t\t\t", RowBox[
                          {RowBox[{"{", "\n", "\t\t\t\t", RowBox[{RowBox[
                          {"potInterp", "=", "$H5ParallelFullInterpPot"}], 
                          ",", "\n", "\t\t\t\t", RowBox[{"dom", "=", 
                          "$H5PotentialRegion"}]}], "\n", "\t", "\t\t\t", 
                          "}"}], ",", "\n", "\t\t\t", RowBox[
                          {"H5PointwiseInterpCut", "[", "\n", "\t\t\t\t", 
                          RowBox[{RowBox[{"{", RowBox[{"Automatic", ",", " ", 
                          "Automatic", ",", " ", "Automatic", ",", " ", 
                          "Automatic"}], "}"}], ",", "\n", "\t\t\t\t", 
                          "potInterp", ",", "\n", "\t\t\t\t", "dom", ",", 
                          "\n", "\t", "\t\t\t", RowBox[{"10.", "^", "9"}]}], 
                          "\n", "\t\t\t\t", "]"}]}], "\n", "\t\t\t", 
                          "]"}]}]}], ";"}]], "CodeInput"]}, Closed]], 
              Cell[CellGroupData[{Cell["\[LeftCeiling]Old\[RightFloor]", 
                  "CodeSubsubsubsubsection", Evaluatable -> True], 
                 Cell[BoxData[RowBox[{RowBox[{"$H5OldPot", ":=", "\n", "\t", 
                       RowBox[{"$H5OldPot", "=", "\n", "\t\t", RowBox[
                          {"With", "[", "\n", "\t\t\t", RowBox[{RowBox[
                          {"{", "\n", "\t\t\t\t", RowBox[{RowBox[
                          {"potInterp", "=", "$H5OldInterpPot"}], ",", "\n", 
                          "\t\t\t\t", RowBox[{"dom", "=", 
                          "$H5PotentialRegion"}]}], "\n", "\t", "\t\t\t", 
                          "}"}], ",", "\n", "\t\t\t", RowBox[
                          {"H5PointwiseInterpCut", "[", "\n", "\t\t\t\t", 
                          RowBox[{RowBox[{"{", RowBox[{"Automatic", ",", " ", 
                          "Automatic", ",", " ", "Automatic", ",", " ", 
                          "Automatic"}], "}"}], ",", "\n", "\t\t\t\t", 
                          "potInterp", ",", "\n", "\t\t\t\t", "dom", ",", 
                          "\n", "\t", "\t\t\t", RowBox[{"10.", "^", "9"}]}], 
                          "\n", "\t\t\t\t", "]"}]}], "\n", "\t\t\t", 
                          "]"}]}]}], ";"}]], "CodeInput"]}, Closed]]}, 
             Open]], Cell[CellGroupData[
             {Cell["\[LeftCeiling]Vectorized\[RightFloor]", 
               "CodeSubsubsubsection", Evaluatable -> True, 
               CellChangeTimes -> {{3.738605761610714*^9, 
                3.738605763448882*^9}}], Cell[CellGroupData[
                {Cell["\[LeftCeiling]Bowtie\[RightFloor]", 
                  "CodeSubsubsubsubsection", Evaluatable -> True], 
                 Cell[BoxData[RowBox[{"H5FullVecPot", ":=", "\n", "\t", 
                     RowBox[{"H5FullVecPot", "=", "\n", "\t\t", RowBox[
                        {"With", "[", "\n", "\t\t\t", RowBox[{RowBox[{"{", 
                          "\n", "\t\t\t\t", RowBox[{RowBox[{"potInterp", "=", 
                          "H5FullInterpPot"}], ",", "\n", "\t", "\t", "\t\t", 
                          RowBox[{"dom", "=", "$H5PotentialRegion"}]}], "\n", 
                          "\t", "\t\t\t", "}"}], ",", "\n", "\t\t\t", RowBox[
                          {"H5VectorizedInterpCut", "[", "\n", "\t\t\t\t", 
                          RowBox[{RowBox[{"{", RowBox[{"Automatic", ",", " ", 
                          "Automatic", ",", " ", "Automatic", ",", " ", 
                          "Automatic"}], "}"}], ",", "\n", "\t\t\t\t", 
                          "potInterp", ",", "\n", "\t\t\t\t", "dom", ",", 
                          "\n", "\t", "\t\t\t", RowBox[{"10.", "^", "9"}]}], 
                          "\n", "\t\t\t\t", "]"}]}], "\n", "\t\t\t", 
                         "]"}]}]}]], "CodeInput"]}, Closed]], 
              Cell[CellGroupData[{Cell["\[LeftCeiling]Parallel\[RightFloor]", 
                  "CodeSubsubsubsubsection", Evaluatable -> True], 
                 Cell[BoxData[RowBox[{"$H5ParallelFullVecPot", ":=", "\n", 
                     "\t", RowBox[{"$H5ParallelFullVecPot", "=", "\n", 
                       "\t\t", RowBox[{"With", "[", "\n", "\t\t\t", RowBox[
                          {RowBox[{"{", "\n", "\t\t\t\t", RowBox[{RowBox[
                          {"potInterp", "=", "$H5ParallelFullInterpPot"}], 
                          ",", "\n", "\t\t\t\t", RowBox[{"dom", "=", 
                          "$H5PotentialRegion"}]}], "\n", "\t", "\t\t\t", 
                          "}"}], ",", "\n", "\t\t\t", RowBox[
                          {"H5VectorizedInterpCut", "[", "\n", "\t\t\t\t", 
                          RowBox[{RowBox[{"{", RowBox[{"Automatic", ",", " ", 
                          "Automatic", ",", " ", "Automatic", ",", " ", 
                          "Automatic"}], "}"}], ",", "\n", "\t\t\t\t", 
                          "potInterp", ",", "\n", "\t\t\t\t", "dom", ",", 
                          "\n", "\t", "\t\t\t", RowBox[{"10.", "^", "9"}]}], 
                          "\n", "\t\t\t\t", "]"}]}], "\n", "\t\t\t", 
                         "]"}]}]}]], "CodeInput"]}, Closed]], 
              Cell[CellGroupData[{Cell["\[LeftCeiling]Old\[RightFloor]", 
                  "CodeSubsubsubsubsection", Evaluatable -> True], 
                 Cell[BoxData[RowBox[{RowBox[{"$H5OldVecPot", ":=", "\n", 
                       "\t", RowBox[{"$H5OldVecPot", "=", "\n", "\t\t", 
                         RowBox[{"With", "[", "\n", "\t\t\t", RowBox[
                          {RowBox[{"{", "\n", "\t\t\t\t", RowBox[{RowBox[
                          {"potInterp", "=", "$H5OldInterpPot"}], ",", "\n", 
                          "\t\t\t\t", RowBox[{"dom", "=", 
                          "$H5PotentialRegion"}]}], "\n", "\t", "\t\t\t", 
                          "}"}], ",", "\n", "\t\t\t", RowBox[
                          {"H5VectorizedInterpCut", "[", "\n", "\t\t\t\t", 
                          RowBox[{RowBox[{"{", RowBox[{"Automatic", ",", " ", 
                          "Automatic", ",", " ", "Automatic", ",", " ", 
                          "Automatic"}], "}"}], ",", "\n", "\t\t\t\t", 
                          "potInterp", ",", "\n", "\t\t\t\t", "dom", ",", 
                          "\n", "\t", "\t\t\t", RowBox[{"10.", "^", "9"}]}], 
                          "\n", "\t\t\t\t", "]"}]}], "\n", "\t\t\t", 
                          "]"}]}]}], ";"}]], "CodeInput"]}, Closed]]}, 
             Open]]}, Open]]}, Open]], 
     Cell[CellGroupData[
       {Cell["\[LeftCeiling]Optimized H5 Structure\[RightFloor]", 
         "CodeSubsection", Evaluatable -> True, CellChangeTimes -> 
          {{3.735089385116363*^9, 3.735089391170229*^9}}], 
        Cell[CellGroupData[{Cell["\[LeftCeiling]H5OptDistances\[RightFloor]", 
            "CodeSubsubsection", Evaluatable -> True], 
           Cell[BoxData[RowBox[{"H5OptDistances", ":=", "\n", "\t", RowBox[
                {"H5OptDistances", "=", "\n", "\t\t", RowBox[
                  {RowBox[{RowBox[{"Import", "[", "\n", "\t\t\t", RowBox[
                        {RowBox[{"H5PackageFile", "[", RowBox[{"\"scans\"", 
                          ",", " ", "\"h5_opt_structure.gjf\""}], "]"}], ",", 
                         "\n", "\t\t\t", "\"GaussianJob\""}], "\n", "\t", 
                       "\t\t", "]"}], "[", RowBox[{"\"System\"", ",", " ", 
                       "\"Variables\""}], "]"}], "//", RowBox[{"Map", "[", 
                     RowBox[{"Apply", "@", "Rule"}], "]"}]}]}]}]], 
            "CodeInput"]}, Closed]]}, Open]], 
     Cell[CellGroupData[{Cell["\[LeftCeiling]Dipole Surface\[RightFloor]", 
         "CodeSubsection", Evaluatable -> True, CellChangeTimes -> 
          {{3.7404036821292458*^9, 3.74040368535194*^9}, 
           {3.7421689542320023*^9, 3.7421689699252377*^9}, 
           3.742269370818679*^9}], Cell[CellGroupData[
          {Cell["\[LeftCeiling]Dipole QA\[RightFloor]", "CodeSubsubsection", 
            Evaluatable -> True, CellChangeTimes -> {{3.7404196993331413*^9, 
             3.7404197010421057*^9}}], Cell[CellGroupData[
             {Cell["\[LeftCeiling]Historical Interest\[RightFloor]", 
               "CodeSubsubsubsection", Evaluatable -> True], Cell[BoxData[
                RowBox[{"(*", RowBox[{RowBox[
                     {"$H5DipoleSurfaceRawQuantityArray", ":=", "\n", "\t", 
                      RowBox[{"$H5DipoleSurfaceRawQuantityArray", "=", "\n", 
                        "\t\t", RowBox[{"Import", "[", "\n", "\t\t\t", 
                          RowBox[{RowBox[{"H5PackageFile", "[", RowBox[
                          {"\"scans\"", ",", " ", "\"outer_H2_scan.log\""}], 
                          "]"}], ",", "\n", "\t\t\t", RowBox[{"{", 
                          "\"GaussianLog\"", "}"}], ",", "\n", "\t\t\t", 
                          RowBox[{"\"ImportedElements\"", "\[Rule]", 
                          "\"ScanDipoleSurface\""}]}], "\n", "\t\t\t", 
                          "]"}]}]}], ";"}], "*)"}]], "CodeInput"], 
              Cell[BoxData[RowBox[{"(*", RowBox[{RowBox[
                     {"$H5DipoleSurfaceRawQuantityArray", ":=", "\n", "\t", 
                      RowBox[{"$H5DipoleSurfaceRawQuantityArray", "=", "\n", 
                        "\t\t", RowBox[{"Import", "[", "\n", "\t\t\t", 
                          RowBox[{RowBox[{"H5PackageFile", "[", RowBox[
                          {"\"scans\"", ",", " ", 
                          "\"h5_4D_H_center_scan.log\""}], "]"}], ",", "\n", 
                          "\t\t\t", RowBox[{"{", "\"GaussianLog\"", "}"}], 
                          ",", "\n", "\t\t\t", RowBox[
                          {"\"ImportedElements\"", "\[Rule]", 
                          "\"ScanDipoleSurface\""}]}], "\n", "\t\t\t", 
                          "]"}]}]}], ";"}], "*)"}]], "CodeInput"], 
              Cell[BoxData[RowBox[{"(*", RowBox[{RowBox[
                     {"$H5DipoleSurfaceRawQuantityArray", ":=", 
                      "\[IndentingNewLine]", RowBox[
                       {"$H5DipoleSurfaceRawQuantityArray", "=", RowBox[
                         {"Import", "[", "\"~/Documents/UW/Research/H5+/input\
s/h5_dip_QA.mx\"", "]"}]}]}], ";"}], "*)"}]], "CodeInput", CellChangeTimes -> 
                {{3.7422644714786673*^9, 3.742264471749601*^9}, 
                {3.742492610795685*^9, 3.742492611132737*^9}}, CellLabel -> 
                "In[22]:="], Cell[BoxData[RowBox[{"(*", RowBox[
                   {RowBox[{"$H5DipoleSurfaceRawQuantityArray", ":=", "\n", 
                      "\t", RowBox[{"$H5DipoleSurfaceRawQuantityArray", "=", 
                        "\n", "\t\t", RowBox[{"Import", "@", RowBox[
                          {"H5PackageFile", "[", RowBox[{"\"inputs\"", ",", 
                          " ", "\"h5_dip_QA_new.mx\""}], "]"}]}]}]}], ";"}], 
                  "*)"}]], "CodeInput"], Cell[BoxData[RowBox[{"(*", 
                  RowBox[{RowBox[{"getSymmetrizedDipoleMoments", "[", "]"}], 
                    ":=", "\[IndentingNewLine]", RowBox[{"Module", "[", 
                      "\[IndentingNewLine]", RowBox[{RowBox[{"{", RowBox[
                          {"qa", ",", " ", "dvs", ",", " ", "lhDVs", ",", 
                          " ", "eqDVs"}], "}"}], ",", "\[IndentingNewLine]", 
                        RowBox[{RowBox[{"qa", "=", RowBox[
                          {"$H5DipoleSurfaceRawQuantityArray", "[", RowBox[
                          {"[", "2", "]"}], "]"}]}], ";", 
                          "\[IndentingNewLine]", RowBox[{"dvs", "=", RowBox[
                          {"QuantityMagnitude", "@", "qa"}]}], ";", 
                          "\[IndentingNewLine]", RowBox[{"lhDVs", "=", 
                          RowBox[{"Select", "[", RowBox[{"dvs", ",", " ", 
                          RowBox[{RowBox[{RowBox[{"#", "[", RowBox[{"[", "3", 
                          "]"}], "]"}], "<", RowBox[{"#", "[", RowBox[{"[", 
                          "4", "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
                          "\[IndentingNewLine]", RowBox[{"eqDVs", "=", 
                          RowBox[{"Select", "[", RowBox[{"dvs", ",", " ", 
                          RowBox[{RowBox[{RowBox[{"#", "[", RowBox[{"[", "3", 
                          "]"}], "]"}], "==", RowBox[{"#", "[", RowBox[{"[", 
                          "4", "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
                          "\[IndentingNewLine]", RowBox[{"dvs", "=", 
                          "\[IndentingNewLine]", RowBox[{"Join", "[", 
                          "\[IndentingNewLine]", RowBox[{"lhDVs", ",", 
                          "\[IndentingNewLine]", "eqDVs", ",", 
                          "\[IndentingNewLine]", RowBox[{RowBox[
                          {"ConstantArray", "[", "\[IndentingNewLine]", 
                          RowBox[{RowBox[{"{", RowBox[{"1", ",", " ", "1", 
                          ",", " ", "1", ",", " ", "1", ",", " ", RowBox[
                          {"-", "1"}], ",", " ", RowBox[{"-", "1"}], ",", 
                          " ", RowBox[{"-", "1"}]}], "}"}], ",", 
                          "\[IndentingNewLine]", RowBox[{"Length", "@", 
                          "lhDVs"}]}], "\[IndentingNewLine]", "]"}], "*", 
                          RowBox[{"lhDVs", "[", RowBox[{"[", RowBox[{RowBox[
                          {RowBox[{"-", "1"}], ";;", "1", ";;", RowBox[{"-", 
                          "1"}]}], ",", " ", RowBox[{"{", RowBox[{"1", ",", 
                          " ", "2", ",", " ", "4", ",", " ", "3", ",", " ", 
                          "5", ",", " ", "6", ",", " ", "7"}], "}"}]}], 
                          "]"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
                          ";", "\[IndentingNewLine]", RowBox[
                          {"QuantityArray", "[", RowBox[{"dvs", ",", RowBox[
                          {RowBox[{"QuantityUnit", "[", "qa", "]"}], "[", 
                          RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], 
                      "\[IndentingNewLine]", "]"}]}], "*)"}]], "CodeInput"], 
              Cell[BoxData[RowBox[{RowBox[{"(*", RowBox[{RowBox[
                       {"$H5DipoleSurfaceQuantityArray", ":=", 
                        "\[IndentingNewLine]", RowBox[
                         {"$H5DipoleSurfaceQuantityArray", "=", 
                          "$H5DipoleSurfaceRawQuantityArray"}]}], ";"}], 
                    "*)"}], "\n", " ", RowBox[{"(*", RowBox[
                     {"getSymmetrizedDipoleMoments", "[", "]"}], "*)"}]}]], 
               "CodeInput"], Cell[BoxData[RowBox[{"(*", RowBox[
                   {RowBox[{RowBox[{"getRecenteredDipoleMoments", "[", "]"}], 
                      ":=", "\[IndentingNewLine]", RowBox[{"Module", "[", 
                        "\[IndentingNewLine]", RowBox[{RowBox[{"{", RowBox[
                          {"weirdRCoeff", ",", " ", "dipVecs", ",", " ", 
                          "qa"}], "}"}], ",", "\[IndentingNewLine]", RowBox[
                          {RowBox[{"qa", "=", 
                          "$H5DipoleSurfaceRawQuantityArray"}], ";", 
                          "\[IndentingNewLine]", RowBox[{"weirdRCoeff", "=", 
                          "\[IndentingNewLine]", RowBox[{"QuantityMagnitude", 
                          "[", "\[IndentingNewLine]", RowBox[{RowBox[
                          {"UnitConvert", "[", RowBox[{RowBox[{
                          "\"ElementaryCharge\"", "*", "\"BohrRadius\""}], 
                          ",", " ", "\"Debyes\""}], "]"}], "/", RowBox[
                          {"UnitConvert", "[", RowBox[{"\"BohrRadius\"", ",", 
                          " ", "\"Angstroms\""}], "]"}]}], 
                          "\[IndentingNewLine]", "]"}]}], ";", 
                          "\[IndentingNewLine]", RowBox[{"dipVecs", "=", 
                          "\[IndentingNewLine]", RowBox[{RowBox[
                          {"QuantityMagnitude", "@", RowBox[{"qa", "[", 
                          RowBox[{"[", RowBox[{"2", ",", " ", "All", ",", 
                          " ", RowBox[{"{", RowBox[{"5", ",", " ", "6", ",", 
                          " ", "7"}], "}"}]}], "]"}], "]"}]}], "-", 
                          "\[IndentingNewLine]", RowBox[{"Thread", "[", 
                          "\[IndentingNewLine]", RowBox[{"{", 
                          "\[IndentingNewLine]", RowBox[{RowBox[
                          {"QuantityMagnitude", "[", RowBox[{RowBox[{"(", 
                          RowBox[{RowBox[{"qa", "[", RowBox[{"[", RowBox[
                          {"2", ",", " ", "All", ",", " ", "4"}], "]"}], 
                          "]"}], "-", RowBox[{"qa", "[", RowBox[{"[", RowBox[
                          {"2", ",", " ", "All", ",", " ", "3"}], "]"}], 
                          "]"}]}], ")"}], "*", RowBox[{"weirdRCoeff", "/", 
                          "2"}]}], "]"}], ",", "\[IndentingNewLine]", "0.", 
                          ",", "\[IndentingNewLine]", "0."}], 
                          "\[IndentingNewLine]", "}"}], 
                          "\[IndentingNewLine]", "]"}]}]}], ";", 
                          "\[IndentingNewLine]", RowBox[{"QuantityArray", 
                          "[", "\[IndentingNewLine]", RowBox[{RowBox[{"Join", 
                          "[", "\[IndentingNewLine]", RowBox[{RowBox[
                          {"QuantityMagnitude", "@", RowBox[{"qa", "[", 
                          RowBox[{"[", RowBox[{"2", ",", " ", "All", ",", 
                          " ", RowBox[{"{", RowBox[{"1", ",", " ", "2", ",", 
                          " ", "3", ",", " ", "4"}], "}"}]}], "]"}], "]"}]}], 
                          ",", "\[IndentingNewLine]", "dipVecs", ",", 
                          "\[IndentingNewLine]", "2"}], 
                          "\[IndentingNewLine]", "]"}], ",", 
                          "\[IndentingNewLine]", RowBox[{"QuantityUnit", "@", 
                          RowBox[{"qa", "[", RowBox[{"[", RowBox[{"2", ",", 
                          " ", "1"}], "]"}], "]"}]}]}], 
                          "\[IndentingNewLine]", "]"}]}]}], 
                        "\[IndentingNewLine]", "]"}]}], ";", "\n", 
                    RowBox[{"$H5DipoleSurfaceQuantityArray", ":=", 
                      "\[IndentingNewLine]", RowBox[
                       {"$H5DipoleSurfaceQuantityArray", "=", RowBox[
                         {"getRecenteredDipoleMoments", "[", "]"}]}]}]}], 
                  "*)"}]], "CodeInput", CellChangeTimes -> 
                {{3.7411468163523197*^9, 3.741146821127997*^9}, 
                 {3.7415620794126043*^9, 3.741562103663846*^9}, 
                 {3.742168578405396*^9, 3.742168581167639*^9}, 
                 3.742273813319112*^9, {3.742273849422381*^9, 
                 3.742273904127741*^9}, 3.74227395934168*^9, 
                 {3.742273999950605*^9, 3.742274011156122*^9}, 
                 {3.742274217255591*^9, 3.7422742383978777*^9}, 
                 3.742274346911421*^9, {3.742274659775285*^9, 
                 3.742274705421245*^9}, {3.742276248135805*^9, 
                 3.7422762548032703*^9}, {3.742276475917457*^9, 
                 3.742276477001157*^9}, {3.742308801251813*^9, 
                 3.742308801592855*^9}, {3.742309373173481*^9, 
                 3.742309374313859*^9}}, CellLabel -> "In[26]:="], 
              Cell[BoxData[RowBox[{"(*", RowBox[
                   {"$H5DipoleSurfaceQuantityArray", ":=", 
                    "\[IndentingNewLine]", RowBox[
                     {"$H5DipoleSurfaceRawQuantityArray", "[", RowBox[
                       {"[", "2", "]"}], "]"}]}], "*)"}]], "CodeInput", 
               CellChangeTimes -> {{3.742275970003543*^9, 
                3.742275975442848*^9}}, CellLabel -> "In[27]:="]}, Closed]], 
           Cell[CellGroupData[{Cell["\[LeftCeiling]New Stuff\[RightFloor]", 
               "CodeSubsubsubsection", Evaluatable -> True], 
              Cell[CellGroupData[{Cell["\[LeftCeiling]Bowtie\[RightFloor]", 
                  "CodeSubsubsubsubsection", Evaluatable -> True], 
                 Cell[BoxData[RowBox[{RowBox[
                      {"$H5DipoleSurfaceQuantityArray", ":=", "\n", "\t", 
                       RowBox[{"$H5DipoleSurfaceQuantityArray", "=", "\n", 
                         "\t\t", RowBox[{"Import", "@", RowBox[
                          {"H5PackageFile", "[", RowBox[{"\"inputs\"", ",", 
                          " ", "\"dipoles.mx\""}], "]"}]}]}]}], ";"}]], 
                  "CodeInput"]}, Open]], Cell[CellGroupData[
                {Cell["\[LeftCeiling]Parallel\[RightFloor]", 
                  "CodeSubsubsubsubsection", Evaluatable -> True], 
                 Cell[BoxData[RowBox[{RowBox[
                      {"$H5ParallelDipoleSurfaceQuantityArray", ":=", "\n", 
                       "\t", RowBox[{"$H5ParallelDipoleSurfaceQuantityArray", 
                         "=", "\n", "\t\t", RowBox[{"Import", "@", RowBox[
                          {"H5PackageFile", "[", RowBox[{"\"inputs\"", ",", 
                          " ", "\"dipoles_parallel.mx\""}], "]"}]}]}]}], 
                     ";"}]], "CodeInput"]}, Open]]}, Open]]}, Closed]], 
        Cell[CellGroupData[{Cell["\[LeftCeiling]Interpolation\[RightFloor]", 
            "CodeSubsubsection", Evaluatable -> True, CellChangeTimes -> 
             {{3.740419770739582*^9, 3.740419772643427*^9}}], 
           Cell[CellGroupData[{Cell["\[LeftCeiling]Bowtie\[RightFloor]", 
               "CodeSubsubsubsection", Evaluatable -> True], Cell[BoxData[
                RowBox[{"$H5DipoleSurfaceInterps", ":=", "\n", "\t", 
                  RowBox[{"$H5DipoleSurfaceInterps", "=", "\n", "\t\t", 
                    RowBox[{RowBox[{RowBox[{"Interpolation", "[", "\n", 
                          "\t\t\t", RowBox[{RowBox[{"QuantityMagnitude", "@", 
                          "\n", "\t\t\t\t", RowBox[{
                          "$H5DipoleSurfaceQuantityArray", "[", RowBox[{"[", 
                          RowBox[{"All", ",", " ", RowBox[{"{", RowBox[{"1", 
                          ",", " ", "2", ",", " ", "3", ",", " ", "4", ",", 
                          " ", "#"}], "}"}]}], "]"}], "]"}]}], ",", "\n", 
                          "\t\t\t\t", RowBox[{"{", "\n", "\t\t\t\t\t", 
                          RowBox[{"\"ExtrapolationHandler\"", "\[Rule]", 
                          RowBox[{"{", RowBox[{RowBox[{"0.", "&"}], ",", " ", 
                          RowBox[{"\"WarningMessage\"", "\[Rule]", 
                          "False"}]}], "}"}]}], "\n", "\t\t\t\t\t", "}"}]}], 
                          "\n", "\t\t\t\t", "]"}], "&"}], "/@", RowBox[
                       {"Range", "[", RowBox[{"5", ",", " ", "7"}], 
                        "]"}]}]}]}]], "CodeInput"], Cell[CellGroupData[
                {Cell["\[LeftCeiling]Compilation\[RightFloor]", 
                  "CodeSubsubsubsubsection", Evaluatable -> True, 
                  CellChangeTimes -> {{3.741540044668268*^9, 
                   3.741540048340281*^9}}], Cell[BoxData[RowBox[
                    {"$H5DipoleSurfaceVec", ":=", "\n", "\t", RowBox[
                      {"$H5DipoleSurfaceVec", "=", "\n", "\t\t", RowBox[
                        {RowBox[{RowBox[{"H5VectorizedInterpCut", "[", "\n", 
                          "\t\t\t", RowBox[{RowBox[{"{", RowBox[{"Automatic", 
                          ",", " ", "Automatic", ",", " ", "Automatic", ",", 
                          " ", "Automatic"}], "}"}], ",", " ", "\n", 
                          "\t\t\t", "#", ",", " ", "\n", "\t\t\t", 
                          "Automatic", ",", "\n", "\t\t\t", "0"}], "\n", 
                          "\t\t\t", "]"}], "&"}], "/@", "\n", "\t\t\t", 
                         "$H5DipoleSurfaceInterps"}]}]}]], "CodeInput"]}, 
                Open]]}, Open]], Cell[CellGroupData[
             {Cell["\[LeftCeiling]Parallel\[RightFloor]", 
               "CodeSubsubsubsection", Evaluatable -> True], Cell[BoxData[
                RowBox[{"$H5ParallelDipoleSurfaceInterps", ":=", "\n", "\t", 
                  RowBox[{"$H5ParallelDipoleSurfaceInterps", "=", "\n", 
                    "\t\t", RowBox[{RowBox[{RowBox[{"Interpolation", "[", 
                          "\n", "\t\t\t", RowBox[{RowBox[
                          {"QuantityMagnitude", "@", "\n", "\t\t\t\t", 
                          RowBox[{"$H5ParallelDipoleSurfaceQuantityArray", 
                          "[", RowBox[{"[", RowBox[{"All", ",", " ", RowBox[
                          {"{", RowBox[{"1", ",", " ", "2", ",", " ", "3", 
                          ",", " ", "4", ",", " ", "#"}], "}"}]}], "]"}], 
                          "]"}]}], ",", "\n", "\t\t\t", RowBox[{"{", "\n", 
                          "\t\t\t\t", RowBox[{"\"ExtrapolationHandler\"", 
                          "\[Rule]", RowBox[{"{", RowBox[{RowBox[{"0.", 
                          "&"}], ",", " ", RowBox[{"\"WarningMessage\"", 
                          "\[Rule]", "False"}]}], "}"}]}], "\n", "\t\t\t\t", 
                          "}"}]}], "\n", "\t\t\t", "]"}], "&"}], "/@", 
                      RowBox[{"Range", "[", RowBox[{"5", ",", " ", "7"}], 
                        "]"}]}]}]}]], "CodeInput"], Cell[CellGroupData[
                {Cell["\[LeftCeiling]Compilation\[RightFloor]", 
                  "CodeSubsubsubsubsection", Evaluatable -> True, 
                  CellChangeTimes -> {{3.741540044668268*^9, 
                   3.741540048340281*^9}}], Cell[BoxData[RowBox[
                    {"$H5ParallelDipoleSurfaceVec", ":=", "\n", "\t", 
                     RowBox[{"$H5ParallelDipoleSurfaceVec", "=", "\n", 
                       "\t\t", RowBox[{RowBox[{RowBox[
                          {"H5VectorizedInterpCut", "[", "\n", "\t\t\t", 
                          RowBox[{RowBox[{"{", RowBox[{"Automatic", ",", " ", 
                          "Automatic", ",", " ", "Automatic", ",", " ", 
                          "Automatic"}], "}"}], ",", " ", "\n", "\t\t\t", 
                          "#", ",", " ", "\n", "\t\t\t", "Automatic", ",", 
                          "\n", "\t\t\t", "0"}], "]"}], "&"}], "/@", "\n", 
                         "\t\t\t", "$H5ParallelDipoleSurfaceInterps"}]}]}]], 
                  "CodeInput"]}, Open]]}, Open]]}, Open]]}, Open]], 
     Cell[CellGroupData[
       {Cell["\[LeftCeiling]Outer H2 Potential\[RightFloor]", 
         "CodeSubsection", Evaluatable -> True, CellChangeTimes -> 
          {{3.7386001996062593*^9, 3.738600203244316*^9}}], 
        Cell[CellGroupData[{Cell["\[LeftCeiling]outerH2Pot\[RightFloor]", 
            "CodeSubsubsection", Evaluatable -> True], 
           Cell[BoxData[RowBox[{RowBox[{"outerH2Pot", "[", RowBox[
                  {"{", RowBox[{"n1_", ",", " ", "n2_"}], "}"}], "]"}], ":=", 
               "\[IndentingNewLine]", RowBox[{"Module", "[", 
                 "\[IndentingNewLine]", RowBox[{RowBox[{"{", 
                     "\[IndentingNewLine]", RowBox[{RowBox[{"sagroups", "=", 
                         RowBox[{"GroupBy", "[", RowBox[{RowBox[
                          {"QuantityMagnitude", "@", "H5FullPotQA"}], ",", 
                          "  ", RowBox[{RowBox[{RowBox[{"#", "[", RowBox[
                          {"[", RowBox[{"{", RowBox[{"3", ",", " ", "4"}], 
                          "}"}], "]"}], "]"}], "&"}], "\[Rule]", RowBox[
                          {"(", RowBox[{RowBox[{"#", "[", RowBox[{"[", RowBox[
                          {"{", RowBox[{"1", ",", " ", "2", ",", " ", "5"}], 
                          "}"}], "]"}], "]"}], "&"}], ")"}]}]}], "]"}]}], 
                       ",", "\[IndentingNewLine]", "R1s", ",", 
                       "\[IndentingNewLine]", "R2s", ",", 
                       "\[IndentingNewLine]", "pos"}], "\[IndentingNewLine]", 
                     "}"}], ",", "\[IndentingNewLine]", RowBox[
                    {RowBox[{"R1s", "=", RowBox[{"DeleteDuplicates", "@", 
                         RowBox[{"Sort", "@", RowBox[{RowBox[{"Keys", "[", 
                          "sagroups", "]"}], "[", RowBox[{"[", RowBox[{"All", 
                          ",", " ", "1"}], "]"}], "]"}]}]}]}], ";", 
                     "\[IndentingNewLine]", RowBox[{"R2s", "=", RowBox[
                        {"DeleteDuplicates", "@", RowBox[{"Sort", "@", 
                          RowBox[{RowBox[{"Keys", "[", "sagroups", "]"}], 
                          "[", RowBox[{"[", RowBox[{"All", ",", " ", "2"}], 
                          "]"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
                     RowBox[{"pos", "=", RowBox[{"{", RowBox[{RowBox[{"R1s", 
                          "[", RowBox[{"[", "n1", "]"}], "]"}], ",", " ", 
                          RowBox[{"R2s", "[", RowBox[{"[", "n2", "]"}], 
                          "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
                     RowBox[{"If", "[", RowBox[{RowBox[{"AllTrue", "[", 
                          RowBox[{"pos", ",", " ", "NumericQ"}], "]"}], ",", 
                         " ", "\[IndentingNewLine]", RowBox[{"compiledSAPot", 
                          "@", RowBox[{"Interpolation", "@", RowBox[
                          {"sagroups", "[", "pos", "]"}]}]}], ",", 
                         "\[IndentingNewLine]", "$Failed"}], 
                       "\[IndentingNewLine]", "]"}]}]}], 
                 "\[IndentingNewLine]", "]"}]}]], "CodeInput", 
            CellChangeTimes -> {{3.738596685726177*^9, 
             3.7385967471683283*^9}, {3.738597078136529*^9, 
             3.738597197964383*^9}, {3.738598754602275*^9, 
             3.738598764209237*^9}, {3.738598850853806*^9, 
             3.738598865185684*^9}, {3.738600213512525*^9, 
             3.7386002453487053*^9}}, CellLabel -> "In[98]:="]}, Closed]]}, 
       Open]], Cell[CellGroupData[
       {Cell["\[LeftCeiling]Shared Proton Potential\[RightFloor]", 
         "CodeSubsection", Evaluatable -> True, CellChangeTimes -> 
          {{3.738596679200838*^9, 3.738596682977673*^9}}], 
        Cell[BoxData[RowBox[{RowBox[{"sharedHPot", "[", RowBox[{"{", 
                RowBox[{"n1_", ",", " ", "n2_"}], "}"}], "]"}], ":=", 
            "\[IndentingNewLine]", RowBox[{"Module", "[", 
              "\[IndentingNewLine]", RowBox[{RowBox[{"{", 
                  "\[IndentingNewLine]", RowBox[{RowBox[{"h2groups", "=", 
                      RowBox[{"GroupBy", "[", RowBox[{RowBox[
                          {"QuantityMagnitude", "@", "H5FullPotQA"}], ",", 
                          "  ", RowBox[{RowBox[{RowBox[{"#", "[", RowBox[
                          {"[", RowBox[{";;", "2"}], "]"}], "]"}], "&"}], 
                          "\[Rule]", RowBox[{"(", RowBox[{RowBox[{"#", "[", 
                          RowBox[{"[", RowBox[{"3", ";;"}], "]"}], "]"}], 
                          "&"}], ")"}]}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", "r1s", ",", "\[IndentingNewLine]", 
                    "r2s", ",", "\[IndentingNewLine]", "pos"}], 
                  "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
                RowBox[{RowBox[{"r1s", "=", RowBox[{"DeleteDuplicates", "@", 
                      RowBox[{"Sort", "@", RowBox[{RowBox[{"Keys", "[", 
                          "h2groups", "]"}], "[", RowBox[{"[", RowBox[{"All", 
                          ",", " ", "1"}], "]"}], "]"}]}]}]}], ";", 
                  "\[IndentingNewLine]", RowBox[{"r2s", "=", RowBox[
                     {"DeleteDuplicates", "@", RowBox[{"Sort", "@", RowBox[
                         {RowBox[{"Keys", "[", "h2groups", "]"}], "[", 
                          RowBox[{"[", RowBox[{"All", ",", " ", "2"}], "]"}], 
                          "]"}]}]}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"pos", "=", RowBox[{"{", RowBox[{RowBox[{"r1s", 
                          "[", RowBox[{"[", "n1", "]"}], "]"}], ",", " ", 
                        RowBox[{"r2s", "[", RowBox[{"[", "n2", "]"}], 
                          "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"If", "[", RowBox[{RowBox[{"AllTrue", "[", 
                        RowBox[{"pos", ",", " ", "NumericQ"}], "]"}], ",", 
                      " ", "\[IndentingNewLine]", RowBox[{"compiledSAPot", 
                        "@", RowBox[{"Interpolation", "@", RowBox[
                          {"h2groups", "[", "pos", "]"}]}]}], ",", 
                      "\[IndentingNewLine]", "$Failed"}], 
                    "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
              "]"}]}]], "CodeInput", CellChangeTimes -> 
          {{3.738596685726177*^9, 3.7385967471683283*^9}, 
          {3.738597078136529*^9, 3.738597197964383*^9}, 
          {3.738598754602275*^9, 3.738598764209237*^9}, 
          {3.738598850853806*^9, 3.738598865185684*^9}, 
          {3.7396461047151403*^9, 3.7396461053240747*^9}}, 
         CellLabel -> "In[32]:="]}, Closed]], 
     Cell[CellGroupData[{Cell["\[LeftCeiling]$H5DVR\[RightFloor]", 
         "CodeSubsection", Evaluatable -> True, CellChangeTimes -> 
          {{3.731863997039401*^9, 3.731863998951846*^9}, 
           {3.734891726152999*^9, 3.734891730802512*^9}, 
           3.739904824214282*^9}], 
        Cell[BoxData[{RowBox[{RowBox[{RowBox[{"loadH5DVR", "[", "]"}], ":=", 
               "\n", "\t", RowBox[{"(", "\n", "\t\t", RowBox[
                  {RowBox[{"loadH5DVR", "[", "\"DVR\"", "]"}], ";", "\n", 
                   "\t", "\t", RowBox[{"loadH5DVR", "[", "\"Pot\"", "]"}], 
                   ";", "\n", "\t", "\t", RowBox[{"loadH5DVR", "[", 
                     "\"Settings\"", "]"}], ";", "\n", "\t\t", "$H5DVR"}], 
                 "\n", "\t\t", ")"}]}], ";"}], "\n", 
           RowBox[{RowBox[{"If", "[", RowBox[{RowBox[{"!", RowBox[{"MatchQ", 
                     "[", RowBox[{RowBox[{"OwnValues", "[", "$H5DVR", "]"}], 
                       ",", " ", RowBox[{"{", RowBox[{"_", "\[RuleDelayed]", 
                          "_ChemDVRObject"}], "}"}]}], "]"}]}], ",", "\n", 
                 "\t", RowBox[{"$H5DVR", ":=", RowBox[{"loadH5DVR", "[", 
                     "]"}]}]}], "\n", "\t", "]"}], ";"}]}], "CodeInput"], 
        Cell[CellGroupData[{Cell["\[LeftCeiling]$H5DVR\[RightFloor]", 
            "CodeSubsubsection", Evaluatable -> True, CellChangeTimes -> 
             {{3.731864004671295*^9, 3.731864006111929*^9}, 
             {3.73489173306841*^9, 3.734891733827517*^9}}], 
           Cell[BoxData[RowBox[{RowBox[{RowBox[{"loadH5DVR", "[", "\"DVR\"", 
                   "]"}], ":=", "\n", "\t", RowBox[{"$H5DVR", "=", 
                   RowBox[{"ChemDVRObject", "[", "\"Cartesian2DDVR\"", 
                     "]"}]}]}], ";"}]], "CodeInput"]}, Open]], 
        Cell[CellGroupData[{Cell["\[LeftCeiling]Potential\[RightFloor]", 
            "CodeSubsubsection", Evaluatable -> True, CellChangeTimes -> 
             {{3.734891849679302*^9, 3.734891851718679*^9}, 
             {3.738592787050703*^9, 3.738592790981908*^9}}], 
           Cell[CellGroupData[{Cell["\[LeftCeiling]Old Version\[RightFloor]", 
               "CodeSubsubsubsection", Evaluatable -> True, 
               CellChangeTimes -> {{3.742177985024981*^9, 
                3.7421779872393017*^9}}], Cell[BoxData[RowBox[{"(*", 
                  RowBox[{RowBox[{RowBox[{RowBox[{"h5PotOldDat", "=", 
                          RowBox[{"Import", "[", RowBox[
                          {"\"~/Documents/UW/Research/H5+/inputs/2d_pot.dat\"\
", ",", "\"TSV\""}], "]"}]}], ";"}], "\[IndentingNewLine]", RowBox[
                       {RowBox[{"h5PotOldGrid", "=", RowBox[{RowBox[
                          {"DeleteCases", "[", RowBox[{"h5PotOldDat", ",", 
                          RowBox[{"{", "}"}]}], "]"}], "[", RowBox[{"[", 
                          RowBox[{RowBox[{"2", ";;"}], ",", RowBox[{"{", 
                          RowBox[{"1", ",", "2", ",", "5"}], "}"}]}], "]"}], 
                          "]"}]}], ";"}], "\n", RowBox[{RowBox[
                         {"h5PotOldInterp", "=", RowBox[{"Interpolation", 
                          "[", "h5PotOldGrid", "]"}]}], ";"}], "\n", 
                      RowBox[{"With", "[", RowBox[{RowBox[{"{", RowBox[
                          {RowBox[{"potInterp", "=", "h5PotOldInterp"}], ",", 
                          RowBox[{"dom", "=", RowBox[{"h5PotOldInterp", "[", 
                          RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", 
                          "\[IndentingNewLine]", RowBox[{RowBox[{"h5PotOld", 
                          "=", "\[IndentingNewLine]", RowBox[{"Compile", "[", 
                          RowBox[{RowBox[{"{", RowBox[{"{", RowBox[{"sa", 
                          ",", "_Real", ",", "1"}], "}"}], "}"}], ",", 
                          "\[IndentingNewLine]", RowBox[{"With", "[", 
                          "\[IndentingNewLine]", RowBox[{RowBox[{"{", 
                          "\[IndentingNewLine]", RowBox[{RowBox[{"R1", "=", 
                          RowBox[{RowBox[{"1", "/", RowBox[{"Sqrt", "[", "2", 
                          "]"}]}], RowBox[{"(", RowBox[{RowBox[{"sa", "[", 
                          RowBox[{"[", "2", "]"}], "]"}], "+", RowBox[{"sa", 
                          "[", RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], 
                          ",", "\[IndentingNewLine]", RowBox[{"R2", "=", 
                          RowBox[{RowBox[{"1", "/", RowBox[{"Sqrt", "[", "2", 
                          "]"}]}], RowBox[{"(", RowBox[{RowBox[{"sa", "[", 
                          RowBox[{"[", "2", "]"}], "]"}], "-", RowBox[{"sa", 
                          "[", RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}]}], 
                          "\[IndentingNewLine]", "}"}], ",", 
                          "\[IndentingNewLine]", RowBox[{"If", "[", RowBox[
                          {RowBox[{RowBox[{RowBox[{"dom", "[", RowBox[{"[", 
                          RowBox[{"1", ",", "1"}], "]"}], "]"}], 
                          "\[LessEqual]", "R2", "\[LessEqual]", RowBox[
                          {"dom", "[", RowBox[{"[", RowBox[{"1", ",", "2"}], 
                          "]"}], "]"}]}], "&&", "\[IndentingNewLine]", RowBox[
                          {RowBox[{"dom", "[", RowBox[{"[", RowBox[{"2", ",", 
                          "1"}], "]"}], "]"}], "\[LessEqual]", "R1", 
                          "\[LessEqual]", RowBox[{"dom", "[", RowBox[{"[", 
                          RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], ",", 
                          "\[IndentingNewLine]", RowBox[{"potInterp", "[", 
                          RowBox[{"R1", ",", " ", "R2"}], "]"}], ",", 
                          "\[IndentingNewLine]", RowBox[{"10", "^", "9"}]}], 
                          "\[IndentingNewLine]", "]"}]}], 
                          "\[IndentingNewLine]", "]"}], ",", 
                          "\[IndentingNewLine]", RowBox[{"RuntimeOptions", 
                          "\[Rule]", RowBox[{"{", "\[IndentingNewLine]", 
                          RowBox[{RowBox[{"\"EvaluateSymbolically\"", 
                          "\[Rule]", "False"}], ",", "\[IndentingNewLine]", 
                          RowBox[{"\"WarningMessages\"", "\[Rule]", 
                          "False"}]}], "\[IndentingNewLine]", "}"}]}]}], 
                          "\[IndentingNewLine]", "]"}]}], ";"}]}], 
                        "\[IndentingNewLine]", "]"}]}], ";"}], "*)"}]], 
               "CodeInput", CellChangeTimes -> {{3.734891852626347*^9, 
                 3.7348919379743223*^9}, {3.73990495035277*^9, 
                 3.739904954941717*^9}, {3.7424926169958277*^9, 
                 3.742492617252523*^9}, {3.742492749380034*^9, 
                 3.742492760897436*^9}, 3.742492879340543*^9}, CellLabel -> 
                "In[34]:="], Cell[BoxData[RowBox[{"(*", RowBox[
                   {RowBox[{"h5PotOldRange", "=", "\[IndentingNewLine]", 
                      RowBox[{RowBox[{RowBox[{RowBox[{"RotationMatrix", "[", 
                          RowBox[{"\[Pi]", "/", "4"}], "]"}], ".", RowBox[
                          {"Transpose", "@", RowBox[{"Tuples", "[", RowBox[
                          {"h5PotOldInterp", "[", RowBox[{"[", "1", "]"}], 
                          "]"}], "]"}]}]}], "//", "Transpose"}], "//", 
                        "CoordinateBounds"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"h5PotOldReg", "=", "\[IndentingNewLine]", 
                      RowBox[{"TransformedRegion", "[", RowBox[{RowBox[
                          {"Rectangle", "@@", RowBox[{"Transpose", "@", 
                          RowBox[{"h5PotOldInterp", "[", RowBox[{"[", "1", 
                          "]"}], "]"}]}]}], ",", " ", RowBox[
                          {"RotationTransform", "[", RowBox[{"\[Pi]", "/", 
                          "4"}], "]"}]}], "]"}]}], ";"}], "*)"}]], 
               "CodeInput", CellChangeTimes -> {{3.742492808965447*^9, 
                3.742492874268963*^9}, {3.742493714206006*^9, 
                3.7424937204697647*^9}}, CellLabel -> "In[38]:="]}, Closed]], 
           Cell[CellGroupData[{Cell["\[LeftCeiling]New Version\[RightFloor]", 
               "CodeSubsubsubsection", Evaluatable -> True, 
               CellChangeTimes -> {{3.742177985024981*^9, 
                3.742177991783216*^9}}], Cell[BoxData[RowBox[
                 {RowBox[{RowBox[{"loadH5DVR", "[", "\"Pot\"", "]"}], ":=", 
                    "\n", "\t", RowBox[{"h5EqH2Pot", "=", "\n", "\t\t", 
                      RowBox[{"h5PotCut", "[", "\n", "\t\t\t", RowBox[
                         {RowBox[{"Join", "[", "\n", "\t", "\t", "\t\t", 
                          RowBox[{RowBox[{"{", RowBox[{"Automatic", ",", " ", 
                          "Automatic"}], "}"}], ",", "\n", "\t", "\t", 
                          "\t\t", RowBox[{"{", RowBox[{
                          "0.44687908484223565`", ",", " ", 
                          "0.44687908484223565`"}], "}"}]}], "\n", "\t", 
                          "\t", "\t\t", "]"}], ",", "\n", "\t", "\t", "\t", 
                          RowBox[{"-", "477.5763098854306`"}]}], "\n", "\t", 
                        "\t", "\t", "]"}]}]}], ";"}]], "CodeInput"], 
              Cell[BoxData[RowBox[{"(*", RowBox[{"Quiet", "@", RowBox[
                     {"NMinimize", "[", RowBox[{RowBox[{"h5EqH2Pot", "[", 
                          RowBox[{"{", RowBox[{"{", RowBox[{"a", ",", " ", 
                          "s"}], "}"}], "}"}], "]"}], ",", " ", RowBox[
                         {RowBox[{"{", RowBox[{"a", ",", " ", "s"}], "}"}], 
                          "\[Element]", "h5Reg"}]}], "]"}]}], "*)"}]], 
               "CodeInput", CellChangeTimes -> {{3.7421779980092382*^9, 
                3.742178046366781*^9}, {3.742424097057007*^9, 
                3.742424097887693*^9}, {3.7424241483115396*^9, 
                3.742424149556559*^9}, {3.742425007355832*^9, 
                3.742425008433198*^9}}, CellLabel -> "In[41]:="]}, Closed]], 
           Cell[CellGroupData[{Cell["\[LeftCeiling]Difference\[RightFloor]", 
               "CodeSubsubsubsection", Evaluatable -> True, 
               CellChangeTimes -> {{3.742493567408584*^9, 
                3.742493568822761*^9}}], Cell[BoxData[RowBox[{"(*", 
                  RowBox[{"Plot3D", "[", "\[IndentingNewLine]", RowBox[
                     {RowBox[{RowBox[{"h5EqH2Pot", "[", RowBox[{"{", RowBox[
                          {"{", RowBox[{"a", ",", " ", "s"}], "}"}], "}"}], 
                          "]"}], "-", RowBox[{"h5PotOld", "[", RowBox[
                          {"{", RowBox[{"a", ",", " ", "s"}], "}"}], "]"}]}], 
                      ",", "\[IndentingNewLine]", RowBox[{RowBox[{"{", 
                          RowBox[{"a", ",", " ", "s"}], "}"}], "\[Element]", 
                        "h5PotOldReg"}]}], "\[IndentingNewLine]", "]"}], 
                  "*)"}]], "CodeInput", CellChangeTimes -> 
                {{3.742493434052397*^9, 3.7424934428103*^9}, 
                {3.742493546695011*^9, 3.742493677942285*^9}, 
                {3.742493724140909*^9, 3.742493726300823*^9}}, CellLabel -> 
                "In[42]:="], Cell[BoxData[RowBox[{"(*", RowBox[
                   {RowBox[{RowBox[{"h5EqH2Pot", "[", RowBox[{"{", RowBox[
                          {"{", RowBox[{"a", ",", " ", "s"}], "}"}], "}"}], 
                        "]"}], "-", RowBox[{"h5PotOld", "[", RowBox[{"{", 
                          RowBox[{"a", ",", " ", "s"}], "}"}], "]"}]}], "/.", 
                    RowBox[{"{", RowBox[{RowBox[{"a", "\[Rule]", "0"}], ",", 
                        RowBox[{"s", "\[Rule]", "1.5320444241335043`"}]}], 
                      "}"}]}], "*)"}]], "CodeInput", CellChangeTimes -> 
                {{3.74249429016336*^9, 3.742494304541112*^9}}, CellLabel -> 
                "In[43]:="]}, Closed]]}, Open]], 
        Cell[CellGroupData[{Cell["\[LeftCeiling]Region\[RightFloor]", 
            "CodeSubsubsection", Evaluatable -> True, CellChangeTimes -> 
             {{3.734891972373926*^9, 3.734891973141464*^9}}], 
           Cell[BoxData[RowBox[{"(*", RowBox[{RowBox[{RowBox[
                    {RowBox[{"{", RowBox[{"h5RegMin", ",", "h5RegMax"}], 
                       "}"}], "=", RowBox[{"Transpose", "@", RowBox[
                        {"h5EqH2Pot", "[", RowBox[{"[", "1", "]"}], 
                         "]"}]}]}], ";"}], "\n", RowBox[{RowBox[
                    {"h5RegUnrot", "=", RowBox[{"Rectangle", "[", RowBox[
                        {"h5RegMin", ",", "h5RegMax"}], "]"}]}], ";"}], "\n", 
                 RowBox[{RowBox[{"h5Reg", "=", RowBox[{"Region", "@", 
                       RowBox[{"TransformedRegion", "[", RowBox[
                          {"h5RegUnrot", ",", RowBox[{"RotationTransform", 
                          "[", RowBox[{"\[Pi]", "/", "4"}], "]"}]}], 
                         "]"}]}]}], ";"}]}], "*)"}]], "CodeInput", 
            CellChangeTimes -> {{3.734891975591241*^9, 3.734892015997341*^9}, 
              {3.7350822322720833*^9, 3.7350822590469017*^9}, 
              {3.735138323092054*^9, 3.735138350932913*^9}, 
              3.739905140520237*^9, 3.742423149347225*^9}, 
            CellLabel -> "In[44]:="], Cell[BoxData[RowBox[
              {RowBox[{"loadH5DVR", "[", "\"Region\"", "]"}], ":=", "\n", 
               "\t", RowBox[{"(", "\n", "\t\t", RowBox[{RowBox[
                    {RowBox[{"{", RowBox[{"h5RegMin", ",", "h5RegMax"}], 
                       "}"}], "=", "\n", "\t\t\t", RowBox[{"Transpose", "@", 
                       RowBox[{RowBox[{"getDomain", "[", RowBox[
                          {"H5FullInterpPot", ",", " ", "Automatic"}], "]"}], 
                         "[", RowBox[{"[", RowBox[{"{", RowBox[{"3", ",", 
                          " ", "4"}], "}"}], "]"}], "]"}]}]}], ";", "\n", 
                   "\t\t", RowBox[{"h5RegUnrot", "=", RowBox[{"Rectangle", 
                       "[", RowBox[{"h5RegMin", ",", "h5RegMax"}], "]"}]}], 
                   ";", "\n", "\t\t", RowBox[{"h5Reg", "=", RowBox[{"Region", 
                       "@", RowBox[{"TransformedRegion", "[", RowBox[
                          {"h5RegUnrot", ",", RowBox[{"RotationTransform", 
                          "[", RowBox[{"\[Pi]", "/", "4"}], "]"}]}], 
                         "]"}]}]}], ";"}], "\n", "\t\t", ")"}]}]], 
            "CodeInput"]}, Open]], Cell[CellGroupData[
          {Cell["\[LeftCeiling]Ops\[RightFloor]", "CodeSubsubsection", 
            Evaluatable -> True, CellChangeTimes -> {{3.7348920704194403*^9, 
              3.734892075314517*^9}, {3.7348922603494787*^9, 
              3.734892260719327*^9}, 3.735082195857592*^9}], 
           Cell[BoxData[RowBox[{"<<", "ChemTools`Data`"}]], "CodeInput", 
            CellChangeTimes -> {{3.724625736341876*^9, 3.724625750428109*^9}, 
             {3.724791374399713*^9, 3.724791375714342*^9}, 
             {3.724796659364353*^9, 3.7247966665533943*^9}, 
             {3.7275718655476713*^9, 3.727571898968864*^9}, 
             {3.734892078989205*^9, 3.734892214051343*^9}, 
             {3.734892251045857*^9, 3.734892278574534*^9}}, 
            CellLabel -> "In[48]:="], Cell[CellGroupData[
             {Cell["\[LeftCeiling]Grid\[RightFloor]", "CodeSubsubsubsection", 
               Evaluatable -> True, CellChangeTimes -> 
                {{3.7348922864342737*^9, 3.734892286911202*^9}}], 
              Cell[BoxData[RowBox[{RowBox[{RowBox[{"loadH5DVR", "[", 
                      "\"GridOps\"", "]"}], ":=", "\n", "\t", RowBox[
                     {"h5GridOps", "=", "\n", "\t\t", RowBox[{"{", "\n", 
                        "\t\t\t", RowBox[{RowBox[{"\"Range\"", "\[Rule]", 
                          "\n", "\t\t\t\t", RowBox[{"With", "[", "\n", 
                          "\t\t\t\t\t", RowBox[{RowBox[{"{", "\n", 
                          "\t\t\t\t\t\t", RowBox[{RowBox[{"a", " ", "=", " ", 
                          RowBox[{"RegionBounds", "@", "h5Reg"}]}], ",", 
                          "\n", "\t\t\t\t\t\t", RowBox[{"b", " ", "=", " ", 
                          RowBox[{"{", RowBox[{RowBox[{"{", RowBox[{RowBox[
                          {"-", "10"}], ",", " ", "10"}], "}"}], ",", " ", 
                          RowBox[{"{", RowBox[{"0", ",", " ", "4"}], "}"}]}], 
                          "}"}]}]}], "\n", "\t\t\t\t\t\t", "}"}], ",", "\n", 
                          "\t\t\t\t\t", RowBox[{"MapThread", "[", "\n", 
                          "\t\t\t\t\t\t", RowBox[{RowBox[{RowBox[{"{", RowBox[
                          {RowBox[{"Max", "@", RowBox[{"{", RowBox[{RowBox[
                          {"#", "[", RowBox[{"[", "1", "]"}], "]"}], ",", 
                          " ", RowBox[{"#2", "[", RowBox[{"[", "1", "]"}], 
                          "]"}]}], "}"}]}], ",", " ", RowBox[{"Min", "@", 
                          RowBox[{"{", RowBox[{RowBox[{"#", "[", RowBox[{"[", 
                          "2", "]"}], "]"}], ",", " ", RowBox[{"#2", "[", 
                          RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}]}], "}"}], 
                          "&"}], ",", "\n", "\t\t\t\t\t\t", RowBox[{"{", 
                          RowBox[{"a", ",", " ", "b"}], "}"}]}], "\n", 
                          "\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t", 
                          "]"}]}], ",", "\n", "\t\t\t", RowBox[{"\"Points\"", 
                          "\[Rule]", RowBox[{"{", RowBox[{"60", ",", "60"}], 
                          "}"}]}]}], "\n", "\t", "\t", "\t", "}"}]}]}], 
                  ";"}]], "CodeInput"]}, Open]], Cell[CellGroupData[
             {Cell["\[LeftCeiling]KE\[RightFloor]", "CodeSubsubsubsection", 
               Evaluatable -> True, CellChangeTimes -> 
                {{3.734892282801947*^9, 3.734892283025955*^9}}], 
              Cell[BoxData[RowBox[{RowBox[{"loadH5DVR", "[", "\"KEOps\"", 
                    "]"}], ":=", "\n", "\t", RowBox[{"(", "\n", "\t\t", 
                    RowBox[{RowBox[{"h5HMass", "=", "\n", "\t\t\t", RowBox[
                         {"ChemDataLookup", "[", RowBox[{"\"H\"", ",", " ", 
                          "\"NISTMass\""}], "]"}]}], ";", "\n", "\t\t", 
                      RowBox[{"h5KEOps", "=", "\n", "\t\t\t", RowBox[
                         {"{", "\n", "\t\t\t\t", RowBox[{RowBox[{"\"HBar\"", 
                          "->", "\n", "\t\t\t\t\t", RowBox[
                          {"QuantityMagnitude", "@", "\n", "\t\t\t\t\t\t", 
                          RowBox[{"ChemDataLookup", "[", RowBox[
                          {"\"DVRHBarInAMUWavenumbers\"", ",", " ", 
                          "\"Constants\""}], "]"}]}]}], ",", "\n", 
                          "\t\t\t\t", RowBox[{"\"Mass\"", "\[Rule]", "\n", 
                          "\t\t\t\t\t", RowBox[{"With", "[", "\n", 
                          "\t\t\t\t\t\t", RowBox[{RowBox[{"{", "\n", 
                          "\t\t\t\t\t\t\t", RowBox[{"hMass", "=", "\n", 
                          "\t\t\t\t\t\t\t\t", RowBox[{"QuantityMagnitude", 
                          "@", "\n", "\t\t\t\t\t\t\t\t\t", RowBox[
                          {"UnitConvert", "[", RowBox[{"h5HMass", ",", 
                          "\"AtomicMassUnit\""}], "]"}]}]}], "\n", 
                          "\t\t\t\t\t\t\t", "}"}], ",", "\n", "\t\t\t\t\t\t", 
                          RowBox[{"{", "\n", "\t\t\t\t\t\t\t", RowBox[
                          {RowBox[{RowBox[{"(", RowBox[{"hMass", "*", RowBox[
                          {"(", RowBox[{"2", "hMass"}], " ", RowBox[{"(*", 
                          RowBox[{RowBox[{"+", " ", "2"}], "hMass"}], "*)"}], 
                          ")"}]}], ")"}], "/", "\n", "\t\t\t\t\t\t\t\t", 
                          RowBox[{"(", RowBox[{"hMass", "+", RowBox[{"(", 
                          RowBox[{RowBox[{"2", "hMass"}], " ", "+", " ", 
                          RowBox[{"2", "hMass"}]}], ")"}]}], ")"}]}], ",", 
                          " ", "\n", "\t\t\t\t\t\t\t", RowBox[{"2", "*", 
                          "hMass"}]}], "\n", "\t\t\t\t\t\t\t", "}"}]}], "\n", 
                          "\t\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t\t", 
                          RowBox[{"\"ScalingFactor\"", "\[Rule]", "\n", 
                          "\t\t\t\t\t", RowBox[{"(", RowBox[{"1", "/", RowBox[
                          {RowBox[{"QuantityMagnitude", "@", RowBox[
                          {"UnitConvert", "[", RowBox[{"\"Angstroms\"", ",", 
                          " ", "\"Centimeters\""}], "]"}]}], "^", "2"}]}], 
                          ")"}]}]}], "\n", "\t\t\t\t", "}"}]}], ";"}], "\n", 
                    "\t\t", ")"}]}]], "CodeInput"]}, Closed]], 
           Cell[CellGroupData[{Cell["\[LeftCeiling]PE\[RightFloor]", 
               "CodeSubsubsubsection", Evaluatable -> True, 
               CellChangeTimes -> {{3.734892282801947*^9, 
                 3.734892283025955*^9}, 3.734901351564073*^9}], 
              Cell[BoxData[RowBox[{RowBox[{RowBox[{"loadH5DVR", "[", 
                      "\"PEOps\"", "]"}], ":=", "\n", "\t", RowBox[
                     {"h5PEOps", "=", "\n", "\t\t", RowBox[{"{", "\n", 
                        "\t\t\t", RowBox[{"\"PotentialFunction\"", ":>", 
                          "\n", "\t", "\t", "\t", "h5EqH2Pot"}], "\n", "\t", 
                        "\t", "\t", "}"}]}]}], ";"}]], "CodeInput"]}, 
             Closed]], Cell[CellGroupData[
             {Cell["\[LeftCeiling]Run\[RightFloor]", "CodeSubsubsubsection", 
               Evaluatable -> True, CellChangeTimes -> 
                {{3.734892518648984*^9, 3.7348925189658403*^9}}], 
              Cell[BoxData[RowBox[{RowBox[{RowBox[{"loadH5DVR", "[", 
                      "\"RunOps\"", "]"}], ":=", "\n", "\t", RowBox[
                     {"h5RunOps", "=", "\n", "\t\t", RowBox[{"{", "\n", 
                        "\t\t\t", RowBox[{RowBox[{"Monitor", "\[Rule]", 
                          "False"}], ",", "\n", "\t", "\t", "\t", RowBox[
                          {"\"SaveKineticEnergy\"", "\[Rule]", "False"}], 
                          ",", "\n", "\t", "\t", "\t", RowBox[
                          {"\"LoadKineticEnergy\"", "\[Rule]", "False"}]}], 
                        "\n", "\t", "\t", "\t", "}"}]}]}], ";"}]], 
               "CodeInput"]}, Closed]], Cell[CellGroupData[
             {Cell["\[LeftCeiling]Plot\[RightFloor]", "CodeSubsubsubsection", 
               Evaluatable -> True, CellChangeTimes -> 
                {{3.734892552423584*^9, 3.734892552868722*^9}}], 
              Cell[BoxData[RowBox[{RowBox[{"loadH5DVR", "[", "\"PlotOps\"", 
                    "]"}], ":=", "\n", RowBox[{"(", "\n", "\t", RowBox[
                     {RowBox[{"If", "[", RowBox[{RowBox[{RowBox[{"OwnValues", 
                          "@", "h5PotMinMax"}], "\[Equal]", RowBox[{"{", 
                          "}"}]}], ",", "\n", "\t", "\t", RowBox[
                          {"h5PotMinMax", ":=", "\n", "\t\t\t", RowBox[
                          {"h5PotMinMax", "=", "\n", "\t\t\t\t", RowBox[
                          {"Map", "[", RowBox[{RowBox[{RowBox[{"#", "[", 
                          RowBox[{RowBox[{"h5EqH2Pot", "[", RowBox[{"{", 
                          RowBox[{"x", ",", "y"}], "}"}], "]"}], ",", RowBox[
                          {RowBox[{"{", RowBox[{"x", ",", "y"}], "}"}], 
                          "\[Element]", RowBox[{"RegionResize", "[", RowBox[
                          {"h5Reg", ",", RowBox[{"Scaled", "[", ".95", 
                          "]"}]}], "]"}]}]}], "]"}], "&"}], ",", "\n", "\t", 
                          "\t", "\t", "\t\t", RowBox[{"{", "\n", "\t", "\t", 
                          "\t", "\t\t\t", RowBox[{"NMinValue", ",", "\n", 
                          "\t", "\t", "\t", "\t\t\t", "NMaxValue"}], "\n", 
                          "\t", "\t", "\t", "\t\t\t", "}"}]}], "\n", "\t", 
                          "\t", "\t\t\t", "]"}]}]}]}], "\n", "\t\t", "]"}], 
                      ";", "\n", "\t", RowBox[{"h5RegMemFunc", "=", "\n", 
                        "\t\t", RowBox[{"RegionMember", "@", RowBox[
                          {"RegionResize", "[", RowBox[{"h5Reg", ",", " ", 
                          RowBox[{"Scaled", "[", ".95", "]"}]}], "]"}]}]}], 
                      ";", "\n", "\t", RowBox[{"h5ColFun", ":=", "\n", 
                        "\t\t", RowBox[{"With", "[", RowBox[{RowBox[{"{", 
                          "\n", "\t", "\t\t\t", RowBox[{RowBox[{"cf", "=", 
                          RowBox[{"ColorData", "[", 
                          "\"M10DefaultDensityGradient\"", "]"}]}], ",", 
                          "\n", "\t", "\t", "\t\t", RowBox[{"mm", "=", 
                          "h5PotMinMax"}], ",", "\n", "\t", "\t", "\t\t", 
                          RowBox[{"pot", "=", "h5Pot"}]}], "\n", "\t", "\t", 
                          "\t\t", "}"}], ",", "\n", "\t", "\t", "\t", RowBox[
                          {RowBox[{"cf", "[", RowBox[{"Rescale", "[", RowBox[
                          {RowBox[{"pot", "[", RowBox[{"{", RowBox[{"#", ",", 
                          "#2"}], "}"}], "]"}], ",", "mm", ",", RowBox[{"{", 
                          RowBox[{"0", ",", "1"}], "}"}]}], "]"}], "]"}], 
                          "&"}]}], "\n", "\t", "\t", "\t", "]"}]}], ";", 
                      "\n", "\t", RowBox[{"h5PlotOps", "=", "\n", "\t\t", 
                        RowBox[{"{", "\n", "\t", "\n", "\t\t\t", RowBox[
                          {RowBox[{"\"PotentialStyle\"", "\[Rule]", "None"}], 
                          ",", "\n", "\t", "\t", "\t", RowBox[
                          {"\"ShowEnergy\"", "\[Rule]", "False"}], ",", "\n", 
                          "\t", "\t", "\t", RowBox[{"PlotRange", "\[Rule]", 
                          "All"}], ",", "\n", "\t\t\t", RowBox[
                          {"RegionFunction", ":>", "\n", "\t\t\t\t", RowBox[
                          {"With", "[", RowBox[{RowBox[{"{", RowBox[{"rf", 
                          "=", "h5RegMemFunc"}], "}"}], ",", " ", RowBox[
                          {RowBox[{"rf", "[", RowBox[{"{", RowBox[{"#", ",", 
                          " ", "#2"}], "}"}], "]"}], "&"}]}], "]"}]}], ",", 
                          "\n", "\t\t\t", RowBox[{
                          "\"WavefunctionSelection\"", "\[Rule]", "1"}], ",", 
                          "\n", "\t\t\t", RowBox[{"ColorFunction", ":>", 
                          "h5ColFun"}], ",", "\n", "\t\t\t", RowBox[
                          {"ColorFunctionScaling", "\[Rule]", "False"}], ",", 
                          "\n", "\t", "\t", "\t", RowBox[{"Lighting", "->", 
                          "\"Neutral\""}], ",", "\n", "\t", "\t", "\t", 
                          RowBox[{"Manipulate", "\[Rule]", "False"}]}], "\n", 
                          "\t\t\t", "}"}]}], ";"}], "\n", "\t", ")"}]}]], 
               "CodeInput"]}, Closed]], Cell[CellGroupData[
             {Cell["\[LeftCeiling]$H5Settings\[RightFloor]", 
               "CodeSubsubsubsection", Evaluatable -> True, 
               CellChangeTimes -> {{3.73489180431931*^9, 
                3.7348918090640173*^9}}], Cell[BoxData[RowBox[
                 {RowBox[{"loadH5DVR", "[", "\"Settings\"", "]"}], ":=", 
                  "\n", "\t", RowBox[{"(", "\n", "\t\t", RowBox[
                     {RowBox[{"loadH5DVR", "[", "\"Region\"", "]"}], ";", 
                      "\n", "\t\t", RowBox[{"loadH5DVR", "[", "\"GridOps\"", 
                        "]"}], ";", "\n", "\t", "\t", RowBox[{"loadH5DVR", 
                        "[", "\"KEOps\"", "]"}], ";", "\n", "\t", "\t", 
                      RowBox[{"loadH5DVR", "[", "\"PEOps\"", "]"}], ";", 
                      "\n", "\t\t", RowBox[{"loadH5DVR", "[", "\"RunOps\"", 
                        "]"}], ";", "\n", "\t\t", RowBox[{"loadH5DVR", "[", 
                        "\"PlotOps\"", "]"}], ";", "\n", "\t\t", RowBox[
                       {RowBox[{"$H5DVR", "[", "\"RuntimeOptions\"", "]"}], 
                        "=", "\n", "\t", "\t\t", RowBox[{"Flatten", "@", 
                          "\n", "\t", "\t\t", RowBox[{"{", "\n", "\t", 
                          "\t\t\t", RowBox[{RowBox[{"\"GridOptions\"", 
                          "\[Rule]", "\n", "\t", "\t", "\t\t\t", 
                          "h5GridOps"}], ",", "\n", "\t", "\t", "\t\t", 
                          RowBox[{"\"KineticEnergyOptions\"", "\[Rule]", 
                          "\n", "\t", "\t", "\t\t\t", "h5KEOps"}], ",", "\n", 
                          "\t", "\t", "\t\t", RowBox[{
                          "\"PotentialEnergyOptions\"", "\[Rule]", "\n", 
                          "\t", "\t", "\t\t\t", "h5PEOps"}], ",", "\n", "\t", 
                          "\t", "\t\t", RowBox[{"\"ViewOptions\"", ":>", 
                          "\n", "\t\t\t\t\t", "h5PlotOps"}], ",", "\n", 
                          "\t\t\t\t", "h5RunOps"}], "\n", "\t\t\t\t", 
                          "}"}]}]}], ";"}], "\n", "\t\t", ")"}]}]], 
               "CodeInput"]}, Open]]}, Open]]}, Open]], 
     Cell[CellGroupData[{Cell["\[LeftCeiling]$D5DVR\[RightFloor]", 
         "CodeSubsection", Evaluatable -> True], 
        Cell[BoxData[{RowBox[{RowBox[{RowBox[{"loadD5DVR", "[", "]"}], ":=", 
               "\n", "\t", RowBox[{"(", "\n", "\t\t", RowBox[
                  {RowBox[{"loadD5DVR", "[", "\"DVR\"", "]"}], ";", "\n", 
                   "\t\t", RowBox[{"loadH5DVR", "[", "\"Pot\"", "]"}], ";", 
                   "\n", "\t\t", RowBox[{"loadD5DVR", "[", "\"Settings\"", 
                     "]"}], ";", "\n", "\t\t", "$D5DVR"}], "\n", "\t\t", 
                 ")"}]}], ";"}], "\n", RowBox[{RowBox[{"If", "[", RowBox[
                {RowBox[{"!", RowBox[{"MatchQ", "[", RowBox[{RowBox[
                        {"OwnValues", "[", "$D5DVR", "]"}], ",", " ", 
                       RowBox[{"{", RowBox[{"_", "\[RuleDelayed]", 
                          "_ChemDVRObject"}], "}"}]}], "]"}]}], ",", "\n", 
                 "\t", RowBox[{"$D5DVR", ":=", RowBox[{"loadD5DVR", "[", 
                     "]"}]}]}], "\n", "\t", "]"}], ";"}]}], "CodeInput"], 
        Cell[CellGroupData[{Cell["\[LeftCeiling]$D5DVR\[RightFloor]", 
            "CodeSubsubsection", Evaluatable -> True], 
           Cell[BoxData[RowBox[{RowBox[{RowBox[{"loadD5DVR", "[", "\"DVR\"", 
                   "]"}], ":=", "\n", "\t", RowBox[{"$D5DVR", "=", 
                   RowBox[{"ChemDVRObject", "[", "\"Cartesian2DDVR\"", 
                     "]"}]}]}], ";"}]], "CodeInput"]}, Open]], 
        Cell[CellGroupData[{Cell["\[LeftCeiling]Ops\[RightFloor]", 
            "CodeSubsubsection", Evaluatable -> True, CellChangeTimes -> 
             {{3.7348920704194403*^9, 3.734892075314517*^9}, 
              {3.7348922603494787*^9, 3.734892260719327*^9}, 
              3.735082195857592*^9}], Cell[BoxData[RowBox[
              {"<<", "ChemTools`Data`"}]], "CodeInput", CellChangeTimes -> 
             {{3.724625736341876*^9, 3.724625750428109*^9}, 
             {3.724791374399713*^9, 3.724791375714342*^9}, 
             {3.724796659364353*^9, 3.7247966665533943*^9}, 
             {3.7275718655476713*^9, 3.727571898968864*^9}, 
             {3.734892078989205*^9, 3.734892214051343*^9}, 
             {3.734892251045857*^9, 3.734892278574534*^9}}, 
            CellLabel -> "In[48]:="], Cell[CellGroupData[
             {Cell["\[LeftCeiling]KE\[RightFloor]", "CodeSubsubsubsection", 
               Evaluatable -> True, CellChangeTimes -> 
                {{3.734892282801947*^9, 3.734892283025955*^9}}], 
              Cell[BoxData[RowBox[{RowBox[{"loadD5DVR", "[", "\"KEOps\"", 
                    "]"}], ":=", "\n", "\t", RowBox[{"(", "\n", "\t\t", 
                    RowBox[{RowBox[{"d5DMass", "=", "\n", "\t\t\t", RowBox[
                         {"ChemDataLookup", "[", RowBox[{"\"D\"", ",", " ", 
                          "\"NISTMass\""}], "]"}]}], ";", "\n", "\t\t", 
                      RowBox[{"d5KEOps", "=", "\n", "\t\t\t", RowBox[
                         {"{", "\n", "\t\t\t\t", RowBox[{RowBox[{"\"HBar\"", 
                          "->", "\n", "\t\t\t\t\t", RowBox[
                          {"QuantityMagnitude", "@", "\n", "\t\t\t\t\t\t", 
                          RowBox[{"ChemDataLookup", "[", RowBox[
                          {"\"DVRHBarInAMUWavenumbers\"", ",", " ", 
                          "\"Constants\""}], "]"}]}]}], ",", "\n", 
                          "\t\t\t\t", RowBox[{"\"Mass\"", "\[Rule]", "\n", 
                          "\t\t\t\t\t", RowBox[{"With", "[", "\n", 
                          "\t\t\t\t\t\t", RowBox[{RowBox[{"{", "\n", 
                          "\t\t\t\t\t\t\t", RowBox[{"hMass", "=", "\n", 
                          "\t\t\t\t\t\t\t\t", RowBox[{"QuantityMagnitude", 
                          "@", "\n", "\t\t\t\t\t\t\t\t\t", RowBox[
                          {"UnitConvert", "[", RowBox[{"d5DMass", ",", " ", 
                          "\"AtomicMassUnit\""}], "]"}]}]}], "\n", 
                          "\t\t\t\t\t\t\t", "}"}], ",", "\n", "\t\t\t\t\t\t", 
                          RowBox[{"{", "\n", "\t\t\t\t\t\t\t", RowBox[
                          {RowBox[{RowBox[{"(", RowBox[{"hMass", "*", "2", 
                          "*", "hMass"}], ")"}], "/", "\n", 
                          "\t\t\t\t\t\t\t\t", RowBox[{"(", RowBox[{"hMass", 
                          "+", RowBox[{"2", "*", RowBox[{"(", RowBox[{"2", 
                          "*", "hMass"}], ")"}]}]}], ")"}]}], ",", " ", "\n", 
                          "\t\t\t\t\t\t\t", RowBox[{"2", "*", "hMass"}]}], 
                          "\n", "\t\t\t\t\t\t\t", "}"}]}], "\n", 
                          "\t\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t\t", 
                          RowBox[{"\"ScalingFactor\"", "\[Rule]", "\n", 
                          "\t\t\t\t\t", RowBox[{"(", RowBox[{"1", "/", RowBox[
                          {RowBox[{"QuantityMagnitude", "@", RowBox[
                          {"UnitConvert", "[", RowBox[{"\"Angstroms\"", ",", 
                          " ", "\"Centimeters\""}], "]"}]}], "^", "2"}]}], 
                          ")"}]}]}], "\n", "\t\t\t\t", "}"}]}], ";"}], "\n", 
                    "\t\t", ")"}]}]], "CodeInput"]}, Open]], 
           Cell[CellGroupData[{Cell["\[LeftCeiling]$D5Settings\[RightFloor]", 
               "CodeSubsubsubsection", Evaluatable -> True], Cell[BoxData[
                RowBox[{RowBox[{"loadD5DVR", "[", "\"Settings\"", "]"}], 
                  ":=", "\n", "\t", RowBox[{"(", "\n", "\t\t", RowBox[
                     {RowBox[{"loadH5DVR", "[", "\"Region\"", "]"}], ";", 
                      "\n", "\t\t", RowBox[{"loadH5DVR", "[", "\"GridOps\"", 
                        "]"}], ";", "\n", "\t\t", RowBox[{"loadD5DVR", "[", 
                        "\"KEOps\"", "]"}], ";", "\n", "\t", "\t", RowBox[
                       {"loadH5DVR", "[", "\"PEOps\"", "]"}], ";", "\n", 
                      "\t\t", RowBox[{"loadH5DVR", "[", "\"RunOps\"", "]"}], 
                      ";", "\n", "\t\t", RowBox[{"loadH5DVR", "[", 
                        "\"PlotOps\"", "]"}], ";", "\n", "\t\t", RowBox[
                       {RowBox[{"$D5DVR", "[", "\"RuntimeOptions\"", "]"}], 
                        "=", "\n", "\t", "\t\t", RowBox[{"Flatten", "@", 
                          "\n", "\t", "\t\t", RowBox[{"{", "\n", "\t", 
                          "\t\t\t", RowBox[{RowBox[{"\"GridOptions\"", 
                          "\[Rule]", "\n", "\t", "\t", "\t\t\t", 
                          "h5GridOps"}], ",", "\n", "\t", "\t", "\t\t", 
                          RowBox[{"\"KineticEnergyOptions\"", "\[Rule]", 
                          "\n", "\t\t\t\t\t", "d5KEOps"}], ",", "\n", "\t", 
                          "\t", "\t\t", RowBox[{"\"PotentialEnergyOptions\"", 
                          "\[Rule]", "\n", "\t", "\t", "\t\t\t", "h5PEOps"}], 
                          ",", "\n", "\t", "\t", "\t\t", RowBox[
                          {"\"ViewOptions\"", "\[Rule]", "\n", "\t", "\t", 
                          "\t\t\t", "h5PlotOps"}], ",", "\n", "\t", "\t", 
                          "\t\t", "h5RunOps"}], "\n", "\t\t\t\t", "}"}]}]}], 
                      ";"}], "\n", "\t\t", ")"}]}]], "CodeInput"]}, Open]]}, 
          Open]]}, Open]], Cell[CellGroupData[
       {Cell["\[LeftCeiling]Single H2 Potential\[RightFloor] ", 
         "CodeSubsection", Evaluatable -> True], Cell["I\[CloseCurlyQuote]m \
gonna revise this under the suspicion that the optimization just \
didn\[CloseCurlyQuote]t do what it was supposed to...", "Text", 
         CellChangeTimes -> {3.745350497893303*^9}], 
        Cell[CellGroupData[{Cell["\[LeftCeiling]Bowtie\[RightFloor]", 
            "CodeSubsubsubsection", Evaluatable -> True], 
           Cell[BoxData[RowBox[{"(*", RowBox[{"NMinimize", "[", 
                 "\[IndentingNewLine]", RowBox[{RowBox[{"H5FullInterpPot", 
                     "[", RowBox[{"r", ",", " ", "r", ",", " ", "R", ",", 
                       " ", "R"}], "]"}], ",", "\[IndentingNewLine]", 
                   RowBox[{RowBox[{"{", RowBox[{"r", ",", " ", "R"}], "}"}], 
                     "\[Element]", RowBox[{"Apply", "[", RowBox[{"Cuboid", 
                         ",", " ", RowBox[{"Transpose", "@", RowBox[
                          {"H5FullInterpPot", "[", RowBox[{"[", RowBox[{"1", 
                          ",", " ", RowBox[{"{", RowBox[{"1", ",", " ", 
                          "3"}], "}"}]}], "]"}], "]"}]}]}], "]"}]}]}], 
                 "\[IndentingNewLine]", "]"}], "*)"}]], "CodeInput", 
            CellChangeTimes -> {{3.7453498296767197*^9, 
             3.7453498991564007*^9}}, CellLabel -> "In[59]:="], 
           Cell[BoxData[{RowBox[{RowBox[{"optR", "=", 
                  "1.0698239104916123`"}], ";"}], "\[IndentingNewLine]", 
              RowBox[{RowBox[{"optr", "=", "0.3977482275218416`"}], ";"}], 
              "\n", RowBox[{RowBox[{"With", "[", "\[IndentingNewLine]", 
                  RowBox[{RowBox[{"{", "\[IndentingNewLine]", RowBox[
                       {RowBox[{"potInterp", "=", "H5FullInterpPot"}], ",", 
                        "\[IndentingNewLine]", RowBox[{"eqR1", "=", "optR"}], 
                        ",", "\[IndentingNewLine]", RowBox[{"eqR2", "=", 
                          "optR"}], ",", "\[IndentingNewLine]", RowBox[
                         {"eqr2", "=", "optr"}]}], "\[IndentingNewLine]", 
                      "}"}], ",", "\[IndentingNewLine]", RowBox[
                     {"h2SinglePot", "=", "\[IndentingNewLine]", RowBox[
                       {"Compile", "[", RowBox[{RowBox[{"{", RowBox[{"{", 
                          RowBox[{"r1", ",", " ", "_Real"}], "}"}], "}"}], 
                          ",", "\[IndentingNewLine]", RowBox[{"potInterp", 
                          "[", RowBox[{"r1", ",", " ", "eqr2", ",", " ", 
                          "eqR1", ",", " ", "eqR2"}], "]"}], ",", 
                          "\[IndentingNewLine]", RowBox[{"RuntimeOptions", 
                          "\[Rule]", RowBox[{"{", "\[IndentingNewLine]", 
                          RowBox[{RowBox[{"\"EvaluateSymbolically\"", 
                          "\[Rule]", "False"}], ",", "\[IndentingNewLine]", 
                          RowBox[{"\"WarningMessages\"", "\[Rule]", 
                          "False"}]}], "\[IndentingNewLine]", "}"}]}]}], 
                        "\[IndentingNewLine]", "]"}]}]}], 
                  "\[IndentingNewLine]", "]"}], ";"}]}], "CodeInput"]}, 
          Open]], Cell[CellGroupData[{Cell["\[LeftCeiling]Old\[RightFloor]", 
            "CodeSubsubsubsection", Evaluatable -> True], 
           Cell[BoxData[{RowBox[{RowBox[{"optR", "=", 
                  "1.0698239104916123`"}], ";"}], "\[IndentingNewLine]", 
              RowBox[{RowBox[{"optr", "=", "0.3977482275218416`"}], ";"}], 
              "\n", RowBox[{RowBox[{"With", "[", "\[IndentingNewLine]", 
                  RowBox[{RowBox[{"{", "\[IndentingNewLine]", RowBox[
                       {RowBox[{"potInterp", "=", "$H5OldInterpPot"}], ",", 
                        "\[IndentingNewLine]", RowBox[{"eqR1", "=", "optR"}], 
                        ",", "\[IndentingNewLine]", RowBox[{"eqR2", "=", 
                          "optR"}], ",", "\[IndentingNewLine]", RowBox[
                         {"eqr2", "=", "optr"}]}], "\[IndentingNewLine]", 
                      "}"}], ",", "\[IndentingNewLine]", RowBox[
                     {"h2OldSinglePot", "=", "\[IndentingNewLine]", 
                      RowBox[{"Compile", "[", RowBox[{RowBox[{"{", RowBox[
                          {"{", RowBox[{"r1", ",", " ", "_Real"}], "}"}], 
                          "}"}], ",", "\[IndentingNewLine]", RowBox[
                          {"potInterp", "[", RowBox[{"r1", ",", " ", "eqr2", 
                          ",", " ", "eqR1", ",", " ", "eqR2"}], "]"}], ",", 
                          "\[IndentingNewLine]", RowBox[{"RuntimeOptions", 
                          "\[Rule]", RowBox[{"{", "\[IndentingNewLine]", 
                          RowBox[{RowBox[{"\"EvaluateSymbolically\"", 
                          "\[Rule]", "False"}], ",", "\[IndentingNewLine]", 
                          RowBox[{"\"WarningMessages\"", "\[Rule]", 
                          "False"}]}], "\[IndentingNewLine]", "}"}]}]}], 
                        "\[IndentingNewLine]", "]"}]}]}], 
                  "\[IndentingNewLine]", "]"}], ";"}]}], "CodeInput"]}, 
          Open]], Cell[CellGroupData[
          {Cell["\[LeftCeiling]Parallel\[RightFloor]", 
            "CodeSubsubsubsection", Evaluatable -> True], 
           Cell[BoxData[{RowBox[{RowBox[{"optR", "=", "1.071351775879906`"}], 
                ";"}], "\[IndentingNewLine]", RowBox[{RowBox[{"optr", "=", 
                  "0.39730604197629976`"}], ";"}], "\n", RowBox[{
                RowBox[{"With", "[", "\[IndentingNewLine]", RowBox[
                   {RowBox[{"{", "\[IndentingNewLine]", RowBox[{RowBox[
                         {"potInterp", "=", "$H5ParallelFullInterpPot"}], 
                        ",", "\[IndentingNewLine]", RowBox[{"eqR1", "=", 
                          "optR"}], ",", "\[IndentingNewLine]", RowBox[
                         {"eqR2", "=", "optR"}], ",", "\[IndentingNewLine]", 
                        RowBox[{"eqr2", "=", "optr"}]}], 
                      "\[IndentingNewLine]", "}"}], ",", 
                    "\[IndentingNewLine]", RowBox[{"h2ParallelSinglePot", 
                      "=", "\[IndentingNewLine]", RowBox[{"Compile", "[", 
                        RowBox[{RowBox[{"{", RowBox[{"{", RowBox[{"r1", ",", 
                          " ", "_Real"}], "}"}], "}"}], ",", 
                          "\[IndentingNewLine]", RowBox[{"potInterp", "[", 
                          RowBox[{"r1", ",", " ", "eqr2", ",", " ", "eqR1", 
                          ",", " ", "eqR2"}], "]"}], ",", 
                          "\[IndentingNewLine]", RowBox[{"RuntimeOptions", 
                          "\[Rule]", RowBox[{"{", "\[IndentingNewLine]", 
                          RowBox[{RowBox[{"\"EvaluateSymbolically\"", 
                          "\[Rule]", "False"}], ",", "\[IndentingNewLine]", 
                          RowBox[{"\"WarningMessages\"", "\[Rule]", 
                          "False"}]}], "\[IndentingNewLine]", "}"}]}]}], 
                        "\[IndentingNewLine]", "]"}]}]}], 
                  "\[IndentingNewLine]", "]"}], ";"}]}], "CodeInput"]}, 
          Open]]}, Closed]], Cell[CellGroupData[
       {Cell["\[LeftCeiling]Outer H2 Potential\[RightFloor]", 
         "CodeSubsection", Evaluatable -> True, CellChangeTimes -> 
          {{3.745351827134329*^9, 3.745351829661446*^9}}], 
        Cell[CellGroupData[{Cell["\[LeftCeiling]Eq Pot\[RightFloor]", 
            "CodeSubsubsection", Evaluatable -> True, CellChangeTimes -> 
             {{3.745351835117301*^9, 3.745351855203668*^9}}], 
           Cell[BoxData[RowBox[{RowBox[{"With", "[", "\[IndentingNewLine]", 
                 RowBox[{RowBox[{"{", "\[IndentingNewLine]", RowBox[
                      {RowBox[{"potInterp", "=", "H5FullInterpPot"}], ",", 
                       "\[IndentingNewLine]", RowBox[{"dom", "=", RowBox[
                          {"H5FullInterpPot", "[", RowBox[{"[", "1", "]"}], 
                          "]"}]}], ",", "\[IndentingNewLine]", RowBox[
                        {"eqR1", "=", "1.068237"}], ",", 
                       "\[IndentingNewLine]", RowBox[{"eqR2", "=", 
                         "1.068237"}], ",", "\[IndentingNewLine]", RowBox[
                        {"h2Min", "=", RowBox[{"-", 
                          "461.45688769022894`"}]}]}], "\[IndentingNewLine]", 
                     "}"}], ",", "\[IndentingNewLine]", RowBox[
                    {RowBox[{"h2Pot", "=", "\[IndentingNewLine]", RowBox[
                        {"Compile", "[", RowBox[{RowBox[{"{", RowBox[{"{", 
                          RowBox[{"r1r2", ",", "_Real", ",", "1"}], "}"}], 
                          "}"}], ",", "\[IndentingNewLine]", RowBox[{"With", 
                          "[", "\[IndentingNewLine]", RowBox[{RowBox[{"{", 
                          "\[IndentingNewLine]", RowBox[{RowBox[{"r1", "=", 
                          RowBox[{"r1r2", "[", RowBox[{"[", "1", "]"}], 
                          "]"}]}], ",", "\[IndentingNewLine]", RowBox[{"r2", 
                          "=", RowBox[{"r1r2", "[", RowBox[{"[", "2", "]"}], 
                          "]"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
                          "\[IndentingNewLine]", RowBox[{"potInterp", "[", 
                          RowBox[{"r1", ",", " ", "r2", ",", " ", "eqR1", 
                          ",", " ", "eqR2"}], "]"}]}], "\[IndentingNewLine]", 
                          "]"}], ",", "\[IndentingNewLine]", RowBox[
                          {"RuntimeOptions", "\[Rule]", RowBox[{"{", 
                          "\[IndentingNewLine]", RowBox[{RowBox[
                          {"\"EvaluateSymbolically\"", "\[Rule]", "False"}], 
                          ",", "\[IndentingNewLine]", RowBox[
                          {"\"WarningMessages\"", "\[Rule]", "False"}]}], 
                          "\[IndentingNewLine]", "}"}]}], ",", 
                          "\[IndentingNewLine]", RowBox[{"RuntimeAttributes", 
                          "\[Rule]", RowBox[{"{", "Listable", "}"}]}]}], 
                         "\[IndentingNewLine]", "]"}]}], ";", 
                     "\[IndentingNewLine]", RowBox[{"h2PotZPE", "=", 
                       "\[IndentingNewLine]", RowBox[{"Compile", "[", 
                         RowBox[{RowBox[{"{", RowBox[{"{", RowBox[{"r1r2", 
                          ",", "_Real", ",", "1"}], "}"}], "}"}], ",", 
                          "\[IndentingNewLine]", RowBox[{"With", "[", 
                          "\[IndentingNewLine]", RowBox[{RowBox[{"{", 
                          "\[IndentingNewLine]", RowBox[{RowBox[{"r1", "=", 
                          RowBox[{"r1r2", "[", RowBox[{"[", "1", "]"}], 
                          "]"}]}], ",", "\[IndentingNewLine]", RowBox[{"r2", 
                          "=", RowBox[{"r1r2", "[", RowBox[{"[", "2", "]"}], 
                          "]"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
                          "\[IndentingNewLine]", RowBox[{RowBox[{"potInterp", 
                          "[", RowBox[{"r1", ",", " ", "r2", ",", " ", 
                          "eqR1", ",", " ", "eqR2"}], "]"}], "-", 
                          "h2Min"}]}], "\[IndentingNewLine]", "]"}], ",", 
                          "\[IndentingNewLine]", RowBox[{"RuntimeOptions", 
                          "\[Rule]", RowBox[{"{", "\[IndentingNewLine]", 
                          RowBox[{RowBox[{"\"EvaluateSymbolically\"", 
                          "\[Rule]", "False"}], ",", "\[IndentingNewLine]", 
                          RowBox[{"\"WarningMessages\"", "\[Rule]", 
                          "False"}]}], "\[IndentingNewLine]", "}"}]}], ",", 
                          "\[IndentingNewLine]", RowBox[{"RuntimeAttributes", 
                          "\[Rule]", RowBox[{"{", "Listable", "}"}]}]}], 
                         "\[IndentingNewLine]", "]"}]}], ";", 
                     "\[IndentingNewLine]", RowBox[{"h2PotVec", "=", 
                       "\[IndentingNewLine]", RowBox[{"Quiet", "@", 
                         "\[IndentingNewLine]", RowBox[{"Compile", "[", 
                          RowBox[{RowBox[{"{", RowBox[{"{", RowBox[{"r1r2", 
                          ",", "_Real", ",", "2"}], "}"}], "}"}], ",", 
                          "\[IndentingNewLine]", RowBox[{"With", "[", 
                          "\[IndentingNewLine]", RowBox[{RowBox[{"{", 
                          "\[IndentingNewLine]", RowBox[{"pts", "=", RowBox[
                          {"Transpose", "@", RowBox[{"Map", "[", RowBox[
                          {RowBox[{RowBox[{"Join", "[", RowBox[{"#", ",", 
                          " ", RowBox[{"{", RowBox[{"eqR1", ",", " ", 
                          "eqR2"}], "}"}]}], "]"}], "&"}], ",", " ", 
                          "r1r2"}], "]"}]}]}], "\[IndentingNewLine]", "}"}], 
                          ",", "\[IndentingNewLine]", RowBox[{"potInterp", 
                          "@@", "pts"}]}], "\[IndentingNewLine]", "]"}], ",", 
                          "\[IndentingNewLine]", RowBox[{"RuntimeOptions", 
                          "\[Rule]", RowBox[{"{", "\[IndentingNewLine]", 
                          RowBox[{RowBox[{"\"EvaluateSymbolically\"", 
                          "\[Rule]", "False"}], ",", "\[IndentingNewLine]", 
                          RowBox[{"\"WarningMessages\"", "\[Rule]", 
                          "False"}]}], "\[IndentingNewLine]", "}"}]}], ",", 
                          "\[IndentingNewLine]", RowBox[{"RuntimeAttributes", 
                          "\[Rule]", RowBox[{"{", "Listable", "}"}]}]}], 
                          "\[IndentingNewLine]", "]"}]}]}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]], "CodeInput", 
            CellChangeTimes -> {{3.71898595332425*^9, 3.718985954653866*^9}, 
              {3.718986453707152*^9, 3.718986505656639*^9}, 
              {3.718986748570127*^9, 3.718986776569251*^9}, 
              {3.718986865458518*^9, 3.718986869197587*^9}, 
              {3.7189869518361397*^9, 3.718986996427919*^9}, 
              {3.718987081282783*^9, 3.718987082842082*^9}, 
              {3.719010443752091*^9, 3.719010445999837*^9}, 
              {3.719010535313622*^9, 3.719010609741905*^9}, 
              {3.7190107791401443*^9, 3.719010780651219*^9}, 
              {3.71901525732649*^9, 3.719015324854809*^9}, 
              {3.719018307882094*^9, 3.7190183102471437*^9}, 
              3.724597800997026*^9, {3.724792435360505*^9, 
              3.724792469807417*^9}, {3.724792503252654*^9, 
              3.72479250346132*^9}, {3.724801365676499*^9, 
              3.724801386961011*^9}, {3.724801627194899*^9, 
              3.724801628603972*^9}, 3.727047230595763*^9, 
              {3.727047455422152*^9, 3.727047486447163*^9}, 
              {3.727047561325885*^9, 3.7270476275709877*^9}, 
              {3.727047659578678*^9, 3.7270477668485327*^9}, 
              {3.7270478391317177*^9, 3.7270478598068867*^9}, 
              {3.734891896904356*^9, 3.7348919014524717*^9}, 
              {3.734891941812386*^9, 3.7348919425567703*^9}, 
              {3.735077276524646*^9, 3.73507728166455*^9}, 
              {3.735077373692986*^9, 3.735077512219592*^9}, 
              {3.7350811150253067*^9, 3.735081173006336*^9}, 
              3.7352602586780663*^9, {3.735262583286181*^9, 
              3.735262637403982*^9}, {3.7421775838374977*^9, 
              3.742177698534358*^9}, {3.7422697948833313*^9, 
              3.742269825002206*^9}, {3.742485886398896*^9, 
              3.7424858890378428*^9}, {3.74248632689432*^9, 
              3.742486333083226*^9}, {3.7424863755654182*^9, 
              3.742486405529387*^9}}, CellLabel -> "In[63]:="], 
           Cell[BoxData[RowBox[{"(*", RowBox[{"Quiet", "@", RowBox[
                  {"NMinimize", "[", RowBox[{RowBox[{"h2Pot", "[", RowBox[
                        {"{", RowBox[{"x", ",", " ", "y"}], "}"}], "]"}], 
                     ",", " ", RowBox[{RowBox[{"{", RowBox[{"x", ",", " ", 
                          "y"}], "}"}], "\[Element]", RowBox[{"Rectangle", 
                         "[", RowBox[{RowBox[{"{", RowBox[{".256", ",", " ", 
                          ".256"}], "}"}], ",", " ", RowBox[{"{", RowBox[
                          {"2", ",", " ", "2"}], "}"}]}], "]"}]}]}], "]"}]}], 
               "*)"}]], "CodeInput", CellChangeTimes -> 
             {{3.742177466771596*^9, 3.742177552229095*^9}, 
              {3.742486062990065*^9, 3.74248606938078*^9}, 
              3.742486435926303*^9}, CellLabel -> "In[64]:="], 
           Cell[BoxData[RowBox[{"(*", RowBox[{"Quiet", "@", RowBox[
                  {"NMinimize", "[", RowBox[{RowBox[{"h2PotZPE", "[", 
                       RowBox[{"{", RowBox[{"x", ",", " ", "y"}], "}"}], 
                       "]"}], ",", " ", RowBox[{RowBox[{"{", RowBox[{"x", 
                          ",", " ", "y"}], "}"}], "\[Element]", RowBox[
                        {"Rectangle", "[", RowBox[{RowBox[{"{", RowBox[
                          {".256", ",", " ", ".256"}], "}"}], ",", " ", 
                          RowBox[{"{", RowBox[{"2", ",", " ", "2"}], "}"}]}], 
                         "]"}]}]}], "]"}]}], "*)"}]], "CodeInput", 
            CellChangeTimes -> {{3.742177466771596*^9, 3.742177552229095*^9}, 
             {3.742486062990065*^9, 3.74248606938078*^9}, 
             {3.742486433390294*^9, 3.742486434083853*^9}}, 
            CellLabel -> "In[65]:="]}, Closed]], 
        Cell[CellGroupData[{Cell["\[LeftCeiling]Multi Pot\[RightFloor]", 
            "CodeSubsubsection", Evaluatable -> True, CellChangeTimes -> 
             {{3.745351857532864*^9, 3.74535186694881*^9}}], 
           Cell[BoxData[{RowBox[{RowBox[{"h2Pots", "=", RowBox[{"<|", 
                    "|>"}]}], ";"}], "\[IndentingNewLine]", 
              RowBox[{RowBox[{"h2PotVecs", "=", RowBox[{"<|", "|>"}]}], 
                ";"}], "\[IndentingNewLine]", RowBox[{RowBox[{"With", "[", 
                  "\[IndentingNewLine]", RowBox[{RowBox[{"{", 
                      "\[IndentingNewLine]", RowBox[{RowBox[{"potInterp", 
                          "=", "H5FullInterpPot"}], ",", 
                        "\[IndentingNewLine]", RowBox[{"dom", "=", RowBox[
                          {"H5FullInterpPot", "[", RowBox[{"[", "1", "]"}], 
                          "]"}]}], ",", "\[IndentingNewLine]", RowBox[
                         {"eqR2", "=", "1.510716"}]}], "\[IndentingNewLine]", 
                      "}"}], ",", "\[IndentingNewLine]", RowBox[{"Map", "[", 
                      "\[IndentingNewLine]", RowBox[{RowBox[{RowBox[{"With", 
                          "[", RowBox[{RowBox[{"{", RowBox[{"bigR1", "=", 
                          "#"}], "}"}], ",", "\[IndentingNewLine]", RowBox[
                          {RowBox[{RowBox[{"h2Pots", "[", RowBox[{"{", RowBox[
                          {"bigR1", ",", " ", "eqR2"}], "}"}], "]"}], ":=", 
                          "\[IndentingNewLine]", RowBox[{RowBox[{"h2Pots", 
                          "[", RowBox[{"{", RowBox[{"bigR1", ",", " ", 
                          "eqR2"}], "}"}], "]"}], "=", "\[IndentingNewLine]", 
                          RowBox[{"Compile", "[", RowBox[{RowBox[{"{", RowBox[
                          {"{", RowBox[{"r1r2", ",", "_Real", ",", "1"}], 
                          "}"}], "}"}], ",", "\[IndentingNewLine]", RowBox[
                          {"With", "[", "\[IndentingNewLine]", RowBox[{RowBox[
                          {"{", "\[IndentingNewLine]", RowBox[{RowBox[{"r1", 
                          "=", RowBox[{"r1r2", "[", RowBox[{"[", "1", "]"}], 
                          "]"}]}], ",", "\[IndentingNewLine]", RowBox[{"r2", 
                          "=", RowBox[{"r1r2", "[", RowBox[{"[", "2", "]"}], 
                          "]"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
                          "\[IndentingNewLine]", RowBox[{"potInterp", "[", 
                          RowBox[{"r1", ",", " ", "r2", ",", " ", "bigR1", 
                          ",", " ", "eqR2"}], "]"}]}], "\[IndentingNewLine]", 
                          "]"}], ",", "\[IndentingNewLine]", RowBox[
                          {"RuntimeOptions", "\[Rule]", RowBox[{"{", 
                          "\[IndentingNewLine]", RowBox[{RowBox[{
                          "\"EvaluateSymbolically\"", "\[Rule]", "False"}], 
                          ",", "\[IndentingNewLine]", RowBox[{
                          "\"WarningMessages\"", "\[Rule]", "False"}]}], 
                          "\[IndentingNewLine]", "}"}]}], ",", 
                          "\[IndentingNewLine]", RowBox[{"RuntimeAttributes", 
                          "\[Rule]", RowBox[{"{", "Listable", "}"}]}]}], 
                          "\[IndentingNewLine]", "]"}]}]}], ";", 
                          "\[IndentingNewLine]", RowBox[{RowBox[{"h2PotVecs", 
                          "[", RowBox[{"{", RowBox[{"bigR1", ",", " ", 
                          "eqR2"}], "}"}], "]"}], ":=", 
                          "\[IndentingNewLine]", RowBox[{RowBox[{"h2PotVecs", 
                          "[", RowBox[{"{", RowBox[{"bigR1", ",", " ", 
                          "eqR2"}], "}"}], "]"}], "=", "\[IndentingNewLine]", 
                          RowBox[{"Quiet", "@", "\[IndentingNewLine]", RowBox[
                          {"Compile", "[", RowBox[{RowBox[{"{", RowBox[{"{", 
                          RowBox[{"r1r2", ",", "_Real", ",", "2"}], "}"}], 
                          "}"}], ",", "\[IndentingNewLine]", RowBox[{"With", 
                          "[", "\[IndentingNewLine]", RowBox[{RowBox[{"{", 
                          "\[IndentingNewLine]", RowBox[{"pts", "=", RowBox[
                          {"Transpose", "@", RowBox[{"Map", "[", RowBox[
                          {RowBox[{RowBox[{"Join", "[", RowBox[{"#", ",", 
                          " ", RowBox[{"{", RowBox[{"bigR1", ",", " ", 
                          "eqR2"}], "}"}]}], "]"}], "&"}], ",", " ", 
                          "r1r2"}], "]"}]}]}], "\[IndentingNewLine]", "}"}], 
                          ",", "\[IndentingNewLine]", RowBox[{"potInterp", 
                          "@@", "pts"}]}], "\[IndentingNewLine]", "]"}], ",", 
                          "\[IndentingNewLine]", RowBox[{"RuntimeOptions", 
                          "\[Rule]", RowBox[{"{", "\[IndentingNewLine]", 
                          RowBox[{RowBox[{"\"EvaluateSymbolically\"", 
                          "\[Rule]", "False"}], ",", "\[IndentingNewLine]", 
                          RowBox[{"\"WarningMessages\"", "\[Rule]", 
                          "False"}]}], "\[IndentingNewLine]", "}"}]}], ",", 
                          "\[IndentingNewLine]", RowBox[{"RuntimeAttributes", 
                          "\[Rule]", RowBox[{"{", "Listable", "}"}]}]}], 
                          "\[IndentingNewLine]", "]"}]}]}]}], ";"}]}], 
                          "\[IndentingNewLine]", "]"}], "&"}], ",", 
                        "\[IndentingNewLine]", RowBox[{"Range", "[", RowBox[
                          {"1.510716", ",", " ", "3.26716", ",", " ", 
                          ".25"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
                  "\[IndentingNewLine]", "]"}], ";"}]}], "CodeInput", 
            CellChangeTimes -> {{3.71898595332425*^9, 3.718985954653866*^9}, 
              {3.718986453707152*^9, 3.718986505656639*^9}, 
              {3.718986748570127*^9, 3.718986776569251*^9}, 
              {3.718986865458518*^9, 3.718986869197587*^9}, 
              {3.7189869518361397*^9, 3.718986996427919*^9}, 
              {3.718987081282783*^9, 3.718987082842082*^9}, 
              {3.719010443752091*^9, 3.719010445999837*^9}, 
              {3.719010535313622*^9, 3.719010609741905*^9}, 
              {3.7190107791401443*^9, 3.719010780651219*^9}, 
              {3.71901525732649*^9, 3.719015324854809*^9}, 
              {3.719018307882094*^9, 3.7190183102471437*^9}, 
              3.724597800997026*^9, {3.724792435360505*^9, 
              3.724792469807417*^9}, {3.724792503252654*^9, 
              3.72479250346132*^9}, {3.724801365676499*^9, 
              3.724801386961011*^9}, {3.724801627194899*^9, 
              3.724801628603972*^9}, 3.727047230595763*^9, 
              {3.727047455422152*^9, 3.727047486447163*^9}, 
              {3.727047561325885*^9, 3.7270476275709877*^9}, 
              {3.727047659578678*^9, 3.7270477668485327*^9}, 
              {3.7270478391317177*^9, 3.7270478598068867*^9}, 
              {3.734891896904356*^9, 3.7348919014524717*^9}, 
              {3.734891941812386*^9, 3.7348919425567703*^9}, 
              {3.735077276524646*^9, 3.73507728166455*^9}, 
              {3.735077373692986*^9, 3.735077512219592*^9}, 
              {3.7350811150253067*^9, 3.735081173006336*^9}, 
              3.7352602586780663*^9, {3.735262583286181*^9, 
              3.735262637403982*^9}, {3.7359527915866833*^9, 
              3.735952793160161*^9}, {3.73595282567318*^9, 
              3.735952947574811*^9}, {3.735954427505391*^9, 
              3.735954431615559*^9}, {3.742244778510229*^9, 
              3.742244816132269*^9}}, CellLabel -> "In[66]:="]}, Closed]]}, 
       Closed]], Cell[CellGroupData[
       {Cell["\[LeftCeiling]$H2DVR\[RightFloor]", "CodeSubsection", 
         Evaluatable -> True, CellChangeTimes -> {{3.745352250020136*^9, 
          3.745352252586006*^9}}], 
        Cell[BoxData[{RowBox[{RowBox[{RowBox[{"loadH2DVR", "[", "]"}], ":=", 
               "\n", "\t", RowBox[{"(", "\n", "\t\t", RowBox[
                  {RowBox[{"loadH2DVR", "[", "\"DVR\"", "]"}], ";", "\n", 
                   "\t\t", RowBox[{"loadH2DVR", "[", "\"Pot\"", "]"}], ";", 
                   "\n", "\t\t", RowBox[{"loadH2DVR", "[", "\"Settings\"", 
                     "]"}], ";", "\n", "\t\t", "$H2DVR"}], "\n", "\t\t", 
                 ")"}]}], ";"}], "\n", RowBox[{RowBox[{"If", "[", RowBox[
                {RowBox[{"!", RowBox[{"MatchQ", "[", RowBox[{RowBox[
                        {"OwnValues", "[", "$H2DVR", "]"}], ",", " ", 
                       RowBox[{"{", RowBox[{"_", "\[RuleDelayed]", 
                          "_ChemDVRObject"}], "}"}]}], "]"}]}], ",", "\n", 
                 "\t", RowBox[{"$H2DVR", ":=", RowBox[{"loadH2DVR", "[", 
                     "]"}]}]}], "\n", "\t", "]"}], ";"}]}], "CodeInput"], 
        Cell[CellGroupData[{Cell["\[LeftCeiling]DVR\[RightFloor]", 
            "CodeSubsubsection", Evaluatable -> True, CellChangeTimes -> 
             {{3.745352258067923*^9, 3.7453522584259863*^9}}], 
           Cell[BoxData[RowBox[{RowBox[{RowBox[{"loadH2DVR", "[", "\"DVR\"", 
                   "]"}], ":=", "\n", "\t", RowBox[{"$H2DVR", "=", 
                   RowBox[{"ChemDVRObject", "[", "\"Cartesian2DDVR\"", 
                     "]"}]}]}], ";"}]], "CodeInput"]}, Open]], 
        Cell[CellGroupData[{Cell["\[LeftCeiling]Ops\[RightFloor]", 
            "CodeSubsubsection", Evaluatable -> True], 
           Cell[CellGroupData[{Cell["\[LeftCeiling]Region\[RightFloor]", 
               "CodeSubsubsubsection", Evaluatable -> True], Cell[BoxData[
                RowBox[{RowBox[{RowBox[{"loadH2DVR", "[", "\"Region\"", 
                      "]"}], ":=", "\n", "\t", RowBox[{"h2Reg", "=", "\n", 
                      "\t\t", RowBox[{"Region", "@", "\n", "\t\t\t", 
                        RowBox[{"Apply", "[", RowBox[{"Rectangle", ",", " ", 
                          "\n", "\t\t\t\t", RowBox[{"{", "\n", "\t\t\t\t\t", 
                          RowBox[{RowBox[{RowBox[{"getDomain", "[", RowBox[
                          {"H5FullInterpPot", ",", " ", "Automatic"}], "]"}], 
                          "[", RowBox[{"[", RowBox[{RowBox[{"{", RowBox[{"1", 
                          ",", " ", "2"}], "}"}], ",", " ", "1"}], "]"}], 
                          "]"}], ",", "\n", "\t\t\t\t\t", RowBox[{"{", RowBox[
                          {"1.", ",", " ", "1."}], "}"}]}], "\n", 
                          "\t\t\t\t\t", "}"}]}], "\n", "\t\t\t\t", 
                          "]"}]}]}]}], ";"}]], "CodeInput"]}, Open]], 
           Cell[CellGroupData[{Cell["\[LeftCeiling]Grid\[RightFloor]", 
               "CodeSubsubsubsection", Evaluatable -> True, 
               CellChangeTimes -> {{3.7348922864342737*^9, 
                3.734892286911202*^9}}], Cell[BoxData[RowBox[
                 {RowBox[{RowBox[{"loadH2DVR", "[", "\"GridOps\"", "]"}], 
                    ":=", "\n", "\t", RowBox[{"h2GridOps", "=", "\n", "\t\t", 
                      RowBox[{"{", "\n", "\t\t\t", RowBox[{RowBox[
                          {"\"Range\"", "\[Rule]", RowBox[{"RegionBounds", 
                          "[", "h2Reg", "]"}]}], ",", "\n", "\t", "\t", "\t", 
                          RowBox[{"\"Points\"", "\[Rule]", RowBox[{"{", 
                          RowBox[{"125", ",", " ", "125"}], "}"}]}]}], "\n", 
                        "\t\t\t", "}"}]}]}], ";"}]], "CodeInput"]}, Open]], 
           Cell[CellGroupData[{Cell["\[LeftCeiling]KE\[RightFloor]", 
               "CodeSubsubsubsection", Evaluatable -> True, 
               CellChangeTimes -> {{3.745351946969709*^9, 
                3.745351947112748*^9}}], Cell[BoxData[RowBox[
                 {RowBox[{"loadH2DVR", "[", "\"KEOps\"", "]"}], ":=", "\n", 
                  "\t", RowBox[{"(", "\n", "\t\t", RowBox[{RowBox[{"h5HMass", 
                        "=", "\n", "\t\t\t", RowBox[{"ChemDataLookup", "[", 
                          RowBox[{"\"H\"", ",", " ", "\"NISTMass\""}], 
                          "]"}]}], ";", "\n", "\t", RowBox[{"h2KEOps", "=", 
                        "\n", "\t\t", RowBox[{"{", "\n", "\t\t\t", RowBox[
                          {RowBox[{"\"HBar\"", "->", "\n", "\t\t\t\t", 
                          RowBox[{"QuantityMagnitude", "@", "\n", 
                          "\t\t\t\t\t\t", RowBox[{"ChemDataLookup", "[", 
                          RowBox[{"\"DVRHBarInAMUWavenumbers\"", ",", " ", 
                          "\"Constants\""}], "]"}]}]}], ",", "\n", "\t\t\t", 
                          RowBox[{"\"Mass\"", "\[Rule]", "\n", "\t\t\t\t", 
                          RowBox[{"2", "*", RowBox[{"QuantityMagnitude", "@", 
                          RowBox[{"(", "h5HMass", ")"}]}]}]}], ",", "\n", 
                          "\t\t\t", RowBox[{"\"ScalingFactor\"", "\[Rule]", 
                          "\n", "\t\t\t\t", RowBox[{"(", RowBox[{"1", "/", 
                          RowBox[{RowBox[{"QuantityMagnitude", "@", RowBox[
                          {"UnitConvert", "[", RowBox[{"\"Angstroms\"", ",", 
                          " ", "\"Centimeters\""}], "]"}]}], "^", "2"}]}], 
                          ")"}]}]}], "\n", "\t", "\t\t", "}"}]}], ";"}], 
                    "\n", "\t", ")"}]}]], "CodeInput"]}, Open]], 
           Cell[CellGroupData[{Cell["\[LeftCeiling]PE\[RightFloor]", 
               "CodeSubsubsubsection", Evaluatable -> True, 
               CellChangeTimes -> {{3.734892282801947*^9, 
                 3.734892283025955*^9}, 3.734901351564073*^9}], 
              Cell[BoxData[RowBox[{RowBox[{RowBox[{"loadH2DVR", "[", 
                      "\"PEOps\"", "]"}], ":=", "\n", "\t", RowBox[
                     {"h2PEOps", "=", "\n", "\t\t", RowBox[{"{", "\n", 
                        "\t\t\t", RowBox[{"\"PotentialFunction\"", "\[Rule]", 
                          "h2Pot"}], "\n", "\t", "\t", "\t", "}"}]}]}], 
                  ";"}]], "CodeInput"]}, Closed]], 
           Cell[CellGroupData[{Cell["\[LeftCeiling]PO\[RightFloor]", 
               "CodeSubsubsubsection", Evaluatable -> True, 
               CellChangeTimes -> {{3.742409477187831*^9, 
                3.7424094820520287*^9}}], Cell[BoxData[RowBox[
                 {RowBox[{RowBox[{"loadH2DVR", "[", "\"POOps\"", "]"}], ":=", 
                    "\n", "\t", RowBox[{"h2POOps", "=", "\n", "\t\t", 
                      RowBox[{"{", "\n", "\t\t\t", RowBox[{RowBox[
                          {"\"PotentialFunction\"", "\[Rule]", 
                          "h2SinglePot"}], ",", "\n", "\t", "\t", "\t", 
                          RowBox[{"\"OptimizedBasisSize\"", "\[Rule]", 
                          "25"}]}], "\n", "\t", "\t", "\t", "}"}]}]}], 
                  ";"}]], "CodeInput"]}, Closed]], 
           Cell[CellGroupData[{Cell["\[LeftCeiling]Plot\[RightFloor]", 
               "CodeSubsubsubsection", Evaluatable -> True, 
               CellChangeTimes -> {{3.745352383716373*^9, 
                3.745352384195854*^9}}], Cell[BoxData[RowBox[{"(*", "\n", 
                  "\n", RowBox[{"{", RowBox[{RowBox[{"-", 
                        "515.6441078856749`"}], ",", "62529.8885143045`"}], 
                    "}"}], "*)"}]], "CodeInput"], Cell[BoxData[
                RowBox[{RowBox[{"loadH2DVR", "[", "\"PlotOps\"", "]"}], ":=", 
                  "\n", RowBox[{"(", "\n", "\t", RowBox[{RowBox[{"If", "[", 
                        RowBox[{RowBox[{RowBox[{"Length", "@", RowBox[
                          {"OwnValues", "[", "h2PotMinMax", "]"}]}], 
                          "\[Equal]", "0"}], ",", "\n", "\t\t", RowBox[
                          {"h2PotMinMax", "=", "\n", "\t\t\t", RowBox[
                          {"Quiet", "@", RowBox[{"Map", "[", RowBox[{RowBox[
                          {RowBox[{"#", "[", RowBox[{RowBox[{"h2Pot", "[", 
                          RowBox[{"{", RowBox[{"x", ",", "y"}], "}"}], "]"}], 
                          ",", RowBox[{RowBox[{"{", RowBox[{"x", ",", "y"}], 
                          "}"}], "\[Element]", RowBox[{"RegionResize", "[", 
                          RowBox[{"h2Reg", ",", RowBox[{"Scaled", "[", ".95", 
                          "]"}]}], "]"}]}]}], "]"}], "&"}], ",", "\n", "\t", 
                          "\t", "\t", "\t", RowBox[{"{", "\n", "\t", "\t", 
                          "\t", "\t\t", RowBox[{"NMinValue", ",", "\n", "\t", 
                          "\t", "\t", "\t\t", "NMaxValue"}], "\n", "\t", 
                          "\t", "\t", "\t\t", "}"}]}], "\n", "\t\t\t\t", 
                          "]"}]}]}]}], "\n", "\t\t", "]"}], ";", "\n", "\t", 
                      RowBox[{"h2RegMemFunc", "=", "\n", "\t\t", RowBox[
                         {"RegionMember", "@", RowBox[{"RegionResize", "[", 
                          RowBox[{"h2Reg", ",", RowBox[{"Scaled", "[", ".95", 
                          "]"}]}], "]"}]}]}], ";", "\n", "\t", RowBox[
                       {"h2ColFun", "=", "\n", "\t", "\t", RowBox[{"With", 
                          "[", RowBox[{RowBox[{"{", "\n", "\t", "\t\t\t", 
                          RowBox[{RowBox[{"cf", "=", RowBox[{"ColorData", 
                          "[", "\"M10DefaultDensityGradient\"", "]"}]}], ",", 
                          "\n", "\t", "\t", "\t\t", RowBox[{"mm", "=", 
                          "h2PotMinMax"}], ",", "\n", "\t", "\t", "\t\t", 
                          RowBox[{"pot", "=", "h2Pot"}]}], "\n", "\t", "\t", 
                          "\t\t", "}"}], ",", "\n", "\t", "\t", "\t", RowBox[
                          {RowBox[{"cf", "[", RowBox[{"Rescale", "[", RowBox[
                          {RowBox[{"pot", "[", RowBox[{"{", RowBox[{"#", ",", 
                          "#2"}], "}"}], "]"}], ",", "mm", ",", RowBox[{"{", 
                          RowBox[{"0", ",", "1"}], "}"}]}], "]"}], "]"}], 
                          "&"}]}], "\n", "\t", "\t", "\t", "]"}]}], ";", 
                      "\n", "\t", RowBox[{"h2PlotOps", "=", "\n", "\t", "\t", 
                        RowBox[{"{", "\n", "\t", "\t\t", RowBox[{RowBox[
                          {"\"PotentialStyle\"", "\[Rule]", "None"}], ",", 
                          "\n", "\t", "\t", "\t", RowBox[{"\"ShowEnergy\"", 
                          "\[Rule]", "False"}], ",", "\n", "\t", "\t", "\t", 
                          RowBox[{"PlotRange", "\[Rule]", "All"}], ",", "\n", 
                          "\t", "\t", "\t", RowBox[{"RegionFunction", 
                          "\[Rule]", "h2RegMemFunc"}], ",", "\n", "\t", "\t", 
                          "\t", RowBox[{"ColorFunction", "\[Rule]", 
                          "h2ColFun"}], ",", "\n", "\t", "\t", "\t", RowBox[
                          {"ColorFunctionScaling", "\[Rule]", "False"}], ",", 
                          "\n", "\t", "\t", "\t", RowBox[{"Lighting", "->", 
                          "\"Neutral\""}], ",", "\n", "\t", "\t", "\t", 
                          RowBox[{"Manipulate", "\[Rule]", "False"}]}], "\n", 
                          "\t\t\t", "}"}]}], ";"}], "\n", "\t", ")"}]}]], 
               "CodeInput"]}, Closed]], Cell[CellGroupData[
             {Cell["\[LeftCeiling]Run\[RightFloor]", "CodeSubsubsubsection", 
               Evaluatable -> True, CellChangeTimes -> 
                {{3.734892518648984*^9, 3.7348925189658403*^9}}], 
              Cell[BoxData[RowBox[{RowBox[{RowBox[{"loadH2DVR", "[", 
                      "\"RunOps\"", "]"}], ":=", "\n", "\t", RowBox[
                     {"h2RunOps", "=", "\n", "\t\t", RowBox[{"{", "\n", 
                        "\t\t\t", RowBox[{RowBox[{"Monitor", "\[Rule]", 
                          "False"}], ",", "\n", "\t", "\t", "\t", RowBox[
                          {"\"SaveKineticEnergy\"", "\[Rule]", "False"}], 
                          ",", "\n", "\t", "\t", "\t", RowBox[
                          {"\"LoadKineticEnergy\"", "\[Rule]", "False"}]}], 
                        "\n", "\t", "\t", "\t", "}"}]}]}], ";"}]], 
               "CodeInput"]}, Closed]], Cell[CellGroupData[
             {Cell["\[LeftCeiling]$H2Settings\[RightFloor]", 
               "CodeSubsubsubsection", Evaluatable -> True, 
               CellChangeTimes -> {{3.73489180431931*^9, 
                 3.7348918090640173*^9}, 3.7350813102505293*^9}], 
              Cell[BoxData[RowBox[{RowBox[{"loadH2DVR", "[", "\"Settings\"", 
                    "]"}], ":=", "\n", RowBox[{"(", "\n", "\t", RowBox[
                     {RowBox[{"loadH2DVR", "[", "\"Region\"", "]"}], ";", 
                      "\n", "\t", RowBox[{"loadH2DVR", "[", "\"GridOps\"", 
                        "]"}], ";", "\n", "\t", RowBox[{"loadH2DVR", "[", 
                        "\"KEOps\"", "]"}], ";", "\n", "\t", RowBox[
                       {"loadH2DVR", "[", "\"PEOps\"", "]"}], ";", "\n", 
                      "\t", RowBox[{"loadH2DVR", "[", "\"POOps\"", "]"}], 
                      ";", "\n", "\t", RowBox[{"loadH2DVR", "[", 
                        "\"PlotOps\"", "]"}], ";", "\n", "\t", RowBox[
                       {"loadH2DVR", "[", "\"RunOps\"", "]"}], ";", "\n", 
                      "\t", RowBox[{RowBox[{"$H2DVR", "[", 
                          "\"RuntimeOptions\"", "]"}], "=", "\n", "\t", "\t", 
                        RowBox[{"Flatten", "@", "\n", "\t", "\t\t", RowBox[
                          {"{", "\n", "\t", "\t\t\t", RowBox[{RowBox[
                          {"\"GridOptions\"", "\[Rule]", "\n", "\t\t\t\t\t", 
                          "h2GridOps"}], ",", "\n", "\t\t\t\t", RowBox[
                          {"\"KineticEnergyOptions\"", "\[Rule]", "\n", 
                          "\t\t\t\t\t", "h2KEOps"}], ",", "\n", "\t\t\t\t", 
                          RowBox[{"\"PotentialEnergyOptions\"", "\[Rule]", 
                          "\n", "\t\t\t\t\t", "h2PEOps"}], ",", "\n", 
                          "\t\t\t\t", RowBox[{
                          "\"PotentialOptimizationOptions\"", "\[Rule]", 
                          "\n", "\t\t\t\t\t", "h2POOps"}], ",", "\n", 
                          "\t\t\t\t", RowBox[{"\"ViewOptions\"", "\[Rule]", 
                          "\n", "\t\t\t\t\t", "h2PlotOps"}], ",", "\n", 
                          "\t\t\t\t", "h2RunOps"}], "\n", "\t\t\t\t", 
                          "}"}]}]}], ";"}], "\n", "\t", ")"}]}]], 
               "CodeInput"]}, Open]]}, Open]]}, Open]], 
     Cell[CellGroupData[{Cell["\[LeftCeiling]$D2DVR\[RightFloor]", 
         "CodeSubsection", Evaluatable -> True], 
        Cell[BoxData[{RowBox[{RowBox[{RowBox[{"loadD2DVR", "[", "]"}], ":=", 
               "\n", "\t", RowBox[{"(", "\n", "\t\t", RowBox[
                  {RowBox[{"loadD2DVR", "[", "\"DVR\"", "]"}], ";", "\n", 
                   "\t\t", RowBox[{"loadH2DVR", "[", "\"Pot\"", "]"}], ";", 
                   "\n", "\t\t", RowBox[{"loadD2DVR", "[", "\"Settings\"", 
                     "]"}], ";", "\n", "\t\t", "$D2DVR"}], "\n", "\t\t", 
                 ")"}]}], ";"}], "\n", RowBox[{RowBox[{"If", "[", RowBox[
                {RowBox[{"!", RowBox[{"MatchQ", "[", RowBox[{RowBox[
                        {"OwnValues", "[", "$D2DVR", "]"}], ",", " ", 
                       RowBox[{"{", RowBox[{"_", "\[RuleDelayed]", 
                          "_ChemDVRObject"}], "}"}]}], "]"}]}], ",", "\n", 
                 "\t", RowBox[{"$D2DVR", ":=", RowBox[{"loadD2DVR", "[", 
                     "]"}]}]}], "\n", "\t", "]"}], ";"}]}], "CodeInput"], 
        Cell[CellGroupData[{Cell["\[LeftCeiling]DVR\[RightFloor]", 
            "CodeSubsubsection", Evaluatable -> True, CellChangeTimes -> 
             {{3.745352258067923*^9, 3.7453522584259863*^9}}], 
           Cell[BoxData[RowBox[{RowBox[{RowBox[{"loadD2DVR", "[", "\"DVR\"", 
                   "]"}], ":=", "\n", "\t", RowBox[{"$D2DVR", "=", 
                   RowBox[{"ChemDVRObject", "[", "\"Cartesian2DDVR\"", 
                     "]"}]}]}], ";"}]], "CodeInput"]}, Open]], 
        Cell[CellGroupData[{Cell["\[LeftCeiling]Ops\[RightFloor]", 
            "CodeSubsubsection", Evaluatable -> True, CellChangeTimes -> 
             {{3.7348920704194403*^9, 3.734892075314517*^9}, 
             {3.7348922603494787*^9, 3.734892260719327*^9}}], 
           Cell[CellGroupData[{Cell["\[LeftCeiling]KE\[RightFloor]", 
               "CodeSubsubsubsection", Evaluatable -> True, 
               CellChangeTimes -> {{3.745351946969709*^9, 
                3.745351947112748*^9}}], Cell[BoxData[RowBox[
                 {RowBox[{"loadD2DVR", "[", "\"KEOps\"", "]"}], ":=", "\n", 
                  "\t", RowBox[{"(", "\n", "\t\t", RowBox[{RowBox[{"d5DMass", 
                        "=", "\n", "\t\t\t", RowBox[{"ChemDataLookup", "[", 
                          RowBox[{"\"D\"", ",", " ", "\"NISTMass\""}], 
                          "]"}]}], ";", "\n", "\t", RowBox[{"d2KEOps", "=", 
                        "\n", "\t\t", RowBox[{"{", "\n", "\t\t\t", RowBox[
                          {RowBox[{"\"HBar\"", "->", "\n", "\t\t\t\t", 
                          RowBox[{"QuantityMagnitude", "@", "\n", 
                          "\t\t\t\t\t", RowBox[{"ChemDataLookup", "[", RowBox[
                          {"\"DVRHBarInAMUWavenumbers\"", ",", " ", 
                          "\"Constants\""}], "]"}]}]}], ",", "\n", "\t", 
                          "\t", "\t", RowBox[{"\"Mass\"", "\[Rule]", "\n", 
                          "\t\t\t\t", RowBox[{"2", "*", RowBox[
                          {"QuantityMagnitude", "@", RowBox[{"(", "d5DMass", 
                          ")"}]}]}]}], ",", "\n", "\t\t\t", RowBox[
                          {"\"ScalingFactor\"", "\[Rule]", "\n", "\t\t\t\t", 
                          RowBox[{"(", RowBox[{"1", "/", RowBox[{RowBox[
                          {"QuantityMagnitude", "@", RowBox[{"UnitConvert", 
                          "[", RowBox[{"\"Angstroms\"", ",", " ", 
                          "\"Centimeters\""}], "]"}]}], "^", "2"}]}], 
                          ")"}]}]}], "\n", "\t", "\t\t", "}"}]}], ";"}], 
                    "\n", "\t", ")"}]}]], "CodeInput"]}, Open]], 
           Cell[CellGroupData[{Cell["\[LeftCeiling]$D2Settings\[RightFloor]", 
               "CodeSubsubsubsection", Evaluatable -> True], Cell[BoxData[
                RowBox[{RowBox[{"loadD2DVR", "[", "\"Settings\"", "]"}], 
                  ":=", "\n", RowBox[{"(", "\n", "\t", RowBox[
                     {RowBox[{"loadH2DVR", "[", "\"Region\"", "]"}], ";", 
                      "\n", "\t", RowBox[{"loadH2DVR", "[", "\"GridOps\"", 
                        "]"}], ";", "\n", "\t", RowBox[{"loadD2DVR", "[", 
                        "\"KEOps\"", "]"}], ";", "\n", "\t", RowBox[
                       {"loadH2DVR", "[", "\"PEOps\"", "]"}], ";", "\n", 
                      "\t", RowBox[{"loadH2DVR", "[", "\"POOps\"", "]"}], 
                      ";", "\n", "\t", RowBox[{"loadH2DVR", "[", 
                        "\"PlotOps\"", "]"}], ";", "\n", "\t", RowBox[
                       {"loadH2DVR", "[", "\"RunOps\"", "]"}], ";", "\n", 
                      "\t", RowBox[{RowBox[{"$D2DVR", "[", 
                          "\"RuntimeOptions\"", "]"}], "=", "\n", "\t", "\t", 
                        RowBox[{"Flatten", "@", "\n", "\t", "\t\t", RowBox[
                          {"{", "\n", "\t", "\t\t\t", RowBox[{RowBox[
                          {"\"GridOptions\"", "\[Rule]", "\n", "\t\t\t\t\t", 
                          "h2GridOps"}], ",", "\n", "\t\t\t\t", RowBox[
                          {"\"KineticEnergyOptions\"", "\[Rule]", "\n", 
                          "\t\t\t\t\t", "d2KEOps"}], ",", "\n", "\t\t\t\t", 
                          RowBox[{"\"PotentialEnergyOptions\"", "\[Rule]", 
                          "\n", "\t\t\t\t\t", "h2PEOps"}], ",", "\n", 
                          "\t\t\t\t", RowBox[{
                          "\"PotentialOptimizationOptions\"", "\[Rule]", 
                          "\n", "\t\t\t\t\t", "h2POOps"}], ",", "\n", 
                          "\t\t\t\t", RowBox[{"\"ViewOptions\"", "\[Rule]", 
                          "\n", "\t\t\t\t\t", "h2PlotOps"}], ",", "\n", 
                          "\t\t\t\t", "h2RunOps"}], "\n", "\t\t\t\t", 
                          "}"}]}]}], ";"}], "\n", "\t", ")"}]}]], 
               "CodeInput"]}, Open]]}, Open]]}, Open]], 
     Cell[CellGroupData[{Cell["\[LeftCeiling]$H2SingleDVR\[RightFloor]", 
         "CodeSubsection", Evaluatable -> True], 
        Cell[BoxData[{RowBox[{RowBox[{RowBox[{"loadH2SDVR", "[", "]"}], ":=", 
               "\n", "\t", RowBox[{"(", "\n", "\t\t", RowBox[
                  {RowBox[{"loadH2SDVR", "[", "\"DVR\"", "]"}], ";", "\n", 
                   "\t\t", RowBox[{"loadH2SDVR", "[", "\"Pot\"", "]"}], ";", 
                   "\n", "\t\t", RowBox[{"loadH2SDVR", "[", "\"Settings\"", 
                     "]"}], ";", "\n", "\t\t", "$H2SingleDVR"}], "\n", 
                 "\t\t", ")"}]}], ";"}], "\n", 
           RowBox[{RowBox[{"If", "[", RowBox[{RowBox[{"!", RowBox[{"MatchQ", 
                     "[", RowBox[{RowBox[{"OwnValues", "[", "$H2SingleDVR", 
                         "]"}], ",", " ", RowBox[{"{", RowBox[{"_", 
                          "\[RuleDelayed]", "_ChemDVRObject"}], "}"}]}], 
                     "]"}]}], ",", "\n", "\t", RowBox[{"$H2SingleDVR", ":=", 
                   RowBox[{"loadH2SDVR", "[", "]"}]}]}], "\n", "\t", "]"}], 
             ";"}]}], "CodeInput"], Cell[CellGroupData[
          {Cell["\[LeftCeiling]DVR\[RightFloor]", "CodeSubsubsection", 
            Evaluatable -> True], Cell[BoxData[RowBox[{RowBox[
                {RowBox[{"loadH2SDVR", "[", "\"DVR\"", "]"}], ":=", "\n", 
                 "\t", RowBox[{"$H2SingleDVR", "=", RowBox[{"ChemDVRObject", 
                     "[", "\"Cartesian1DDVR\"", "]"}]}]}], ";"}]], 
            "CodeInput"]}, Closed]], Cell[CellGroupData[
          {Cell["\[LeftCeiling]Ops\[RightFloor]", "CodeSubsubsection", 
            Evaluatable -> True, CellChangeTimes -> {{3.7348920704194403*^9, 
             3.734892075314517*^9}, {3.7348922603494787*^9, 
             3.734892260719327*^9}}], Cell[BoxData[RowBox[
              {"<<", "ChemTools`Data`"}]], "CodeInput", CellChangeTimes -> 
             {{3.724625736341876*^9, 3.724625750428109*^9}, 
             {3.724791374399713*^9, 3.724791375714342*^9}, 
             {3.724796659364353*^9, 3.7247966665533943*^9}, 
             {3.7275718655476713*^9, 3.727571898968864*^9}, 
             {3.734892078989205*^9, 3.734892214051343*^9}, 
             {3.734892251045857*^9, 3.734892278574534*^9}}, 
            CellLabel -> "In[158]:="], Cell[CellGroupData[
             {Cell["\[LeftCeiling]Region\[RightFloor]", 
               "CodeSubsubsubsection", Evaluatable -> True, 
               CellChangeTimes -> {{3.7350812075663967*^9, 
                3.735081208364752*^9}}], Cell[BoxData[RowBox[
                 {RowBox[{RowBox[{"loadH2SDVR", "[", "\"Region\"", "]"}], 
                    ":=", "\n", "\t", RowBox[{"h2SingleReg", "=", "\n", 
                      "\t\t", RowBox[{"Region", "@", "\n", "\t\t\t", 
                        RowBox[{"Interval", "[", "\n", "\t\t\t\t", RowBox[
                          {"{", "\n", "\t\t\t\t\t", RowBox[{RowBox[{RowBox[
                          {"getDomain", "[", RowBox[{"H5FullInterpPot", ",", 
                          " ", "Automatic"}], "]"}], "[", RowBox[{"[", RowBox[
                          {"1", ",", " ", "1"}], "]"}], "]"}], ",", " ", 
                          "\n", "\t\t\t\t\t", "1"}], "\n", "\t\t\t\t\t", 
                          "}"}], "\n", "\t\t\t\t", "]"}]}]}]}], ";"}]], 
               "CodeInput"]}, Open]], Cell[CellGroupData[
             {Cell["\[LeftCeiling]Grid\[RightFloor]", "CodeSubsubsubsection", 
               Evaluatable -> True, CellChangeTimes -> 
                {{3.7348922864342737*^9, 3.734892286911202*^9}}], 
              Cell[BoxData[RowBox[{RowBox[{RowBox[{"loadH2SDVR", "[", 
                      "\"GridOps\"", "]"}], ":=", "\n", RowBox[
                     {"h2SingleGridOps", "=", "\n", "\t", RowBox[{"{", "\n", 
                        "\t\t", RowBox[{RowBox[{"\"Range\"", "\[Rule]", 
                          RowBox[{"RegionBounds", "[", "h2SingleReg", 
                          "]"}]}], ",", "\n", "\t", "\t", RowBox[
                          {"\"Points\"", "\[Rule]", "250"}]}], "\n", "\t", 
                        "\t", "}"}]}]}], ";"}]], "CodeInput"]}, Open]], 
           Cell[CellGroupData[{Cell["\[LeftCeiling]KE\[RightFloor]", 
               "CodeSubsubsubsection", Evaluatable -> True, 
               CellChangeTimes -> {{3.734892282801947*^9, 
                3.734892283025955*^9}}], Cell[BoxData[RowBox[
                 {RowBox[{"loadH2SDVR", "[", "\"KEOps\"", "]"}], ":=", "\n", 
                  RowBox[{"(", "\n", RowBox[{RowBox[{"h5HMass", "=", "\n", 
                        "\t", RowBox[{"UnitConvert", "[", "\n", "\t\t", 
                          RowBox[{RowBox[{"Quantity", "[", "\n", "\t", 
                          "\t\t", RowBox[{RowBox[{"2", "*", RowBox[
                          {"ChemTools`Data`RawDatasets`$ChemIsotopicMasses", 
                          "[", RowBox[{"1", ",", " ", "1", ",", " ", 
                          "\"Mass\""}], "]"}]}], ",", "\n", "\t", "\t\t", 
                          "\"AtomicMassUnit\""}], "\n", "\t", "\t\t", "]"}], 
                          ",", "\n", "\t", "\t", "\"Kilograms\""}], "\n", 
                          "\t", "\t", "]"}]}], ";", "\n", RowBox[
                       {"h2SingleKEOps", "=", "\n", "\t", RowBox[{"{", "\n", 
                          "\t\t", RowBox[{RowBox[{"\"HBar\"", "->", "\n", 
                          "\t\t\t", RowBox[{"QuantityMagnitude", "@", "\n", 
                          "\t\t\t\t", RowBox[{"UnitConvert", "[", "\n", "\t", 
                          "\t\t\t\t", RowBox[{RowBox[{RowBox[{"Quantity", 
                          "[", "\"ReducedPlanckConstant\"", "]"}], "/", "\n", 
                          "\t\t\t\t\t\t", RowBox[{"Sqrt", "[", RowBox[
                          {"Quantity", "[", RowBox[{"\"PlanckConstant\"", 
                          "*", "\"SpeedOfLight\""}], "]"}], "]"}]}], ",", 
                          "\n", "\t", "\t", "\t", "\t\t", RowBox[{RowBox[
                          {"Sqrt", "[", "\"Kilograms\"", "]"}], "*", RowBox[
                          {"Sqrt", "[", "\"Centimeters\"", "]"}]}]}], "\n", 
                          "\t", "\t\t\t\t", "]"}]}]}], ",", "\n", "\t", "\t", 
                          RowBox[{"\"Mass\"", "\[Rule]", "\n", "\t\t\t", 
                          RowBox[{"QuantityMagnitude", "@", "h5HMass"}]}], 
                          ",", "\n", "\t", "\t", RowBox[{"\"ScalingFactor\"", 
                          "\[Rule]", "\n", "\t\t\t", RowBox[{"(", RowBox[
                          {"1", "/", RowBox[{RowBox[{"QuantityMagnitude", 
                          "@", RowBox[{"UnitConvert", "[", RowBox[
                          {"\"Angstroms\"", ",", " ", "\"Centimeters\""}], 
                          "]"}]}], "^", "2"}]}], ")"}]}]}], "\n", "\t\t", 
                          "}"}]}], ";"}], "\n", ")"}]}]], "CodeInput"]}, 
             Closed]], Cell[CellGroupData[
             {Cell["\[LeftCeiling]PE\[RightFloor]", "CodeSubsubsubsection", 
               Evaluatable -> True, CellChangeTimes -> 
                {{3.734892282801947*^9, 3.734892283025955*^9}, 
                 3.734901351564073*^9}], Cell[BoxData[RowBox[
                 {RowBox[{RowBox[{"loadH2SDVR", "[", "\"PEOps\"", "]"}], 
                    ":=", "\n", RowBox[{"h2SinglePEOps", "=", "\n", "\t", 
                      RowBox[{"{", "\n", "\t\t", RowBox[
                         {"\"PotentialFunction\"", "\[Rule]", 
                          "h2SinglePot"}], "\n", "\t", "\t", "}"}]}]}], 
                  ";"}]], "CodeInput"]}, Closed]], 
           Cell[CellGroupData[{Cell["\[LeftCeiling]Run\[RightFloor]", 
               "CodeSubsubsubsection", Evaluatable -> True, 
               CellChangeTimes -> {{3.734892518648984*^9, 
                3.7348925189658403*^9}}], Cell[BoxData[RowBox[
                 {RowBox[{RowBox[{"loadH2SDVR", "[", "\"RunOps\"", "]"}], 
                    ":=", "\n", RowBox[{"h2SingleRunOps", "=", "\n", "\t", 
                      RowBox[{"{", "\n", "\t\t", RowBox[{RowBox[{"Monitor", 
                          "\[Rule]", "False"}], ",", "\n", "\t", "\t", 
                          RowBox[{"\"SaveKineticEnergy\"", "\[Rule]", 
                          "False"}], ",", "\n", "\t", "\t", RowBox[
                          {"\"LoadKineticEnergy\"", "\[Rule]", "False"}]}], 
                        "\n", "\t", "\t", "}"}]}]}], ";"}]], "CodeInput"]}, 
             Closed]], Cell[CellGroupData[
             {Cell["\[LeftCeiling]Plot\[RightFloor]", "CodeSubsubsubsection", 
               Evaluatable -> True, CellChangeTimes -> 
                {{3.745351467216156*^9, 3.7453514689274*^9}}], 
              Cell[BoxData[RowBox[{RowBox[{"loadH2SDVR", "[", "\"PlotOps\"", 
                    "]"}], ":=", "\n", RowBox[{"(", "\n", RowBox[
                     {RowBox[{"h2SinglePotMinMax", ":=", "\n", "\t", 
                        RowBox[{"h2SinglePotMinMax", "=", "\n", "\t\t", 
                          RowBox[{"Map", "[", RowBox[{RowBox[{RowBox[{"#", 
                          "[", RowBox[{RowBox[{"h2SinglePot", "[", "x", 
                          "]"}], ",", RowBox[{RowBox[{"{", "x", "}"}], 
                          "\[Element]", "h2SingleReg"}]}], "]"}], "&"}], ",", 
                          "\n", "\t", "\t", "\t", RowBox[{"{", "\n", "\t", 
                          "\t", "\t\t", RowBox[{"NMinValue", ",", "\n", "\t", 
                          "\t", "\t\t", "NMaxValue"}], "\n", "\t\t\t\t", 
                          "}"}]}], "\n", "\t\t\t", "]"}]}]}], ";", "\n", 
                      RowBox[{"h2SingleColFun", ":=", "\n", "\t", RowBox[
                         {"h2SingleColFun", "=", "\n", "\t\t", RowBox[
                          {"With", "[", RowBox[{RowBox[{"{", "\n", "\t", 
                          "\t\t\t", RowBox[{RowBox[{"cf", "=", RowBox[
                          {"ColorData", "[", "\"M10DefaultDensityGradient\"", 
                          "]"}]}], ",", "\n", "\t", "\t", "\t\t", RowBox[
                          {"mm", "=", "h2SinglePotMinMax"}], ",", "\n", "\t", 
                          "\t", "\t\t", RowBox[{"pot", "=", 
                          "h2SinglePot"}]}], "\n", "\t", "\t", "\t\t", "}"}], 
                          ",", "\n", "\t", "\t", "\t", RowBox[{RowBox[{"cf", 
                          "[", RowBox[{"Rescale", "[", RowBox[{RowBox[{"pot", 
                          "[", "#", "]"}], ",", "mm", ",", RowBox[{"{", 
                          RowBox[{"0", ",", "1"}], "}"}]}], "]"}], "]"}], 
                          "&"}]}], "\n", "\t", "\t", "\t", "]"}]}]}], ";", 
                      "\n", RowBox[{"h2SinglePlotOps", "=", "\n", "\t", 
                        RowBox[{"{", "\n", "\t\t", RowBox[{RowBox[
                          {"\"PotentialStyle\"", "\[Rule]", "None"}], ",", 
                          "\n", "\t", "\t", RowBox[{"\"ShowEnergy\"", 
                          "\[Rule]", "False"}], ",", "\n", "\t", "\t", 
                          RowBox[{"\"ShowPotential\"", "\[Rule]", "False"}], 
                          ",", "\n", "\t", "\t", RowBox[{"ColorFunction", 
                          ":>", "h2SingleColFun"}], ",", "\n", "\t", "\t", 
                          RowBox[{"ColorFunctionScaling", "\[Rule]", 
                          "False"}], ",", "\n", "\t", "\t", RowBox[
                          {"Lighting", "->", "\"Neutral\""}], ",", "\n", 
                          "\t", "\t", RowBox[{"Manipulate", "\[Rule]", 
                          "False"}]}], "\n", "\t\t", "}"}]}], ";"}], "\n", 
                    ")"}]}]], "CodeInput"]}, Closed]], 
           Cell[CellGroupData[{Cell["\[LeftCeiling]$H2Settings\[RightFloor]", 
               "CodeSubsubsubsection", Evaluatable -> True, 
               CellChangeTimes -> {{3.73489180431931*^9, 
                 3.7348918090640173*^9}, 3.7350813102505293*^9}], 
              Cell[BoxData[RowBox[{RowBox[{"loadH2SDVR", "[", "\"Settings\"", 
                    "]"}], ":=", RowBox[{"(", "\n", "\n", RowBox[
                     {RowBox[{"loadH2SDVR", "[", "\"Region\"", "]"}], ";", 
                      "\n", RowBox[{"loadH2SDVR", "[", "\"GridOps\"", "]"}], 
                      ";", "\n", RowBox[{"loadH2SDVR", "[", "\"KEOps\"", 
                        "]"}], ";", "\n", RowBox[{"loadH2SDVR", "[", 
                        "\"PEOps\"", "]"}], ";", "\n", RowBox[{"loadH2SDVR", 
                        "[", "\"POOps\"", "]"}], ";", "\n", RowBox[
                       {"loadH2SDVR", "[", "\"PlotOps\"", "]"}], ";", "\n", 
                      RowBox[{"loadH2SDVR", "[", "\"RunOps\"", "]"}], ";", 
                      "\n", "\n", RowBox[{RowBox[{"$H2SingleDVR", "[", 
                          "\"RuntimeOptions\"", "]"}], "=", "\n", "\t", 
                        RowBox[{"Flatten", "@", "\n", "\t\t", RowBox[{"{", 
                          "\n", "\t\t\t", RowBox[{RowBox[{"\"GridOptions\"", 
                          "\[Rule]", "\n", "\t\t\t\t", "h2SingleGridOps"}], 
                          ",", "\n", "\t\t\t", RowBox[
                          {"\"KineticEnergyOptions\"", "\[Rule]", "\n", 
                          "\t\t\t\t", "h2SingleKEOps"}], ",", "\n", "\t\t\t", 
                          RowBox[{"\"PotentialEnergyOptions\"", "\[Rule]", 
                          "\n", "\t\t\t\t", "h2SinglePEOps"}], ",", "\n", 
                          "\t\t\t", RowBox[{"\"ViewOptions\"", "\[Rule]", 
                          "\n", "\t\t\t\t", "h2SinglePlotOps"}], ",", "\n", 
                          "\t\t\t", "h2SingleRunOps"}], "\n", "\t\t\t", 
                          "}"}]}]}], ";"}], "\n", "\t\t\t", "\n", ")"}]}]], 
               "CodeInput"]}, Open]]}, Open]]}, Open]], 
     Cell[CellGroupData[{Cell["\[LeftCeiling]$D2SingleDVR\[RightFloor]", 
         "CodeSubsection", Evaluatable -> True], 
        Cell[BoxData[{RowBox[{RowBox[{RowBox[{"loadD2SDVR", "[", "]"}], ":=", 
               "\n", "\t", RowBox[{"(", "\n", "\t\t", RowBox[
                  {RowBox[{"loadD2SDVR", "[", "\"DVR\"", "]"}], ";", "\n", 
                   "\t\t", RowBox[{"loadH2SDVR", "[", "\"Pot\"", "]"}], ";", 
                   "\n", "\t\t", RowBox[{"loadD2SDVR", "[", "\"Settings\"", 
                     "]"}], ";", "\n", "\t\t", "$D2SingleDVR"}], "\n", 
                 "\t\t", ")"}]}], ";"}], "\n", 
           RowBox[{RowBox[{"If", "[", RowBox[{RowBox[{"!", RowBox[{"MatchQ", 
                     "[", RowBox[{RowBox[{"OwnValues", "[", "$D2SingleDVR", 
                         "]"}], ",", " ", RowBox[{"{", RowBox[{"_", 
                          "\[RuleDelayed]", "_ChemDVRObject"}], "}"}]}], 
                     "]"}]}], ",", "\n", "\t", RowBox[{"$D2SingleDVR", ":=", 
                   RowBox[{"loadD2SDVR", "[", "]"}]}]}], "\n", "\t", "]"}], 
             ";"}]}], "CodeInput"], Cell[CellGroupData[
          {Cell["\[LeftCeiling]DVR\[RightFloor]", "CodeSubsubsection", 
            Evaluatable -> True], Cell[BoxData[RowBox[{RowBox[
                {RowBox[{"loadD2SDVR", "[", "\"DVR\"", "]"}], ":=", "\n", 
                 "\t", RowBox[{"$D2SingleDVR", "=", RowBox[{"ChemDVRObject", 
                     "[", "\"Cartesian1DDVR\"", "]"}]}]}], ";"}]], 
            "CodeInput"]}, Closed]], Cell[CellGroupData[
          {Cell["\[LeftCeiling]Ops\[RightFloor]", "CodeSubsubsection", 
            Evaluatable -> True, CellChangeTimes -> {{3.7348920704194403*^9, 
             3.734892075314517*^9}, {3.7348922603494787*^9, 
             3.734892260719327*^9}}], Cell[BoxData[RowBox[
              {"<<", "ChemTools`Data`"}]], "CodeInput", CellChangeTimes -> 
             {{3.724625736341876*^9, 3.724625750428109*^9}, 
             {3.724791374399713*^9, 3.724791375714342*^9}, 
             {3.724796659364353*^9, 3.7247966665533943*^9}, 
             {3.7275718655476713*^9, 3.727571898968864*^9}, 
             {3.734892078989205*^9, 3.734892214051343*^9}, 
             {3.734892251045857*^9, 3.734892278574534*^9}}, 
            CellLabel -> "In[158]:="], Cell[CellGroupData[
             {Cell["\[LeftCeiling]KE\[RightFloor]", "CodeSubsubsubsection", 
               Evaluatable -> True, CellChangeTimes -> 
                {{3.734892282801947*^9, 3.734892283025955*^9}}], 
              Cell[BoxData[RowBox[{RowBox[{"loadD2SDVR", "[", "\"KEOps\"", 
                    "]"}], ":=", "\n", RowBox[{"(", "\n", "\t", RowBox[
                     {RowBox[{"d5D2Mass", "=", "\n", "\t\t", RowBox[{"2", 
                          "*", RowBox[{"ChemDataLookup", "[", RowBox[
                          {"\"D\"", ",", " ", "\"NISTMass\""}], "]"}]}]}], 
                      ";", "\n", "\t", RowBox[{"d2SingleKEOps", "=", "\n", 
                        "\t", "\t", RowBox[{"{", "\n", "\t", "\t\t", RowBox[
                          {RowBox[{"\"HBar\"", "->", "\n", "\t\t\t\t", 
                          RowBox[{"QuantityMagnitude", "@", "\n", 
                          "\t\t\t\t\t", RowBox[{"ChemDataLookup", "[", RowBox[
                          {"\"DVRHBarInAMUWavenumbers\"", ",", " ", 
                          "\"Constants\""}], "]"}]}]}], ",", "\n", "\t", 
                          "\t", "\t", RowBox[{"\"Mass\"", "\[Rule]", "\n", 
                          "\t\t\t\t", RowBox[{"QuantityMagnitude", "@", 
                          "d5D2Mass"}]}], ",", "\n", "\t\t\t", RowBox[
                          {"\"ScalingFactor\"", "\[Rule]", "\n", "\t", 
                          "\t\t\t", RowBox[{"(", RowBox[{"1", "/", RowBox[
                          {RowBox[{"QuantityMagnitude", "@", RowBox[
                          {"UnitConvert", "[", RowBox[{"\"Angstroms\"", ",", 
                          " ", "\"Centimeters\""}], "]"}]}], "^", "2"}]}], 
                          ")"}]}]}], "\n", "\t", "\t\t", "}"}]}], ";"}], 
                    "\n", "\t", ")"}]}]], "CodeInput"]}, Open]], 
           Cell[CellGroupData[{Cell["\[LeftCeiling]$D2Settings\[RightFloor]", 
               "CodeSubsubsubsection", Evaluatable -> True], Cell[BoxData[
                RowBox[{RowBox[{"loadD2SDVR", "[", "\"Settings\"", "]"}], 
                  ":=", RowBox[{"(", "\n", "\n", "\t", RowBox[
                     {RowBox[{"loadH2SDVR", "[", "\"Region\"", "]"}], ";", 
                      "\n", "\t", RowBox[{"loadH2SDVR", "[", "\"GridOps\"", 
                        "]"}], ";", "\n", "\t", RowBox[{"loadD2SDVR", "[", 
                        "\"KEOps\"", "]"}], ";", "\n", "\t", RowBox[
                       {"loadH2SDVR", "[", "\"PEOps\"", "]"}], ";", "\n", 
                      "\t", RowBox[{"loadH2SDVR", "[", "\"POOps\"", "]"}], 
                      ";", "\n", "\t", RowBox[{"loadH2SDVR", "[", 
                        "\"PlotOps\"", "]"}], ";", "\n", "\t", RowBox[
                       {"loadH2SDVR", "[", "\"RunOps\"", "]"}], ";", "\n", 
                      "\t", "\n", "\t", RowBox[{RowBox[{"$D2SingleDVR", "[", 
                          "\"RuntimeOptions\"", "]"}], "=", "\n", "\t", "\t", 
                        RowBox[{"Flatten", "@", "\n", "\t", "\t\t", RowBox[
                          {"{", "\n", "\t", "\t\t\t", RowBox[{RowBox[
                          {"\"GridOptions\"", "\[Rule]", "\n", "\t", 
                          "\t\t\t\t", "h2SingleGridOps"}], ",", "\n", "\t", 
                          "\t\t\t", RowBox[{"\"KineticEnergyOptions\"", 
                          "\[Rule]", "\n", "\t\t\t\t\t", "d2SingleKEOps"}], 
                          ",", "\n", "\t", "\t\t\t", RowBox[
                          {"\"PotentialEnergyOptions\"", "\[Rule]", "\n", 
                          "\t", "\t\t\t\t", "h2SinglePEOps"}], ",", "\n", 
                          "\t", "\t\t\t", RowBox[{"\"ViewOptions\"", 
                          "\[Rule]", "\n", "\t", "\t\t\t\t", 
                          "h2SinglePlotOps"}], ",", "\n", "\t", "\t\t\t", 
                          "h2SingleRunOps"}], "\n", "\t", "\t\t\t", 
                          "}"}]}]}], ";"}], "\n", "\t", "\t\t\t", "\n", "\t", 
                    ")"}]}]], "CodeInput"]}, Open]]}, Open]]}, Closed]], 
     Cell[CellGroupData[
       {Cell["\[LeftCeiling]H2 State Assignments\[RightFloor]", 
         "CodeSubsection", Evaluatable -> True, CellChangeTimes -> 
          {{3.74241720993165*^9, 3.7424172139229603*^9}}], 
        Cell[CellGroupData[{Cell["\[LeftCeiling]Test\[RightFloor]", 
            "CodeSubsubsubsection", Evaluatable -> True], 
           Cell[BoxData[RowBox[{"(*", RowBox[{"With", "[", RowBox[
                  {RowBox[{"{", RowBox[{"gg", "=", "\[IndentingNewLine]", 
                       RowBox[{"Thread", "[", RowBox[{"{", 
                          "\[IndentingNewLine]", RowBox[{RowBox[{RowBox[
                          {"$H2DVR", "[", "\[IndentingNewLine]", " ", RowBox[
                          {RowBox[{"\"Points\"", "\[Rule]", RowBox[{"{", 
                          RowBox[{"125", ",", " ", "125"}], "}"}]}], ",", 
                          RowBox[{"\"ShowPotential\"", "\[Rule]", "False"}], 
                          ",", "\[IndentingNewLine]", " ", RowBox[
                          {"\"WavefunctionClipping\"", "\[Rule]", "None"}], 
                          ",", " ", RowBox[{"\"NumberOfWavefunctions\"", 
                          "\[Rule]", "15"}], ",", "\[IndentingNewLine]", 
                          RowBox[{"\"PlotMode\"", "\[Rule]", "\"Density\""}], 
                          ",", RowBox[{"\"PlotDisplayMode\"", "\[Rule]", 
                          "List"}], ",", "\[IndentingNewLine]", RowBox[
                          {"ColorFunction", "->", "\"Rainbow\""}], ",", 
                          "\[IndentingNewLine]", RowBox[{
                          "ColorFunctionScaling", "->", "True"}]}], 
                          "\[IndentingNewLine]", "]"}], "~", "TakeList", "~", 
                          RowBox[{"{", RowBox[{"1", ",", " ", "2", ",", " ", 
                          "3", ",", " ", "4", ",", " ", "5"}], "}"}]}], ",", 
                          "\[IndentingNewLine]", RowBox[{"TakeList", "[", 
                          "\[IndentingNewLine]", RowBox[{RowBox[{"$H2DVR", 
                          "[", "\[IndentingNewLine]", RowBox[{RowBox[
                          {"\"Points\"", "\[Rule]", RowBox[{"{", RowBox[
                          {"25", ",", " ", "25"}], "}"}]}], ",", 
                          "\[IndentingNewLine]", RowBox[{
                          "\"PotentialOptimize\"", "\[Rule]", "False"}], ",", 
                          "\[IndentingNewLine]", RowBox[{
                          "\"UseGuessWavefunctions\"", "\[Rule]", "True"}], 
                          ",", " ", "\[IndentingNewLine]", RowBox[
                          {"\"PotentialFunction\"", "\[Rule]", RowBox[{"(", 
                          RowBox[{"0", "&"}], ")"}]}], ",", 
                          "\[IndentingNewLine]", " ", RowBox[{
                          "\"UncoupledPotentialFunctions\"", "\[Rule]", 
                          RowBox[{"{", RowBox[{"h2SinglePot", ",", " ", 
                          "h2SinglePot"}], "}"}]}], ",", 
                          "\[IndentingNewLine]", RowBox[{
                          "\"PlotDisplayMode\"", "\[Rule]", "List"}], ",", 
                          "\[IndentingNewLine]", RowBox[{"\"ShowPotential\"", 
                          "\[Rule]", "False"}], ",", " ", RowBox[
                          {"\"WavefunctionClipping\"", "\[Rule]", "None"}], 
                          ",", "\[IndentingNewLine]", RowBox[{
                          "\"NumberOfWavefunctions\"", "\[Rule]", "15"}], 
                          ",", "\[IndentingNewLine]", RowBox[{"\"PlotMode\"", 
                          "\[Rule]", "\"Density\""}], ",", 
                          "\[IndentingNewLine]", RowBox[{"ColorFunction", 
                          "->", "\"Rainbow\""}], ",", "\[IndentingNewLine]", 
                          RowBox[{"ColorFunctionScaling", "->", "True"}]}], 
                          "\[IndentingNewLine]", "]"}], ",", " ", 
                          "\[IndentingNewLine]", RowBox[{"{", RowBox[{"1", 
                          ",", " ", "2", ",", " ", "3", ",", " ", "4", ",", 
                          " ", "5"}], "}"}]}], "\[IndentingNewLine]", 
                          "]"}]}], "\[IndentingNewLine]", "}"}], "]"}]}], 
                     "\[IndentingNewLine]", "}"}], ",", 
                   "\[IndentingNewLine]", RowBox[{"Manipulate", "[", 
                     RowBox[{RowBox[{"Grid", "@", RowBox[{"gg", "[", RowBox[
                          {"[", "i", "]"}], "]"}]}], ",", " ", RowBox[
                        {"{", RowBox[{"i", ",", " ", "1", ",", RowBox[
                          {"Length", "@", "gg"}], ",", "1"}], "}"}]}], 
                     "]"}]}], "\[IndentingNewLine]", "]"}], "*)"}]], 
            "CodeInput", CellChangeTimes -> {{3.74241208005828*^9, 
             3.742412094410528*^9}, {3.742412262829571*^9, 
             3.742412265796093*^9}, {3.742412311557398*^9, 
             3.742412344839061*^9}, {3.74241414657971*^9, 
             3.742414238538248*^9}, {3.742414273135036*^9, 
             3.742414379927568*^9}, {3.74241455221246*^9, 
             3.742414625793026*^9}, {3.742415813378441*^9, 
             3.742415830513856*^9}}, CellLabel -> "In[82]:="]}, Closed]], 
        Cell[CellGroupData[
          {Cell["\[LeftCeiling]$H2StateAssignments\[RightFloor]", 
            "CodeSubsubsection", Evaluatable -> True], 
           Cell[BoxData[RowBox[{RowBox[{"$H2StateAssignments", "=", 
                 "\[IndentingNewLine]", RowBox[{"<|", "\[IndentingNewLine]", 
                   RowBox[{RowBox[{"1", "\[Rule]", "\"\!\(\*TemplateBox[{RowB\
ox[{\"0\", \",\", \"0\"}]},\"Ket\"]\)\""}], ",", "\[IndentingNewLine]", 
                     RowBox[{"2", "\[Rule]", "\"\!\(\*TemplateBox[{RowBox[{\"\
0\", \",\", \"1\"}]},\"Ket\"]\)-\!\(\*TemplateBox[{RowBox[{\"1\", \",\", \
\"0\"}]},\"Ket\"]\)\""}], ",", "\[IndentingNewLine]", RowBox[{"3", "\[Rule]", 
                       "\"\!\(\*TemplateBox[{RowBox[{\"0\", \",\", \
\"1\"}]},\"Ket\"]\)+\!\(\*TemplateBox[{RowBox[{\"1\", \",\", \
\"0\"}]},\"Ket\"]\)\""}], ",", "\[IndentingNewLine]", RowBox[{"4", "\[Rule]", 
                       "\"\!\(\*TemplateBox[{RowBox[{\"0\", \",\", \
\"2\"}]},\"Ket\"]\)-\!\(\*TemplateBox[{RowBox[{\"2\", \",\", \
\"0\"}]},\"Ket\"]\)\""}], ",", "\[IndentingNewLine]", RowBox[{"5", "\[Rule]", 
                       "\"\!\(\*TemplateBox[{RowBox[{\"1\", \",\", \
\"1\"}]},\"Ket\"]\)\[Angle]45\""}], ",", "\[IndentingNewLine]", RowBox[
                      {"6", "\[Rule]", "\"\!\(\*TemplateBox[{RowBox[{\"0\", \
\",\", \"2\"}]},\"Ket\"]\)+\!\(\*TemplateBox[{RowBox[{\"2\", \",\", \
\"0\"}]},\"Ket\"]\)\""}], ",", "\[IndentingNewLine]", RowBox[{"7", "\[Rule]", 
                       "\"\!\(\*TemplateBox[{RowBox[{\"0\", \",\", \
\"3\"}]},\"Ket\"]\)-\!\(\*TemplateBox[{RowBox[{\"3\", \",\", \
\"0\"}]},\"Ket\"]\)\""}], ",", "\[IndentingNewLine]", RowBox[{"8", "\[Rule]", 
                       "\"\!\(\*TemplateBox[{RowBox[{\"1\", \",\", \
\"2\"}]},\"Ket\"]\)-\!\(\*TemplateBox[{RowBox[{\"2\", \",\", \
\"1\"}]},\"Ket\"]\)\""}], ",", "\[IndentingNewLine]", RowBox[{"9", "\[Rule]", 
                       "\"\!\(\*TemplateBox[{RowBox[{\"1\", \",\", \
\"2\"}]},\"Ket\"]\)+\!\(\*TemplateBox[{RowBox[{\"2\", \",\", \
\"1\"}]},\"Ket\"]\)\""}], ",", "\[IndentingNewLine]", RowBox[{"10", 
                       "\[Rule]", "\"\!\(\*TemplateBox[{RowBox[{\"0\", \",\", \
\"3\"}]},\"Ket\"]\)+\!\(\*TemplateBox[{RowBox[{\"3\", \",\", \
\"0\"}]},\"Ket\"]\)\""}], ",", "\[IndentingNewLine]", RowBox[{"11", 
                       "\[Rule]", "\"\!\(\*TemplateBox[{RowBox[{\"0\", \",\", \
\"4\"}]},\"Ket\"]\)-\!\(\*TemplateBox[{RowBox[{\"4\", \",\", \
\"0\"}]},\"Ket\"]\)\""}], ",", "\[IndentingNewLine]", RowBox[{"12", 
                       "\[Rule]", "\"\!\(\*TemplateBox[{RowBox[{\"1\", \",\", \
\"3\"}]},\"Ket\"]\)-\!\(\*TemplateBox[{RowBox[{\"3\", \",\", \
\"1\"}]},\"Ket\"]\)\""}], ",", "\[IndentingNewLine]", RowBox[{"13", 
                       "\[Rule]", "\"\!\(\*TemplateBox[{RowBox[{\"2\", \",\", \
\"2\"}]},\"Ket\"]\)\[Angle]45\""}], ",", "\[IndentingNewLine]", RowBox[
                      {"14", "\[Rule]", "\"\!\(\*TemplateBox[{RowBox[{\"1\", \
\",\", \"3\"}]},\"Ket\"]\)+\!\(\*TemplateBox[{RowBox[{\"3\", \",\", \
\"1\"}]},\"Ket\"]\)\""}], ",", "\[IndentingNewLine]", RowBox[{"15", 
                       "\[Rule]", "\"\!\(\*TemplateBox[{RowBox[{\"0\", \",\", \
\"4\"}]},\"Ket\"]\)+\!\(\*TemplateBox[{RowBox[{\"4\", \",\", \
\"0\"}]},\"Ket\"]\)\""}]}], "\[IndentingNewLine]", "|>"}]}], ";"}]], 
            "CodeInput", CellChangeTimes -> {{3.7424093010722923*^9, 
             3.742409421766333*^9}, {3.7424098178124332*^9, 
             3.7424098815900784*^9}, {3.74240993875557*^9, 
             3.742409948387011*^9}, {3.7424109458571777*^9, 
             3.742410946575941*^9}, {3.742410983055203*^9, 
             3.742411033132896*^9}, {3.742411070233426*^9, 
             3.7424110762130957*^9}, {3.7424111274808273*^9, 
             3.742411127609515*^9}, {3.742411181290759*^9, 
             3.742411218960844*^9}, {3.742411518575315*^9, 
             3.7424115422712097*^9}, {3.742411821872176*^9, 
             3.742411832593031*^9}, {3.7424157381572657*^9, 
             3.742415747390009*^9}, {3.7424157933650227*^9, 
             3.742415810457232*^9}, {3.742415869664565*^9, 
             3.74241600555232*^9}, {3.742416299500835*^9, 
             3.7424163531735086*^9}, {3.742417025538084*^9, 
             3.742417054629305*^9}}, CellLabel -> "In[83]:="]}, Closed]]}, 
       Closed]], Cell[CellGroupData[
       {Cell["\[LeftCeiling]$H54DDVR\[RightFloor]", "CodeSubsection", 
         Evaluatable -> True, CellChangeTimes -> {{3.735883795555732*^9, 
          3.735883798906765*^9}}], 
        Cell[BoxData[{RowBox[{RowBox[{RowBox[{"loadH54DVR", "[", "]"}], ":=", 
               "\n", "\t", RowBox[{"(", "\n", "\t\t", RowBox[
                  {RowBox[{"loadH54DVR", "[", "\"DVR\"", "]"}], ";", "\n", 
                   "\t\t", RowBox[{"loadH54DVR", "[", "\"Pot\"", "]"}], ";", 
                   "\n", "\t\t", RowBox[{"loadH54DVR", "[", "\"Settings\"", 
                     "]"}], ";", "\n", "\t\t", "$H54DDVR"}], "\n", "\t\t", 
                 ")"}]}], ";"}], "\n", RowBox[{RowBox[{"$H54DDVR", ":=", 
               RowBox[{"loadH54DVR", "[", "]"}]}], ";"}]}], "CodeInput"], 
        Cell[CellGroupData[{Cell["\[LeftCeiling]$H54DDVR\[RightFloor]", 
            "CodeSubsubsection", Evaluatable -> True, CellChangeTimes -> 
             {{3.731864004671295*^9, 3.731864006111929*^9}, 
             {3.73489173306841*^9, 3.734891733827517*^9}, 
             {3.7358838170672283*^9, 3.735883817378158*^9}}], 
           Cell[BoxData[RowBox[{RowBox[{RowBox[{"loadH54DVR", "[", "\"DVR\"", 
                   "]"}], ":=", "\n", "\t", RowBox[{"$H54DDVR", "=", 
                   RowBox[{"ChemDVRObject", "[", "\"Cartesian4DDVR\"", 
                     "]"}]}]}], ";"}]], "CodeInput"]}, Closed]], 
        Cell[CellGroupData[{Cell["\[LeftCeiling]Region\[RightFloor]", 
            "CodeSubsubsection", Evaluatable -> True, CellChangeTimes -> 
             {{3.734891972373926*^9, 3.734891973141464*^9}}], 
           Cell[BoxData[RowBox[{RowBox[{"loadH54DVR", "[", "\"Region\"", 
                 "]"}], ":=", "\n", RowBox[{"(", "\n", "\t", RowBox[
                  {RowBox[{RowBox[{"{", RowBox[{"h54DRegMin", ",", 
                         "h54DRegMax"}], "}"}], "=", "\n", "\t", "\t", 
                     RowBox[{"Transpose", "@", RowBox[{"H5FullInterpPot", 
                         "[", RowBox[{"[", RowBox[{"1", ",", " ", RowBox[
                          {"3", ";;", "4"}]}], "]"}], "]"}]}]}], ";", "\n", 
                   "\t", RowBox[{"h54DRegUnrot", "=", RowBox[{"Rectangle", 
                       "[", RowBox[{"h54DRegMin", ",", "h54DRegMax"}], 
                       "]"}]}], ";", "\n", "\t", RowBox[{"h54DReg", "=", 
                     RowBox[{"Region", "@", RowBox[{"TransformedRegion", "[", 
                         RowBox[{"h54DRegUnrot", ",", RowBox[
                          {"RotationTransform", "[", RowBox[{"\[Pi]", "/", 
                          "4"}], "]"}]}], "]"}]}]}], ";", "\n", "\t", "\t", 
                   RowBox[{"h54DReg", "//", "RegionBounds"}]}], "\n", 
                 ")"}]}]], "CodeInput"], Cell[CellGroupData[
             {Cell["\[LeftCeiling]Tests\[RightFloor]", 
               "CodeSubsubsubsection", Evaluatable -> True], Cell[BoxData[
                RowBox[{"(*", RowBox[{"Show", "[", "\[IndentingNewLine]", 
                    RowBox[{RowBox[{"Graphics", "@", RowBox[{"{", 
                          "\[IndentingNewLine]", RowBox[{"Red", ",", 
                          "\[IndentingNewLine]", RowBox[{RowBox[{"Show", "[", 
                          "h54DTReg", "]"}], "[", RowBox[{"[", "1", "]"}], 
                          "]"}]}], " ", "\[IndentingNewLine]", "}"}]}], ",", 
                      "\[IndentingNewLine]", RowBox[{"Graphics", "[", 
                        RowBox[{"{", RowBox[{"Yellow", ",", " ", 
                          "h54DTRegUnrot"}], "}"}], "]"}], ",", 
                      "\[IndentingNewLine]", RowBox[{"Graphics", "[", 
                        RowBox[{"{", RowBox[{"Blue", ",", " ", 
                          "h54DRegUnrot"}], "}"}], "]"}], ",", 
                      "\[IndentingNewLine]", RowBox[{"Show", "@", 
                        "h54DReg"}], ",", "\[IndentingNewLine]", RowBox[
                       {"Graphics", "[", "\[IndentingNewLine]", RowBox[
                         {"{", "\[IndentingNewLine]", RowBox[{RowBox[{"{", 
                          "\[IndentingNewLine]", RowBox[{"Pink", ",", 
                          "\[IndentingNewLine]", RowBox[{RowBox[{"testGrid", 
                          "[", RowBox[{"[", RowBox[{"All", ",", " ", RowBox[
                          {";;", "2"}]}], "]"}], "]"}], "//", "Point"}]}], 
                          "\[IndentingNewLine]", "}"}], ",", 
                          "\[IndentingNewLine]", RowBox[{"{", 
                          "\[IndentingNewLine]", RowBox[{"Green", ",", 
                          "\[IndentingNewLine]", RowBox[{RowBox[{RowBox[
                          {RowBox[{FractionBox["1", SqrtBox["2"]], "*", 
                          RowBox[{"{", RowBox[{RowBox[{"(", RowBox[{RowBox[
                          {"#", "[", RowBox[{"[", "2", "]"}], "]"}], "-", 
                          RowBox[{"#", "[", RowBox[{"[", "1", "]"}], "]"}]}], 
                          ")"}], ",", " ", RowBox[{"(", RowBox[{RowBox[{"#", 
                          "[", RowBox[{"[", "1", "]"}], "]"}], "+", RowBox[
                          {"#", "[", RowBox[{"[", "2", "]"}], "]"}]}], 
                          ")"}]}], "}"}]}], "&"}], "/@", 
                          "\[IndentingNewLine]", "testGrid"}], "//", 
                          "Point"}]}], "\[IndentingNewLine]", "}"}]}], 
                          "\[IndentingNewLine]", "}"}], 
                        "\[IndentingNewLine]", "]"}], ",", 
                      "\[IndentingNewLine]", RowBox[{"Axes", "\[Rule]", 
                        "True"}], ",", "\[IndentingNewLine]", RowBox[
                       {"AxesOrigin", "\[Rule]", RowBox[{"{", RowBox[{"0", 
                          ",", " ", "0"}], "}"}]}]}], "\[IndentingNewLine]", 
                    "]"}], "*)"}]], "CodeInput", CellChangeTimes -> 
                {{3.738069574021943*^9, 3.738069591788804*^9}, 
                {3.73806963939436*^9, 3.738069695338838*^9}, 
                {3.738069753982504*^9, 3.738069786742428*^9}, 
                {3.738069824517408*^9, 3.7380698456433477*^9}, 
                {3.738069887940435*^9, 3.738069902648034*^9}, 
                {3.73807008460565*^9, 3.738070090514174*^9}, 
                {3.738070234750794*^9, 3.738070257950905*^9}, 
                {3.738070307342059*^9, 3.7380703100716343*^9}, 
                {3.738072059279046*^9, 3.738072087449954*^9}, 
                {3.738072121138342*^9, 3.738072202424667*^9}, 
                {3.738072298897195*^9, 3.738072320001974*^9}, 
                {3.7380723737305098*^9, 3.738072388321447*^9}, 
                {3.738072456349217*^9, 3.738072468339682*^9}}, CellLabel -> 
                "In[89]:="], Cell[BoxData[RowBox[{"(*", RowBox[
                   {RowBox[{RowBox[{"h54DTRegUnrot", "=", RowBox[
                         {"Rectangle", "@@", RowBox[{"Transpose", "[", 
                          RowBox[{"h54DReg", "//", "RegionBounds"}], 
                          "]"}]}]}], ";"}], "\n", RowBox[{RowBox[{"h54DTReg", 
                        "=", RowBox[{"Region", "@", RowBox[
                          {"TransformedRegion", "[", RowBox[{"h54DTRegUnrot", 
                          ",", RowBox[{"RotationTransform", "[", RowBox[
                          {RowBox[{"-", "\[Pi]"}], "/", "4"}], "]"}]}], 
                          "]"}]}]}], ";"}], "\[IndentingNewLine]", 
                    RowBox[{"h54DTReg", "//", "RegionBounds"}]}], "*)"}]], 
               "CodeInput", CellChangeTimes -> {{3.7380692183781*^9, 
                3.738069244661043*^9}}, CellLabel -> "In[90]:="]}, Closed]]}, 
          Closed]], Cell[CellGroupData[
          {Cell["\[LeftCeiling]Ops\[RightFloor]", "CodeSubsubsection", 
            Evaluatable -> True, CellChangeTimes -> {{3.7348920704194403*^9, 
              3.734892075314517*^9}, {3.7348922603494787*^9, 
              3.734892260719327*^9}, 3.735082195857592*^9}], 
           Cell[BoxData[RowBox[{"<<", "ChemTools`Data`"}]], "CodeInput", 
            CellChangeTimes -> {{3.724625736341876*^9, 3.724625750428109*^9}, 
             {3.724791374399713*^9, 3.724791375714342*^9}, 
             {3.724796659364353*^9, 3.7247966665533943*^9}, 
             {3.7275718655476713*^9, 3.727571898968864*^9}, 
             {3.734892078989205*^9, 3.734892214051343*^9}, 
             {3.734892251045857*^9, 3.734892278574534*^9}}, 
            CellLabel -> "In[91]:="], Cell[CellGroupData[
             {Cell["\[LeftCeiling]Grid\[RightFloor]", "CodeSubsubsubsection", 
               Evaluatable -> True, CellChangeTimes -> 
                {{3.7348922864342737*^9, 3.734892286911202*^9}}], 
              Cell[BoxData[RowBox[{RowBox[{RowBox[{"loadH54DVR", "[", 
                      "\"GridOps\"", "]"}], ":=", "\n", "\t", RowBox[
                     {"h54DGridOps", "=", "\n", "\t\t", RowBox[{"{", "\n", 
                        "\t\t\t", RowBox[{RowBox[{"\"Range\"", "\[Rule]", 
                          "\n", "\t", "\t", "\t", RowBox[{"Join", "[", "\n", 
                          "\t", "\t", "\t\t", RowBox[{RowBox[{"h54DReg", 
                          "//", "RegionBounds"}], ",", "\n", "\t", "\t", 
                          "\t\t", RowBox[{"{", RowBox[{RowBox[{"{", RowBox[
                          {"0.25`", ",", "2.25`"}], "}"}], ",", RowBox[{"{", 
                          RowBox[{"0.25`", ",", "2.25`"}], "}"}]}], "}"}]}], 
                          "\n", "\t", "\t", "\t\t", "]"}]}], ",", "\n", "\t", 
                          "\t", "\t", RowBox[{"\"Points\"", "\[Rule]", 
                          RowBox[{"{", RowBox[{"30", ",", " ", "30", ",", 
                          " ", "125", ",", " ", "125"}], "}"}]}]}], "\n", 
                        "\t", "\t", "\t", "}"}]}]}], ";"}]], "CodeInput"]}, 
             Open]], Cell[CellGroupData[
             {Cell["\[LeftCeiling]KE\[RightFloor]", "CodeSubsubsubsection", 
               Evaluatable -> True, CellChangeTimes -> 
                {{3.734892282801947*^9, 3.734892283025955*^9}}], 
              Cell[BoxData[RowBox[{RowBox[{"loadH54DVR", "[", "\"GridOps\"", 
                    "]"}], ":=", "\n", RowBox[{"(", "\n", RowBox[
                     {RowBox[{"h5HMass", "=", "\n", "\t", RowBox[{"Quantity", 
                          "[", "\n", "\t\t", RowBox[{RowBox[
                          {"ChemTools`Data`RawDatasets`$ChemIsotopicMasses", 
                          "[", RowBox[{"1", ",", " ", "1", ",", " ", 
                          "\"Mass\""}], "]"}], ",", "\n", "\t", "\t", 
                          "\"AtomicMassUnit\""}], "\n", "\t", "\t", "]"}]}], 
                      ";", "\n", RowBox[{"h54DKEOps", "=", "\n", "\t", 
                        RowBox[{"{", "\n", "\t\t", RowBox[{RowBox[
                          {"\"HBar\"", "->", "\n", "\t\t\t", RowBox[
                          {"QuantityMagnitude", "@", "\n", "\t\t\t\t", RowBox[
                          {"UnitConvert", "[", "\n", "\t", "\t\t\t\t", RowBox[
                          {RowBox[{RowBox[{"Quantity", "[", 
                          "\"ReducedPlanckConstant\"", "]"}], "/", RowBox[
                          {"Sqrt", "[", RowBox[{"Quantity", "[", RowBox[
                          {"\"PlanckConstant\"", "*", "\"SpeedOfLight\""}], 
                          "]"}], "]"}]}], ",", "\n", "\t", "\t", "\t", 
                          "\t\t", RowBox[{RowBox[{"Sqrt", "[", 
                          "\"Kilograms\"", "]"}], "*", RowBox[{"Sqrt", "[", 
                          "\"Centimeters\"", "]"}]}]}], "\n", "\t", 
                          "\t\t\t\t", "]"}]}]}], ",", "\n", "\t", "\t", 
                          RowBox[{"\"Mass\"", "\[Rule]", "\n", "\t\t\t", 
                          RowBox[{"{", "\n", "\t\t\t\t", RowBox[{RowBox[
                          {"With", "[", "\n", "\t\t\t\t\t", RowBox[{RowBox[
                          {"{", "\n", "\t\t\t\t\t\t", RowBox[{"hMass", "=", 
                          "\n", "\t\t\t\t\t\t", RowBox[{"QuantityMagnitude", 
                          "@", "\n", "\t", "\t", "\t\t\t\t", RowBox[
                          {"UnitConvert", "[", RowBox[{"h5HMass", ",", 
                          "\"Kilograms\""}], "]"}]}]}], "\n", "\t", "\t", 
                          "\t\t\t\t", "}"}], ",", "\n", "\t", "\t", "\t\t\t", 
                          FractionBox[RowBox[{"hMass", " ", RowBox[{"(", 
                          RowBox[{"2", "*", "hMass"}], ")"}]}], RowBox[
                          {"hMass", "+", " ", RowBox[{"2", RowBox[{"(", 
                          RowBox[{"2", "*", "hMass"}], ")"}]}]}]]}], "\n", 
                          "\t", "\t", "\t\t\t", "]"}], ",", "\n", "\t", "\t", 
                          "\t\t", RowBox[{"2", "*", RowBox[{
                          "QuantityMagnitude", "@", "\n", "\t", "\t\t\t\t", 
                          RowBox[{"UnitConvert", "[", RowBox[{"h5HMass", ",", 
                          "\"Kilograms\""}], "]"}]}]}], ",", "\n", "\t", 
                          "\t", "\t\t", RowBox[{"2", "*", RowBox[
                          {"QuantityMagnitude", "@", "\n", "\t", "\t\t\t\t", 
                          RowBox[{"UnitConvert", "[", RowBox[{"h5HMass", ",", 
                          "\"Kilograms\""}], "]"}]}]}], ",", "\n", "\t", 
                          "\t", "\t\t", RowBox[{"2", "*", RowBox[
                          {"QuantityMagnitude", "@", "\n", "\t", "\t\t\t\t", 
                          RowBox[{"UnitConvert", "[", RowBox[{"h5HMass", ",", 
                          "\"Kilograms\""}], "]"}]}]}]}], "\n", "\t", 
                          "\t\t\t", "}"}]}], ",", "\n", "\t", "\t", RowBox[
                          {"\"ScalingFactor\"", "\[Rule]", "\n", "\t\t\t", 
                          RowBox[{"(", RowBox[{"1", "/", RowBox[{RowBox[
                          {"QuantityMagnitude", "@", RowBox[{"UnitConvert", 
                          "[", RowBox[{"\"Angstroms\"", ",", " ", 
                          "\"Centimeters\""}], "]"}]}], "^", "2"}]}], 
                          ")"}]}]}], "\n", "\t\t", "}"}]}], ";"}], "\n", 
                    ")"}]}]], "CodeInput"]}, Open]], 
           Cell[CellGroupData[{Cell["\[LeftCeiling]PE\[RightFloor]", 
               "CodeSubsubsubsection", Evaluatable -> True, 
               CellChangeTimes -> {{3.734892282801947*^9, 
                 3.734892283025955*^9}, 3.734901351564073*^9}], 
              Cell[BoxData[RowBox[{RowBox[{RowBox[{"loadH54DVR", "[", 
                      "\"PEOps\"", "]"}], ":=", "\n", "\t", RowBox[
                     {"h54DPEOps", "=", "\n", "\t\t", RowBox[{"{", "\n", 
                        "\t\t\t", RowBox[{"\"PotentialFunction\"", "\[Rule]", 
                          "H5FullPot"}], "\n", "\t", "\t", "\t", "}"}]}]}], 
                  ";"}]], "CodeInput"]}, Closed]], 
           Cell[CellGroupData[{Cell["\[LeftCeiling]Run\[RightFloor]", 
               "CodeSubsubsubsection", Evaluatable -> True, 
               CellChangeTimes -> {{3.734892518648984*^9, 
                3.7348925189658403*^9}}], Cell[BoxData[RowBox[
                 {RowBox[{RowBox[{"loadH54DVR", "[", "\"RunOps\"", "]"}], 
                    ":=", "\n", "\t", RowBox[{"h54DRunOps", "=", "\n", 
                      "\t\t", RowBox[{"{", "\n", "\t\t\t", RowBox[
                         {RowBox[{"Monitor", "\[Rule]", "False"}], ",", "\n", 
                          "\t", "\t", "\t", RowBox[{"\"SaveKineticEnergy\"", 
                          "\[Rule]", "False"}], ",", "\n", "\t", "\t", "\t", 
                          RowBox[{"\"LoadKineticEnergy\"", "\[Rule]", 
                          "False"}]}], "\n", "\t", "\t", "\t", "}"}]}]}], 
                  ";"}]], "CodeInput"]}, Closed]], 
           Cell[CellGroupData[{Cell["\[LeftCeiling]Plot\[RightFloor]", 
               "CodeSubsubsubsection", Evaluatable -> True, 
               CellChangeTimes -> {{3.734892552423584*^9, 
                3.734892552868722*^9}}], Cell[BoxData[RowBox[
                 {RowBox[{RowBox[{"loadH54DVR", "[", "\"PlotOps\"", "]"}], 
                    ":=", "\n", "\t", RowBox[{"h54DPlotOps", "=", "\n", 
                      "\t\t", RowBox[{"{", "\n", "\t\t\t", RowBox[
                         {RowBox[{"\"PotentialStyle\"", "\[Rule]", "None"}], 
                          ",", "\n", "\t", "\t", "\t", RowBox[
                          {"\"ShowEnergy\"", "\[Rule]", "False"}], ",", "\n", 
                          "\t", "\t", "\t", RowBox[{"PlotRange", "\[Rule]", 
                          "All"}], ",", "\n", "\t", "\t", "\t", RowBox[
                          {"Manipulate", "\[Rule]", "False"}]}], "\n", "\t", 
                        "\t", "\t", "}"}]}]}], ";"}]], "CodeInput"]}, 
             Closed]], Cell[CellGroupData[
             {Cell["\[LeftCeiling]PO\[RightFloor]", "CodeSubsubsubsection", 
               Evaluatable -> True], Cell[BoxData[RowBox[
                 {RowBox[{RowBox[{"loadH54DVR", "[", "\"POOps\"", "]"}], 
                    ":=", "\n", "\t", RowBox[{"h54DPotOptOps", "=", "\n", 
                      "\t\t", RowBox[{"{", "\n", "\t\t\t", RowBox[
                         {RowBox[{"\"PotentialFunction\"", "\[Rule]", RowBox[
                          {"{", RowBox[{"None", ",", " ", "None", ",", " ", 
                          "h2SinglePot", ",", " ", "h2SinglePot"}], "}"}]}], 
                          ",", "\n", "\t", "\t", "\t", RowBox[
                          {"\"OptimizedCoordinates\"", "\[Rule]", RowBox[
                          {"{", RowBox[{"3", ",", " ", "4"}], "}"}]}], ",", 
                          "\n", "\t", "\t", "\t", RowBox[
                          {"\"OptimizedBasisSize\"", "\[Rule]", "25"}]}], 
                        "\n", "\t", "\t", "\t", "}"}]}]}], ";"}]], 
               "CodeInput"]}, Open]], Cell[CellGroupData[
             {Cell["\[LeftCeiling]$H54DSettings\[RightFloor]", 
               "CodeSubsubsubsection", Evaluatable -> True], Cell[BoxData[
                RowBox[{RowBox[{"loadH54DVR", "[", "\"Settings\"", "]"}], 
                  ":=", "\n", RowBox[{"(", "\n", "\t", RowBox[
                     {RowBox[{"loadH54DVR", "[", "\"Region\"", "]"}], ";", 
                      "\n", "\t", RowBox[{"loadH54DVR", "[", "\"GridOps\"", 
                        "]"}], ";", "\n", "\t", RowBox[{"loadH54DVR", "[", 
                        "\"PEOps\"", "]"}], ";", "\n", "\t", RowBox[
                       {"loadH54DVR", "[", "\"KEOps\"", "]"}], ";", "\n", 
                      "\t", RowBox[{"loadH54DVR", "[", "\"POOps\"", "]"}], 
                      ";", "\n", "\t", RowBox[{"loadH54DVR", "[", 
                        "\"PlotOps\"", "]"}], ";", "\n", "\t", RowBox[
                       {"loadH54DVR", "[", "\"RunOps\"", "]"}], ";", "\n", 
                      "\t", RowBox[{RowBox[{"$H54DDVR", "[", 
                          "\"RuntimeOptions\"", "]"}], "=", "\n", "\t\t", 
                        RowBox[{"Flatten", "@", "\n", "\t\t\t", RowBox[
                          {"{", "\n", "\t\t\t\t", RowBox[{RowBox[
                          {"\"GridOptions\"", "\[Rule]", "\n", "\t\t\t\t\t", 
                          "h54DGridOps"}], ",", "\n", "\t\t\t\t", RowBox[
                          {"\"KineticEnergyOptions\"", "\[Rule]", "\n", 
                          "\t\t\t\t\t", "h54DKEOps"}], ",", "\n", "\t\t\t\t", 
                          RowBox[{"\"PotentialEnergyOptions\"", "\[Rule]", 
                          "\n", "\t\t\t\t\t", "h54DPEOps"}], ",", "\n", 
                          "\t\t\t\t", RowBox[{"\"ViewOptions\"", "\[Rule]", 
                          "\n", "\t\t\t\t\t", "h54DPlotOps"}], ",", "\n", 
                          "\t\t\t\t", RowBox[{
                          "\"PotentialOptimizationOptions\"", "\[Rule]", 
                          "\n", "\t\t\t\t\t", "h54DPotOptOps"}], ",", "\n", 
                          "\t\t\t\t", "h54DRunOps"}], "\n", "\t\t\t\t", 
                          "}"}]}]}], ";"}], "\n", "\t", ")"}]}]], 
               "CodeInput"]}, Open]]}, Open]]}, Open]], 
     Cell[CellGroupData[{Cell["\[LeftCeiling]Plot5D\[RightFloor]", 
         "CodeSubsection", Evaluatable -> True, CellChangeTimes -> 
          {{3.738523574757165*^9, 3.738523581845285*^9}}], 
        Cell[BoxData[RowBox[{RowBox[{"If", "[", RowBox[{RowBox[
                 {RowBox[{"Length", "@", RowBox[{"OwnValues", "@", 
                      "$H54DGrid"}]}], "\[Equal]", "0"}], ",", 
                "\[IndentingNewLine]", RowBox[{"$H54DGrid", ":=", 
                  "\[IndentingNewLine]", RowBox[{"$H54DGrid", "=", 
                    RowBox[{"$H54DDVR", "[", "\"Grid\"", "]"}]}]}]}], 
              "\[IndentingNewLine]", "]"}], ";"}]], "CodeInput", 
         CellChangeTimes -> {{3.738525527060844*^9, 3.738525543665276*^9}, 
          {3.739804468634717*^9, 3.739804475688314*^9}, 
          {3.739804652926077*^9, 3.739804653257168*^9}, 
          {3.740415897580946*^9, 3.740415935739856*^9}}, 
         CellLabel -> "In[100]:="], Cell[CellGroupData[
          {Cell["\[LeftCeiling]ListPlot5D\[RightFloor]", "CodeSubsubsection", 
            Evaluatable -> True, CellChangeTimes -> {3.7385248905764017*^9}], 
           Cell[BoxData[{RowBox[{"ListPlot5D", "//", "Clear"}], 
              "\[IndentingNewLine]", RowBox[{RowBox[{RowBox[{"ListPlot5D", 
                    "[", "\[IndentingNewLine]", RowBox[{"gridwfns_", ",", 
                      "\[IndentingNewLine]", RowBox[{"n", ":", RowBox[
                         {"_Span", "|", RowBox[{"{", "__Integer", "}"}], "|", 
                          "All"}], ":", "All"}], ",", "\[IndentingNewLine]", 
                      RowBox[{"coords", ":", RowBox[{"(", RowBox[{RowBox[
                          {"{", RowBox[{"_", ",", " ", "_"}], "}"}], 
                          "\[Rule]", RowBox[{"{", RowBox[{"_", ",", " ", 
                          "_"}], "}"}]}], ")"}], ":", RowBox[{"(", RowBox[
                          {RowBox[{"{", RowBox[{"3", ",", " ", "4"}], "}"}], 
                          "\[Rule]", RowBox[{"{", RowBox[{"2", ",", " ", 
                          "1"}], "}"}]}], ")"}]}], ",", 
                      "\[IndentingNewLine]", " ", RowBox[{"ops", ":", 
                        RowBox[{"OptionsPattern", "[", "ListPlot3D", 
                          "]"}]}]}], "\[IndentingNewLine]", "]"}], ":=", 
                  "\[IndentingNewLine]", RowBox[{"Module", "[", 
                    "\[IndentingNewLine]", RowBox[{RowBox[{"{", 
                        "\[IndentingNewLine]", RowBox[{"groupedWfns", ",", 
                          "\[IndentingNewLine]", "potMinMaxes", ",", 
                          "\[IndentingNewLine]", "wfnCutPlots"}], 
                        "\[IndentingNewLine]", "}"}], ",", 
                      "\[IndentingNewLine]", RowBox[{RowBox[{"groupedWfns", 
                          "=", "\[IndentingNewLine]", RowBox[{"With", "[", 
                          RowBox[{RowBox[{"{", RowBox[{RowBox[{"c1", "=", 
                          RowBox[{"coords", "[", RowBox[{"[", "1", "]"}], 
                          "]"}]}], ",", " ", RowBox[{"c2", "=", RowBox[
                          {"Append", "[", RowBox[{RowBox[{"coords", "[", 
                          RowBox[{"[", "2", "]"}], "]"}], ",", " ", "5"}], 
                          "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
                          RowBox[{RowBox[{RowBox[{RowBox[{"GroupBy", "[", 
                          "\[IndentingNewLine]", RowBox[{RowBox[{"Flatten", 
                          "/@", "#"}], ",", "\[IndentingNewLine]", RowBox[
                          {RowBox[{"Function", "[", RowBox[{"#", "[", RowBox[
                          {"[", "c1", "]"}], "]"}], "]"}], "\[Rule]", RowBox[
                          {"Function", "[", RowBox[{"#", "[", RowBox[{"[", 
                          "c2", "]"}], "]"}], "]"}]}]}], 
                          "\[IndentingNewLine]", "]"}], "[", RowBox[{"[", 
                          "n", "]"}], "]"}], "&"}], "/@", "gridwfns"}]}], 
                          "\[IndentingNewLine]", "]"}]}], ";", 
                        "\[IndentingNewLine]", RowBox[{"potMinMaxes", "=", 
                          "\[IndentingNewLine]", RowBox[{RowBox[{RowBox[
                          {"With", "[", RowBox[{RowBox[{"{", RowBox[{"order", 
                          "=", RowBox[{"Ordering", "[", RowBox[{"Join", "[", 
                          RowBox[{RowBox[{"coords", "[", RowBox[{"[", "2", 
                          "]"}], "]"}], ",", " ", RowBox[{"coords", "[", 
                          RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], 
                          "}"}], ",", "\[IndentingNewLine]", RowBox[
                          {"MapIndexed", "[", "\[IndentingNewLine]", RowBox[
                          {RowBox[{RowBox[{"MinMax", "@", 
                          "\[IndentingNewLine]", RowBox[{"DeleteCases", "[", 
                          "\[IndentingNewLine]", RowBox[{RowBox[{
                          "H5FullVecPot", "[", "\[IndentingNewLine]", RowBox[
                          {RowBox[{RowBox[{RowBox[{"Flatten", "[", "#", 
                          "]"}], "[", RowBox[{"[", "order", "]"}], "]"}], 
                          "&"}], "/@", "\[IndentingNewLine]", RowBox[
                          {"Thread", "[", RowBox[{"{", RowBox[{RowBox[{"#", 
                          "[", RowBox[{"[", RowBox[{"All", ",", " ", RowBox[
                          {";;", "2"}]}], "]"}], "]"}], ",", " ", RowBox[
                          {"ConstantArray", "[", RowBox[{RowBox[{"#2", "[", 
                          RowBox[{"[", RowBox[{"1", ",", " ", "1"}], "]"}], 
                          "]"}], ",", RowBox[{"Length", "@", "#"}]}], 
                          "]"}]}], "}"}], "]"}]}], "\[IndentingNewLine]", 
                          "]"}], ",", "\[IndentingNewLine]", RowBox[{"10.", 
                          "^", "9"}]}], "\[IndentingNewLine]", "]"}]}], 
                          "&"}], ",", "\[IndentingNewLine]", RowBox[
                          {"KeySort", "[", "#", "]"}]}], 
                          "\[IndentingNewLine]", "]"}]}], 
                          "\[IndentingNewLine]", "]"}], "&"}], "/@", 
                          "groupedWfns"}]}], ";", "\[IndentingNewLine]", 
                        RowBox[{"wfnCutPlots", "=", "\[IndentingNewLine]", 
                          RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
                          RowBox[{RowBox[{RowBox[{"With", "[", 
                          "\[IndentingNewLine]", RowBox[{RowBox[{"{", RowBox[
                          {"minMax", "=", "#2"}], "}"}], ",", 
                          "\[IndentingNewLine]", RowBox[{"KeyValueMap", "[", 
                          "\[IndentingNewLine]", RowBox[{RowBox[{RowBox[
                          {"ListPlot3D", "[", "\[IndentingNewLine]", RowBox[
                          {"#2", ",", "\[IndentingNewLine]", RowBox[
                          {"PlotLabel", "\[Rule]", RowBox[{"TemplateApply", 
                          "[", RowBox[{"\"`1`: `3` `2`: `4`\"", ",", " ", 
                          RowBox[{"Join", "[", RowBox[{RowBox[{"coords", "[", 
                          RowBox[{"[", "1", "]"}], "]"}], ",", " ", "#"}], 
                          "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
                          RowBox[{"ColorFunction", "\[Rule]", 
                          "\[IndentingNewLine]", RowBox[{"Replace", "[", 
                          RowBox[{RowBox[{"OptionValue", "[", 
                          "ColorFunction", "]"}], ",", "\[IndentingNewLine]", 
                          RowBox[{"Automatic", ":>", "\[IndentingNewLine]", 
                          RowBox[{"With", "[", "\[IndentingNewLine]", RowBox[
                          {RowBox[{"{", "\[IndentingNewLine]", RowBox[{RowBox[
                          {"minmax", "=", RowBox[{"minMax", "[", "#", 
                          "]"}]}], ",", " ", "\[IndentingNewLine]", RowBox[
                          {"cf", "=", RowBox[{"ColorData", "[", 
                          "\"M10DefaultDensityGradient\"", "]"}]}], ",", 
                          "\[IndentingNewLine]", RowBox[{"crds", "=", RowBox[
                          {"Sequence", "@@", "#"}]}], ",", 
                          "\[IndentingNewLine]", RowBox[{"order", "=", RowBox[
                          {"Ordering", "[", RowBox[{"Join", "[", RowBox[{
                          RowBox[{"coords", "[", RowBox[{"[", "2", "]"}], 
                          "]"}], ",", " ", RowBox[{"coords", "[", RowBox[{
                          "[", "1", "]"}], "]"}]}], "]"}], "]"}]}]}], 
                          "\[IndentingNewLine]", "}"}], ",", 
                          "\[IndentingNewLine]", RowBox[{RowBox[{"cf", "@", 
                          "\[IndentingNewLine]", RowBox[{"Rescale", "[", 
                          "\[IndentingNewLine]", RowBox[{RowBox[{"H5FullPot", 
                          "[", RowBox[{RowBox[{"{", RowBox[{"#", ",", " ", 
                          "#2", ",", " ", "crds"}], "}"}], "[", RowBox[{"[", 
                          "order", "]"}], "]"}], "]"}], ",", 
                          "\[IndentingNewLine]", "minmax", ",", 
                          "\[IndentingNewLine]", RowBox[{"{", RowBox[{"0", 
                          ",", "1"}], "}"}]}], "\[IndentingNewLine]", 
                          "]"}]}], "&"}]}], "\[IndentingNewLine]", "]"}]}]}], 
                          "\[IndentingNewLine]", "]"}]}], ",", 
                          "\[IndentingNewLine]", RowBox[{RowBox[{
                          "ColorFunctionScaling", "\[Rule]", 
                          "\[IndentingNewLine]", RowBox[{"Replace", "[", 
                          RowBox[{RowBox[{"OptionValue", "[", 
                          "ColorFunction", "]"}], ",", "\[IndentingNewLine]", 
                          RowBox[{"{", "\[IndentingNewLine]", RowBox[{RowBox[
                          {"Automatic", "\[Rule]", "False"}], ",", 
                          "\[IndentingNewLine]", RowBox[{"_", ":>", RowBox[
                          {"OptionValue", "[", "ColorFunctionScaling", 
                          "]"}]}]}], "\[IndentingNewLine]", "}"}]}], 
                          "\[IndentingNewLine]", "]"}]}], ";", 
                          "\[IndentingNewLine]", "ops"}], ",", 
                          "\[IndentingNewLine]", RowBox[{"PlotRange", 
                          "\[Rule]", "All"}]}], "\[IndentingNewLine]", "]"}], 
                          "&"}], ",", "\[IndentingNewLine]", RowBox[
                          {"KeySort", "[", "#", "]"}]}], 
                          "\[IndentingNewLine]", "]"}]}], 
                          "\[IndentingNewLine]", "]"}], "&"}], ",", 
                          "\[IndentingNewLine]", RowBox[{"{", RowBox[
                          {"groupedWfns", ",", "\[IndentingNewLine]", 
                          "potMinMaxes"}], "\[IndentingNewLine]", "}"}]}], 
                          "\[IndentingNewLine]", "]"}]}]}]}], 
                    "\[IndentingNewLine]", "]"}]}], ";"}]}], "CodeInput", 
            CellChangeTimes -> {{3.7385235827051773*^9, 
              3.738523603982893*^9}, {3.738523636085816*^9, 
              3.738523762872383*^9}, {3.738523825432122*^9, 
              3.738523892752164*^9}, {3.73852431178461*^9, 
              3.738524327141095*^9}, {3.738524433437584*^9, 
              3.7385244756190557*^9}, {3.738524557643917*^9, 
              3.738524615749202*^9}, {3.738524876133119*^9, 
              3.738524884639267*^9}, {3.738525329528658*^9, 
              3.7385253404354*^9}, 3.738527885977221*^9, 
              3.7385279284256353*^9, {3.73852808532417*^9, 
              3.7385281057822037*^9}, {3.738528415691478*^9, 
              3.73852841963221*^9}, {3.738528599389427*^9, 
              3.7385286471009207*^9}, {3.738529024870791*^9, 
              3.738529106470706*^9}, {3.73852979339917*^9, 
              3.738529794739428*^9}, {3.7385298855017033*^9, 
              3.7385299368651323*^9}, {3.73853007231227*^9, 
              3.738530074351516*^9}, {3.7385955928574753*^9, 
              3.738595593382934*^9}}, CellLabel -> "In[101]:="]}, Open]], 
        Cell[CellGroupData[
          {Cell["\[LeftCeiling]ListDensityPlot5D\[RightFloor]", 
            "CodeSubsubsection", Evaluatable -> True, CellChangeTimes -> 
             {{3.738524898684779*^9, 3.7385249031156683*^9}}], 
           Cell[BoxData[{RowBox[{"ListDensityPlot5D", "//", "Clear"}], 
              "\[IndentingNewLine]", RowBox[{RowBox[{RowBox[
                   {"ListDensityPlot5D", "[", "\[IndentingNewLine]", 
                    RowBox[{"gridwfns_", ",", "\[IndentingNewLine]", 
                      RowBox[{"n", ":", RowBox[{"_Span", "|", RowBox[{"{", 
                          "__Integer", "}"}], "|", "All"}], ":", "All"}], 
                      ",", "\[IndentingNewLine]", RowBox[{"coords", ":", 
                        RowBox[{"(", RowBox[{"_Integer", "\[Rule]", RowBox[
                          {"{", RowBox[{"_", ",", " ", "_", ",", " ", "_"}], 
                          "}"}]}], ")"}], ":", RowBox[{"(", RowBox[{"1", 
                          "\[Rule]", RowBox[{"{", RowBox[{"1", ",", " ", "2", 
                          ",", " ", "3"}], "}"}]}], ")"}]}], ",", 
                      "\[IndentingNewLine]", RowBox[{"ops", ":", RowBox[
                         {"OptionsPattern", "[", "ListDensityPlot3D", 
                          "]"}]}]}], "\[IndentingNewLine]", "]"}], ":=", 
                  "\[IndentingNewLine]", RowBox[{"Module", "[", 
                    "\[IndentingNewLine]", RowBox[{RowBox[{"{", 
                        "\[IndentingNewLine]", RowBox[{"groupedWfns", ",", 
                          "\[IndentingNewLine]", "groupedWfnsR1", ",", 
                          "\[IndentingNewLine]", "potMinMaxes", ",", 
                          "\[IndentingNewLine]", "wfnCutPlots"}], 
                        "\[IndentingNewLine]", "}"}], ",", 
                      "\[IndentingNewLine]", RowBox[{RowBox[{"groupedWfns", 
                          "=", "\[IndentingNewLine]", RowBox[{"With", "[", 
                          RowBox[{RowBox[{"{", RowBox[{RowBox[{"c1", "=", 
                          RowBox[{"coords", "[", RowBox[{"[", "1", "]"}], 
                          "]"}]}], ",", " ", RowBox[{"c2", "=", RowBox[
                          {"Append", "[", RowBox[{RowBox[{"coords", "[", 
                          RowBox[{"[", "2", "]"}], "]"}], ",", " ", "5"}], 
                          "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
                          RowBox[{RowBox[{RowBox[{RowBox[{"GroupBy", "[", 
                          "\[IndentingNewLine]", RowBox[{RowBox[{"Flatten", 
                          "/@", "#"}], ",", "\[IndentingNewLine]", RowBox[
                          {RowBox[{"Function", "[", RowBox[{"#", "[", RowBox[
                          {"[", "c1", "]"}], "]"}], "]"}], "\[Rule]", RowBox[
                          {"Function", "[", RowBox[{"#", "[", RowBox[{"[", 
                          "c2", "]"}], "]"}], "]"}]}]}], 
                          "\[IndentingNewLine]", "]"}], "[", RowBox[{"[", 
                          "n", "]"}], "]"}], "&"}], "/@", "gridwfns"}]}], 
                          "\[IndentingNewLine]", "]"}]}], ";", 
                        "\[IndentingNewLine]", RowBox[{"potMinMaxes", "=", 
                          "\[IndentingNewLine]", RowBox[{RowBox[{RowBox[
                          {"With", "[", "\[IndentingNewLine]", RowBox[
                          {RowBox[{"{", "\[IndentingNewLine]", RowBox[
                          {"order", "=", "\[IndentingNewLine]", RowBox[
                          {"Ordering", "[", RowBox[{"Flatten", "[", RowBox[
                          {"{", RowBox[{RowBox[{"coords", "[", RowBox[{"[", 
                          "2", "]"}], "]"}], ",", " ", RowBox[{"coords", "[", 
                          RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "]"}], 
                          "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
                          "\[IndentingNewLine]", RowBox[{"MapIndexed", "[", 
                          "\[IndentingNewLine]", RowBox[{RowBox[{RowBox[
                          {"MinMax", "@", "\[IndentingNewLine]", RowBox[
                          {"DeleteCases", "[", "\[IndentingNewLine]", RowBox[
                          {RowBox[{"H5FullVecPot", "[", 
                          "\[IndentingNewLine]", RowBox[{RowBox[{RowBox[
                          {RowBox[{"Flatten", "[", "#", "]"}], "[", RowBox[
                          {"[", "order", "]"}], "]"}], "&"}], "/@", 
                          "\[IndentingNewLine]", RowBox[{"Thread", "[", 
                          RowBox[{"{", RowBox[{RowBox[{"#", "[", RowBox[{"[", 
                          RowBox[{"All", ",", " ", RowBox[{";;", "2"}]}], 
                          "]"}], "]"}], ",", " ", RowBox[{"ConstantArray", 
                          "[", RowBox[{RowBox[{"#2", "[", RowBox[{"[", RowBox[
                          {"1", ",", " ", "1"}], "]"}], "]"}], ",", RowBox[
                          {"Length", "@", "#"}]}], "]"}]}], "}"}], "]"}]}], 
                          "\[IndentingNewLine]", "]"}], ",", 
                          "\[IndentingNewLine]", RowBox[{"10.", "^", "9"}]}], 
                          "\[IndentingNewLine]", "]"}]}], "&"}], ",", 
                          "\[IndentingNewLine]", RowBox[{"KeySort", "[", "#", 
                          "]"}]}], "\[IndentingNewLine]", "]"}]}], 
                          "\[IndentingNewLine]", "]"}], "&"}], "/@", 
                          "groupedWfns"}]}], ";", "\[IndentingNewLine]", 
                        RowBox[{"wfnCutPlots", "=", "\[IndentingNewLine]", 
                          RowBox[{RowBox[{RowBox[{"KeyValueMap", "[", 
                          "\[IndentingNewLine]", RowBox[{RowBox[{RowBox[
                          {"ListDensityPlot3D", "[", "\[IndentingNewLine]", 
                          RowBox[{"#2", ",", "\[IndentingNewLine]", RowBox[
                          {"PlotLabel", "\[Rule]", RowBox[{"TemplateApply", 
                          "[", RowBox[{"\"``: ``\"", ",", " ", RowBox[{"{", 
                          RowBox[{RowBox[{"coords", "[", RowBox[{"[", "1", 
                          "]"}], "]"}], ",", " ", "#"}], "}"}]}], "]"}]}], 
                          ",", "\[IndentingNewLine]", RowBox[{
                          "ColorFunction", "\[Rule]", "\[IndentingNewLine]", 
                          RowBox[{"Replace", "[", RowBox[{RowBox[{
                          "OptionValue", "[", "ColorFunction", "]"}], ",", 
                          "\[IndentingNewLine]", RowBox[{"Automatic", ":>", 
                          "\[IndentingNewLine]", RowBox[{"With", "[", 
                          "\[IndentingNewLine]", RowBox[{RowBox[{"{", 
                          "\[IndentingNewLine]", RowBox[{RowBox[{"minmax", 
                          "=", RowBox[{"potMinMaxes", "[", "#", "]"}]}], ",", 
                          " ", "\[IndentingNewLine]", RowBox[{"cf", "=", 
                          RowBox[{"ColorData", "[", 
                          "\"M10DefaultDensityGradient\"", "]"}]}], ",", 
                          "\[IndentingNewLine]", RowBox[{"r1r2", "=", RowBox[
                          {"Sequence", "@@", "#"}]}]}], 
                          "\[IndentingNewLine]", "}"}], ",", 
                          "\[IndentingNewLine]", RowBox[{RowBox[{"cf", "@", 
                          "\[IndentingNewLine]", RowBox[{"Rescale", "[", 
                          "\[IndentingNewLine]", RowBox[{RowBox[{"H5FullPot", 
                          "[", RowBox[{"{", RowBox[{"#", ",", " ", "#2", ",", 
                          " ", "r1r2"}], "}"}], "]"}], ",", 
                          "\[IndentingNewLine]", "minmax", ",", 
                          "\[IndentingNewLine]", RowBox[{"{", RowBox[{"0", 
                          ",", "1"}], "}"}]}], "\[IndentingNewLine]", 
                          "]"}]}], "&"}]}], "\[IndentingNewLine]", "]"}]}]}], 
                          "\[IndentingNewLine]", "]"}]}], ",", 
                          "\[IndentingNewLine]", RowBox[{RowBox[{
                          "ColorFunctionScaling", "\[Rule]", 
                          "\[IndentingNewLine]", RowBox[{"Replace", "[", 
                          RowBox[{RowBox[{"OptionValue", "[", 
                          "ColorFunction", "]"}], ",", "\[IndentingNewLine]", 
                          RowBox[{"{", "\[IndentingNewLine]", RowBox[{RowBox[
                          {"Automatic", "\[Rule]", "False"}], ",", 
                          "\[IndentingNewLine]", RowBox[{"_", ":>", RowBox[
                          {"OptionValue", "[", "ColorFunctionScaling", 
                          "]"}]}]}], "\[IndentingNewLine]", "}"}]}], 
                          "\[IndentingNewLine]", "]"}]}], ";", 
                          "\[IndentingNewLine]", "ops"}], ",", 
                          "\[IndentingNewLine]", RowBox[{"OpacityFunction", 
                          "\[Rule]", RowBox[{"Function", "[", RowBox[{"If", 
                          "[", RowBox[{RowBox[{"#", "<", ".8"}], ",", " ", 
                          "0", ",", " ", RowBox[{RowBox[{"-", "4"}], "+", 
                          RowBox[{"5", "#"}]}]}], "]"}], "]"}]}], ",", 
                          "\[IndentingNewLine]", RowBox[{"PlotRange", 
                          "\[Rule]", "All"}]}], "\[IndentingNewLine]", "]"}], 
                          "&"}], ",", "\[IndentingNewLine]", RowBox[
                          {"KeySort", "[", "#", "]"}]}], 
                          "\[IndentingNewLine]", "]"}], "&"}], "/@", 
                          "groupedWfns"}]}]}]}], "\[IndentingNewLine]", 
                    "]"}]}], ";"}]}], "CodeInput", CellChangeTimes -> 
             {{3.738524339597508*^9, 3.738524345805731*^9}, 
             {3.738524628718322*^9, 3.738524733635956*^9}, 
             {3.738524776424417*^9, 3.738524845759594*^9}, 
             {3.738524915039413*^9, 3.738524956895521*^9}, 
             {3.738525151781308*^9, 3.738525206342946*^9}, 
             {3.7385252425580397*^9, 3.7385252817379913*^9}, 
             {3.738528427602771*^9, 3.738528428431962*^9}, 
             {3.738529958881774*^9, 3.738529966886044*^9}, 
             {3.738595599832177*^9, 3.738595600398904*^9}}, 
            CellLabel -> "In[103]:="]}, Open]], 
        Cell[CellGroupData[{Cell["\[LeftCeiling]H54DPlot\[RightFloor]", 
            "CodeSubsubsection", Evaluatable -> True, CellChangeTimes -> 
             {3.7385253514136353*^9}], Cell[BoxData[{RowBox[{"H54DPlot", 
                "//", "Clear"}], "\[IndentingNewLine]", RowBox[{
                RowBox[{"H54DPlot", "[", RowBox[{"wfns_", ",", " ", 
                    "\[IndentingNewLine]", RowBox[{"n", ":", RowBox[{"_Span", 
                        "|", RowBox[{"{", "__Integer", "}"}], "|", "All"}], 
                      ":", "All"}], ",", "\[IndentingNewLine]", RowBox[
                     {"coords", ":", RowBox[{"(", RowBox[{"_Integer", 
                          "\[Rule]", RowBox[{"{", RowBox[{"_", ",", " ", "_", 
                          ",", " ", "_"}], "}"}]}], ")"}], ":", RowBox[
                       {"(", RowBox[{RowBox[{"{", RowBox[{"3", ",", " ", 
                          "4"}], "}"}], "\[Rule]", RowBox[{"{", RowBox[
                          {"1", ",", " ", "2"}], "}"}]}], ")"}]}], ",", 
                    "\[IndentingNewLine]", RowBox[{"ops", ":", RowBox[
                       {"OptionsPattern", "[", "Plot3D", "]"}]}]}], "]"}], 
                ":=", "\[IndentingNewLine]", RowBox[{"ListPlot5D", "[", 
                  "\[IndentingNewLine]", RowBox[{RowBox[{"$H54DDVR", "[", 
                      RowBox[{"\"GridWavefunctions\"", ",", 
                        "\[IndentingNewLine]", " ", RowBox[
                         {"\"Wavefunctions\"", "->", "wfns"}], ",", 
                        "\[IndentingNewLine]", RowBox[{"\"Grid\"", "->", 
                          "$H54DGrid"}]}], "\[IndentingNewLine]", "]"}], ",", 
                    "\[IndentingNewLine]", "n", ",", "\[IndentingNewLine]", 
                    "coords", ",", "\[IndentingNewLine]", "ops"}], 
                  "\[IndentingNewLine]", "]"}]}]}], "CodeInput", 
            CellChangeTimes -> {{3.7385237801780987*^9, 
             3.738523812442893*^9}, {3.738524232635426*^9, 
             3.738524247867515*^9}, {3.738525363170712*^9, 
             3.738525363638546*^9}, {3.738525437940939*^9, 
             3.7385254460743427*^9}, {3.73852554717047*^9, 
             3.738525553673458*^9}, {3.738528314248789*^9, 
             3.738528318774787*^9}}, CellLabel -> "In[105]:="]}, Closed]], 
        Cell[CellGroupData[
          {Cell["\[LeftCeiling]H54DDensityPlot\[RightFloor]", 
            "CodeSubsubsection", Evaluatable -> True, CellChangeTimes -> 
             {3.7385253545328693*^9, {3.738528667730617*^9, 
              3.738528668107514*^9}}], Cell[BoxData[
             {RowBox[{"H54DDensityPlot", "//", "Clear"}], 
              "\[IndentingNewLine]", RowBox[{RowBox[{"H54DDensityPlot", "[", 
                  RowBox[{"wfns_", ",", "\[IndentingNewLine]", RowBox[
                     {"n", ":", RowBox[{"_Span", "|", RowBox[{"{", 
                          "__Integer", "}"}], "|", "All"}], ":", "All"}], 
                    ",", "\[IndentingNewLine]", RowBox[{"coords", ":", 
                      RowBox[{"(", RowBox[{"_Integer", "\[Rule]", RowBox[
                          {"{", RowBox[{"_", ",", " ", "_", ",", " ", "_"}], 
                          "}"}]}], ")"}], ":", RowBox[{"(", RowBox[{"3", 
                          "\[Rule]", RowBox[{"{", RowBox[{"1", ",", " ", "2", 
                          ",", " ", "4"}], "}"}]}], ")"}]}], ",", 
                    "\[IndentingNewLine]", RowBox[{"ops", ":", RowBox[
                       {"OptionsPattern", "[", "DensityPlot3D", "]"}]}]}], 
                  "]"}], ":=", "\[IndentingNewLine]", RowBox[
                 {"ListDensityPlot5D", "[", "\[IndentingNewLine]", 
                  RowBox[{RowBox[{"$H54DDVR", "[", RowBox[
                       {"\"GridWavefunctions\"", ",", " ", 
                        "\[IndentingNewLine]", " ", RowBox[
                         {"\"Wavefunctions\"", "->", "wfns"}], ",", 
                        "\[IndentingNewLine]", RowBox[{"\"Grid\"", "->", 
                          "$H54DGrid"}]}], "\[IndentingNewLine]", "]"}], ",", 
                    "\[IndentingNewLine]", "n", ",", "\[IndentingNewLine]", 
                    "coords", ",", "\[IndentingNewLine]", "ops"}], 
                  "\[IndentingNewLine]", "]"}]}]}], "CodeInput", 
            CellChangeTimes -> {{3.7385237801780987*^9, 
             3.738523812442893*^9}, {3.738524232635426*^9, 
             3.738524247867515*^9}, {3.738525215580584*^9, 
             3.738525225201496*^9}, {3.7385253557693033*^9, 
             3.738525362047092*^9}, {3.73852545011519*^9, 
             3.738525470689764*^9}, {3.738525561734427*^9, 
             3.738525563829636*^9}, {3.738528321079309*^9, 
             3.7385283216620417*^9}}, CellLabel -> "In[107]:="]}, Closed]]}, 
       Open]], Cell[CellGroupData[
       {Cell["\[LeftCeiling]PlotSpec\[RightFloor]", "CodeSubsection", 
         Evaluatable -> True, CellChangeTimes -> {{3.7415297592164383*^9, 
          3.7415297613997097*^9}}], Cell[CellGroupData[
          {Cell["\[LeftCeiling]Prep\[RightFloor]", "CodeSubsubsection", 
            Evaluatable -> True, CellChangeTimes -> {{3.742221109607924*^9, 
             3.742221109966465*^9}}], Cell[BoxData[{RowBox[{"H5SpecPrep", 
                "//", "Clear"}], "\[IndentingNewLine]", RowBox[{
                RowBox[{"H5SpecPrep", "[", "\[IndentingNewLine]", 
                  RowBox[{RowBox[{"specPts", ":", RowBox[{"{", RowBox[
                         {RowBox[{"{", RowBox[{"_", ",", " ", RowBox[{"_", 
                          "?", "NumericQ"}]}], "}"}], ",", " ", "___"}], 
                        "}"}]}], ",", " ", "\[IndentingNewLine]", RowBox[
                     {"range", ":", RowBox[{RowBox[{"{", RowBox[{RowBox[
                          {"_", "?", "NumericQ"}], ",", RowBox[{"_", "?", 
                          "NumericQ"}]}], "}"}], "|", "Automatic"}], ":", 
                      "Automatic"}], ",", "\[IndentingNewLine]", RowBox[
                     {"scaling", ":", RowBox[{RowBox[{"Scaled", "[", RowBox[
                          {"_", "?", "NumericQ"}], "]"}], "|", "Automatic"}], 
                      ":", "Automatic"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"shiftScale", ":", RowBox[{RowBox[{"Offset", "[", 
                          RowBox[{RowBox[{"_", "?", "NumericQ"}], ",", " ", 
                          RowBox[{"Scaled", "[", RowBox[{"_", "?", 
                          "NumericQ"}], "]"}]}], "]"}], "|", RowBox[
                         {"Offset", "[", RowBox[{"_", "?", "NumericQ"}], 
                          "]"}], "|", "Automatic"}], ":", "Automatic"}], ",", 
                    "\[IndentingNewLine]", RowBox[{"threshold", ":", 
                      RowBox[{RowBox[{"_", "?", RowBox[{"(", RowBox[
                          {RowBox[{"0", "<", "#", "<", "1"}], "&"}], ")"}]}], 
                        "|", "Automatic"}], ":", "Automatic"}]}], 
                  "\[IndentingNewLine]", "]"}], ":=", "\[IndentingNewLine]", 
                RowBox[{"Module", "[", "\[IndentingNewLine]", RowBox[
                   {RowBox[{"{", RowBox[{"sps", ",", " ", 
                        "\[IndentingNewLine]", RowBox[{"rang", "=", RowBox[
                          {"Replace", "[", RowBox[{"range", ",", " ", RowBox[
                          {"Automatic", "\[Rule]", RowBox[{"{", RowBox[
                          {RowBox[{"-", "\[Infinity]"}], ",", " ", 
                          "\[Infinity]"}], "}"}]}]}], "]"}]}], ",", 
                        "\[IndentingNewLine]", RowBox[{"scale", "=", RowBox[
                          {RowBox[{"Replace", "[", RowBox[{"scaling", ",", 
                          " ", RowBox[{"Automatic", "\[Rule]", RowBox[
                          {"Scaled", "[", "1", "]"}]}]}], "]"}], "[", RowBox[
                          {"[", "1", "]"}], "]"}]}], ",", 
                        "\[IndentingNewLine]", RowBox[{"shif", "=", RowBox[
                          {"Replace", "[", RowBox[{"shiftScale", ",", " ", 
                          RowBox[{"{", RowBox[{RowBox[{"Automatic", 
                          "\[Rule]", "0"}], ",", " ", RowBox[{RowBox[
                          {"Offset", "[", RowBox[{"s_", ",", " ", "___"}], 
                          "]"}], "\[RuleDelayed]", "s"}]}], "}"}]}], "]"}]}], 
                        ",", "\[IndentingNewLine]", RowBox[{"spacescale", 
                          "=", RowBox[{"Replace", "[", RowBox[{"shiftScale", 
                          ",", " ", RowBox[{"{", RowBox[{RowBox[{RowBox[
                          {"Offset", "[", RowBox[{"_", ",", " ", RowBox[
                          {"Scaled", "[", "n_", "]"}]}], "]"}], 
                          "\[RuleDelayed]", "n"}], ",", " ", RowBox[{"_", 
                          "\[Rule]", "1"}]}], "}"}]}], "]"}]}], ",", 
                        "\[IndentingNewLine]", RowBox[{"thresh", "=", 
                          RowBox[{"Replace", "[", RowBox[{"threshold", ",", 
                          " ", RowBox[{"Automatic", "\[Rule]", ".001"}]}], 
                          "]"}]}], ",", "\[IndentingNewLine]", "spmin"}], 
                      "\[IndentingNewLine]", "}"}], ",", 
                    "\[IndentingNewLine]", RowBox[{RowBox[{"sps", "=", 
                        RowBox[{"specPts", "+", RowBox[{"ConstantArray", "[", 
                          RowBox[{RowBox[{"{", RowBox[{"shif", ",", " ", 
                          "0"}], "}"}], ",", " ", RowBox[{"Length", "@", 
                          "specPts"}]}], "]"}]}]}], ";", 
                      "\[IndentingNewLine]", RowBox[{"sps", "=", RowBox[
                         {"Select", "[", RowBox[{"sps", ",", " ", RowBox[
                          {RowBox[{RowBox[{"rang", "[", RowBox[{"[", "1", 
                          "]"}], "]"}], "<", RowBox[{"#", "[", RowBox[{"[", 
                          "1", "]"}], "]"}], "<", RowBox[{"rang", "[", RowBox[
                          {"[", "2", "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
                      "\[IndentingNewLine]", RowBox[{"sps", "/=", RowBox[
                         {"ConstantArray", "[", RowBox[{RowBox[{"{", RowBox[
                          {"1", ",", " ", RowBox[{"Max", "@", RowBox[{"sps", 
                          "[", RowBox[{"[", RowBox[{"All", ",", " ", "2"}], 
                          "]"}], "]"}]}]}], "}"}], ",", " ", RowBox[
                          {"Length", "@", "sps"}]}], "]"}]}], ";", 
                      "\[IndentingNewLine]", RowBox[{"sps", "=", RowBox[
                         {"Select", "[", RowBox[{"sps", ",", " ", RowBox[
                          {RowBox[{RowBox[{"#", "[", RowBox[{"[", "2", "]"}], 
                          "]"}], ">", "thresh"}], "&"}]}], "]"}]}], ";", 
                      "\[IndentingNewLine]", RowBox[{"spmin", "=", RowBox[
                         {"Min", "@", RowBox[{"sps", "[", RowBox[{"[", 
                          RowBox[{"All", ",", " ", "1"}], "]"}], "]"}]}]}], 
                      ";", "\[IndentingNewLine]", RowBox[{"sps", "-=", 
                        RowBox[{"ConstantArray", "[", RowBox[{RowBox[{"{", 
                          RowBox[{"spmin", ",", " ", "0"}], "}"}], ",", " ", 
                          RowBox[{"Length", "@", "sps"}]}], "]"}]}], ";", 
                      "\[IndentingNewLine]", RowBox[{"sps", "*=", RowBox[
                         {"ConstantArray", "[", RowBox[{RowBox[{"{", RowBox[
                          {"spacescale", ",", " ", "1"}], "}"}], ",", " ", 
                          RowBox[{"Length", "@", "sps"}]}], "]"}]}], ";", 
                      "\[IndentingNewLine]", RowBox[{"sps", "+=", RowBox[
                         {"ConstantArray", "[", RowBox[{RowBox[{"{", RowBox[
                          {"spmin", ",", " ", "0"}], "}"}], ",", " ", RowBox[
                          {"Length", "@", "sps"}]}], "]"}]}], ";", 
                      "\[IndentingNewLine]", RowBox[{"sps", "*=", RowBox[
                         {"ConstantArray", "[", RowBox[{RowBox[{"{", RowBox[
                          {"1", ",", " ", "scale"}], "}"}], ",", RowBox[
                          {"Length", "@", "sps"}]}], "]"}]}], ";", 
                      "\[IndentingNewLine]", "sps"}]}], 
                  "\[IndentingNewLine]", "]"}]}]}], "CodeInput", 
            CellChangeTimes -> {{3.742221052385003*^9, 3.742221076354444*^9}, 
             {3.742222623914659*^9, 3.742222710991871*^9}, 
             {3.742222789155197*^9, 3.742222795723137*^9}, 
             {3.742225665497961*^9, 3.742225673182419*^9}, 
             {3.74222573213743*^9, 3.742225735322699*^9}, 
             {3.7423318890533533*^9, 3.742331890653446*^9}, 
             {3.742331928778796*^9, 3.7423321122651367*^9}, 
             {3.742332144077518*^9, 3.742332151451746*^9}, 
             {3.7423326587122602*^9, 3.742332671784019*^9}, 
             {3.742332718802332*^9, 3.742332730499205*^9}, 
             {3.742332826667823*^9, 3.742332859294794*^9}, 
             {3.7423336691000843*^9, 3.7423336693136168*^9}, 
             {3.7423340866357937*^9, 3.742334114112138*^9}, 
             {3.7423341891927757*^9, 3.742334190487232*^9}, 
             {3.742334288420372*^9, 3.742334348591199*^9}, 
             {3.7423345157100897*^9, 3.7423345366347923*^9}, 
             {3.742358511131877*^9, 3.7423585374643383*^9}, 
             {3.74235857353948*^9, 3.742358580498742*^9}, 
             {3.742359778398555*^9, 3.7423598178471527*^9}}, 
            CellLabel -> "In[109]:="]}, Closed]], 
        Cell[CellGroupData[{Cell["\[LeftCeiling]Lines\[RightFloor]", 
            "CodeSubsubsection", Evaluatable -> True, CellChangeTimes -> 
             {{3.74222110449647*^9, 3.742221105150626*^9}}], 
           Cell[BoxData[{RowBox[{"H5PlotSpecLines", "//", "Clear"}], 
              "\[IndentingNewLine]", RowBox[{RowBox[{"H5PlotSpecLines", "[", 
                  "\[IndentingNewLine]", RowBox[{RowBox[{"specPts", ":", 
                      RowBox[{"{", RowBox[{RowBox[{"{", RowBox[{"_", ",", 
                          " ", RowBox[{"_", "?", "NumericQ"}]}], "}"}], ",", 
                          " ", "___"}], "}"}]}], ",", " ", 
                    "\[IndentingNewLine]", RowBox[{"range", ":", RowBox[
                       {RowBox[{"{", RowBox[{RowBox[{"_", "?", "NumericQ"}], 
                          ",", RowBox[{"_", "?", "NumericQ"}]}], "}"}], "|", 
                        "Automatic"}], ":", "Automatic"}], ",", 
                    "\[IndentingNewLine]", RowBox[{"scaling", ":", RowBox[
                       {RowBox[{"Scaled", "[", RowBox[{"_", "?", 
                          "NumericQ"}], "]"}], "|", "Automatic"}], ":", 
                      "Automatic"}], ",", "\[IndentingNewLine]", RowBox[
                     {"shift", ":", RowBox[{RowBox[{"Offset", "[", RowBox[
                          {RowBox[{"_", "?", "NumericQ"}], ",", " ", RowBox[
                          {"Scaled", "[", RowBox[{"_", "?", "NumericQ"}], 
                          "]"}]}], "]"}], "|", RowBox[{"Offset", "[", 
                          RowBox[{"_", "?", "NumericQ"}], "]"}], "|", 
                        "Automatic"}], ":", "Automatic"}], ",", 
                    "\[IndentingNewLine]", RowBox[{"threshold", ":", 
                      RowBox[{RowBox[{"_", "?", RowBox[{"(", RowBox[
                          {RowBox[{"0", "<", "#", "<", "1"}], "&"}], ")"}]}], 
                        "|", "Automatic"}], ":", "Automatic"}], ",", 
                    "\[IndentingNewLine]", RowBox[{"ops", ":", RowBox[
                       {"OptionsPattern", "[", "ListPlot", "]"}]}]}], 
                  "\[IndentingNewLine]", "]"}], ":=", "\[IndentingNewLine]", 
                RowBox[{"ListPlot", "[", "\[IndentingNewLine]", RowBox[
                   {RowBox[{"H5SpecPrep", "[", RowBox[{"specPts", ",", " ", 
                        "range", ",", " ", "scaling", " ", ",", "shift", ",", 
                        " ", "threshold"}], "]"}], " ", ",", 
                    "\[IndentingNewLine]", "ops", ",", " ", 
                    "\[IndentingNewLine]", RowBox[{"Filling", "\[Rule]", 
                      "Axis"}], ",", " ", RowBox[{"FillingStyle", "\[Rule]", 
                      "Red"}], ",", " ", RowBox[{"PlotMarkers", "\[Rule]", 
                      "\"\""}], ",", "\[IndentingNewLine]", RowBox[{"Axes", 
                      "\[Rule]", RowBox[{"{", RowBox[{"True", ",", " ", 
                          "False"}], "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"PlotRange", "->", "All"}]}], 
                  "\[IndentingNewLine]", "]"}]}]}], "CodeInput", 
            CellChangeTimes -> {{3.742171171091352*^9, 3.742171285429866*^9}, 
              {3.742171337951318*^9, 3.742171357880814*^9}, 
              {3.7421713883213778*^9, 3.742171452858148*^9}, 
              3.742171514599457*^9, {3.742171547512232*^9, 
              3.742171588280095*^9}, {3.74217272834136*^9, 
              3.7421727932259083*^9}, {3.742172835587195*^9, 
              3.742172836843918*^9}, {3.742172887173143*^9, 
              3.7421729224170856*^9}, 3.742177448992095*^9, 
              3.742221049814476*^9, {3.742221084778159*^9, 
              3.742221098664056*^9}, {3.7422226121287613*^9, 
              3.74222261682747*^9}, {3.742225713502574*^9, 
              3.742225728245713*^9}, {3.742332164217422*^9, 
              3.742332170370467*^9}, {3.74235875902667*^9, 
              3.7423587595027533*^9}}, CellLabel -> "In[111]:="]}, Closed]], 
        Cell[CellGroupData[{Cell["\[LeftCeiling]Std\[RightFloor]", 
            "CodeSubsubsection", Evaluatable -> True, CellChangeTimes -> 
             {{3.742221116182931*^9, 3.742221117054401*^9}}], 
           Cell[BoxData[RowBox[{RowBox[{"If", "[", RowBox[
                  {RowBox[{"!", RowBox[{"MatchQ", "[", RowBox[{RowBox[
                          {"OwnValues", "[", "h5SampleSpectrum", "]"}], ",", 
                         " ", RowBox[{"{", RowBox[{"_", "\[RuleDelayed]", 
                          "_Image"}], "}"}]}], "]"}]}], ",", "\n", "\t", 
                   RowBox[{"h5SampleSpectrum", ":=", "\n", "\t\t", RowBox[
                      {"h5SampleSpectrum", "=", "\n", "\t", "\t\t", RowBox[
                        {"Import", "[", "\"~/Documents/UW/Research/H5+/Common\
/SampleSpectrum.png\"", "]"}]}]}]}], "\n", "\t", "]"}], ";"}]], "CodeInput"], 
           Cell[CellGroupData[{Cell["\[LeftCeiling]Lines\[RightFloor]", 
               "CodeSubsubsubsection", Evaluatable -> True, 
               CellChangeTimes -> {{3.742229893405809*^9, 
                3.742229897332612*^9}}], Cell[BoxData[{RowBox[{"H5PlotSpec", 
                   "//", "Clear"}], "\[IndentingNewLine]", RowBox[
                  {RowBox[{"H5PlotSpec", "[", "\[IndentingNewLine]", 
                     RowBox[{RowBox[{"specPts", ":", RowBox[{"{", RowBox[
                          {RowBox[{"{", RowBox[{"_", ",", " ", RowBox[{"_", 
                          "?", "NumericQ"}]}], "}"}], ",", " ", "___"}], 
                          "}"}]}], ",", " ", "\[IndentingNewLine]", RowBox[
                        {"shift", ":", RowBox[{RowBox[{"Offset", "[", RowBox[
                          {RowBox[{"_", "?", "NumericQ"}], ",", " ", RowBox[
                          {"Scaled", "[", RowBox[{"_", "?", "NumericQ"}], 
                          "]"}]}], "]"}], "|", RowBox[{"Offset", "[", RowBox[
                          {"_", "?", "NumericQ"}], "]"}], "|", "Automatic"}], 
                         ":", "Automatic"}], ",", "\[IndentingNewLine]", 
                       RowBox[{"threshold", ":", RowBox[{RowBox[{"_", "?", 
                          RowBox[{"(", RowBox[{RowBox[{"0", "<", "#", "<", 
                          "1"}], "&"}], ")"}]}], "|", "Automatic"}], ":", 
                         "Automatic"}], ",", "\[IndentingNewLine]", RowBox[
                        {"ops", ":", RowBox[{"OptionsPattern", "[", 
                          "ListPlot", "]"}]}]}], "\[IndentingNewLine]", 
                     "]"}], ":=", "\[IndentingNewLine]", RowBox[{"Overlay", 
                     "[", "\[IndentingNewLine]", RowBox[{"{", 
                       "\[IndentingNewLine]", RowBox[{RowBox[{"Image", "[", 
                          RowBox[{"h5SampleSpectrum", ",", RowBox[
                          {"ImageSize", "\[Rule]", RowBox[{RowBox[
                          {"ImageDimensions", "[", "h5SampleSpectrum", "]"}], 
                          "/", "2"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
                         RowBox[{"H5PlotSpecLines", "[", " ", 
                          "\[IndentingNewLine]", RowBox[{"specPts", ",", 
                          "\[IndentingNewLine]", RowBox[{"{", RowBox[{"4750", 
                          ",", " ", "7350"}], "}"}], ",", 
                          "\[IndentingNewLine]", RowBox[{"Scaled", "[", 
                          ".85", "]"}], ",", "\[IndentingNewLine]", "shift", 
                          ",", "\[IndentingNewLine]", "threshold", ",", 
                          "\[IndentingNewLine]", RowBox[{"PlotRange", 
                          "\[Rule]", RowBox[{"{", RowBox[{RowBox[{"{", RowBox[
                          {"4750", ",", " ", "7350"}], "}"}], ",", " ", 
                          RowBox[{"{", RowBox[{"0", ",", " ", "1"}], "}"}]}], 
                          "}"}]}], ",", "\[IndentingNewLine]", RowBox[
                          {"ImageSize", "\[Rule]", RowBox[{RowBox[{RowBox[
                          {"ImageDimensions", "[", "h5SampleSpectrum", "]"}], 
                          "/", "2"}], "-", RowBox[{"{", RowBox[{"0", ",", 
                          " ", "33"}], "}"}]}]}], ",", "\[IndentingNewLine]", 
                          RowBox[{"AspectRatio", "\[Rule]", "Full"}], ",", 
                          "\[IndentingNewLine]", RowBox[{"Axes", "\[Rule]", 
                          "False"}], ",", "\[IndentingNewLine]", RowBox[
                          {"Ticks", "\[Rule]", "None"}], ",", 
                          "\[IndentingNewLine]", "ops"}], 
                          "\[IndentingNewLine]", "]"}]}], 
                       "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", 
                     "]"}]}]}], "CodeInput", CellChangeTimes -> 
                {{3.741529763288176*^9, 3.7415299015978537*^9}, 
                 {3.7415299990279493*^9, 3.741530074310935*^9}, 
                 {3.741530123179831*^9, 3.7415302028826237*^9}, 
                 3.7421711794328413*^9, {3.742171226316614*^9, 
                 3.7421712565230083*^9}, {3.7421712882343187*^9, 
                 3.7421712928660593*^9}, {3.742171343624989*^9, 
                 3.74217134479184*^9}, {3.742171688339458*^9, 
                 3.7421716890304413*^9}, {3.7421728060550003*^9, 
                 3.742172849162321*^9}, {3.742222602936352*^9, 
                 3.742222605450062*^9}, {3.742225746245496*^9, 
                 3.742225749376485*^9}, {3.742332181521329*^9, 
                 3.742332187117833*^9}, 3.742358771329823*^9}, CellLabel -> 
                "In[114]:="]}, Closed]], Cell[CellGroupData[
             {Cell["\[LeftCeiling]Distribution\[RightFloor]", 
               "CodeSubsubsubsection", Evaluatable -> True, 
               CellChangeTimes -> {{3.742229893405809*^9, 
                3.742229905404395*^9}}], Cell[BoxData[
                {RowBox[{"H5PlotSpecBroadened", "//", "Clear"}], 
                 "\[IndentingNewLine]", RowBox[{RowBox[
                    {"H5PlotSpecBroadened", "[", "\[IndentingNewLine]", 
                     RowBox[{RowBox[{"specPts", ":", RowBox[{"{", RowBox[
                          {RowBox[{"{", RowBox[{"_", ",", " ", RowBox[{"_", 
                          "?", "NumericQ"}]}], "}"}], ",", " ", "___"}], 
                          "}"}]}], ",", " ", "\[IndentingNewLine]", RowBox[
                        {"broadening_", "?", "NumericQ"}], ",", 
                       "\[IndentingNewLine]", RowBox[{"shift", ":", RowBox[
                          {RowBox[{"Offset", "[", RowBox[{RowBox[{"_", "?", 
                          "NumericQ"}], ",", " ", RowBox[{"Scaled", "[", 
                          RowBox[{"_", "?", "NumericQ"}], "]"}]}], "]"}], 
                          "|", RowBox[{"Offset", "[", RowBox[{"_", "?", 
                          "NumericQ"}], "]"}], "|", "Automatic"}], ":", 
                         "Automatic"}], ",", "\[IndentingNewLine]", RowBox[
                        {"threshold", ":", RowBox[{RowBox[{"_", "?", RowBox[
                          {"(", RowBox[{RowBox[{"0", "<", "#", "<", "1"}], 
                          "&"}], ")"}]}], "|", "Automatic"}], ":", 
                         "Automatic"}], ",", "\[IndentingNewLine]", RowBox[
                        {"ops", ":", RowBox[{"OptionsPattern", "[", 
                          "ListPlot", "]"}]}]}], "\[IndentingNewLine]", 
                     "]"}], ":=", "\[IndentingNewLine]", RowBox[{"Overlay", 
                     "[", "\[IndentingNewLine]", RowBox[{"{", 
                       "\[IndentingNewLine]", RowBox[{RowBox[{"Image", "[", 
                          RowBox[{"h5SampleSpectrum", ",", RowBox[
                          {"ImageSize", "\[Rule]", RowBox[{RowBox[
                          {"ImageDimensions", "[", "h5SampleSpectrum", "]"}], 
                          "/", "2"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
                         RowBox[{"H5SpecGaussianBroadenedSpectrum", "[", " ", 
                          "\[IndentingNewLine]", RowBox[{"specPts", ",", 
                          "\[IndentingNewLine]", "broadening", ",", 
                          "\[IndentingNewLine]", RowBox[{"{", RowBox[{"4750", 
                          ",", " ", "7350"}], "}"}], ",", 
                          "\[IndentingNewLine]", RowBox[{"Scaled", "[", 
                          ".85", "]"}], ",", "\[IndentingNewLine]", "shift", 
                          ",", "\[IndentingNewLine]", "threshold", ",", 
                          "\[IndentingNewLine]", RowBox[{"PlotRange", 
                          "\[Rule]", RowBox[{"{", RowBox[{RowBox[{"{", RowBox[
                          {"4750", ",", " ", "7350"}], "}"}], ",", " ", 
                          RowBox[{"{", RowBox[{"0", ",", " ", "1"}], "}"}]}], 
                          "}"}]}], ",", "\[IndentingNewLine]", RowBox[
                          {"ImageSize", "\[Rule]", RowBox[{RowBox[{RowBox[
                          {"ImageDimensions", "[", "h5SampleSpectrum", "]"}], 
                          "/", "2"}], "-", RowBox[{"{", RowBox[{"0", ",", 
                          " ", "33"}], "}"}]}]}], ",", "\[IndentingNewLine]", 
                          RowBox[{"AspectRatio", "\[Rule]", "Full"}], ",", 
                          "\[IndentingNewLine]", RowBox[{"Axes", "\[Rule]", 
                          "False"}], ",", "\[IndentingNewLine]", RowBox[
                          {"Ticks", "\[Rule]", "None"}], ",", 
                          "\[IndentingNewLine]", "ops"}], 
                          "\[IndentingNewLine]", "]"}]}], 
                       "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", 
                     "]"}]}]}], "CodeInput", CellChangeTimes -> 
                {{3.741529763288176*^9, 3.7415299015978537*^9}, 
                 {3.7415299990279493*^9, 3.741530074310935*^9}, 
                 {3.741530123179831*^9, 3.7415302028826237*^9}, 
                 3.7421711794328413*^9, {3.742171226316614*^9, 
                 3.7421712565230083*^9}, {3.7421712882343187*^9, 
                 3.7421712928660593*^9}, {3.742171343624989*^9, 
                 3.74217134479184*^9}, {3.742171688339458*^9, 
                 3.7421716890304413*^9}, {3.7421728060550003*^9, 
                 3.742172849162321*^9}, {3.742222602936352*^9, 
                 3.742222605450062*^9}, {3.742225746245496*^9, 
                 3.742225749376485*^9}, {3.7422299295804443*^9, 
                 3.7422299643721533*^9}, {3.7423321937434587*^9, 
                 3.742332198658451*^9}, 3.7423587676662893*^9}, CellLabel -> 
                "In[116]:="]}, Closed]]}, Closed]], 
        Cell[CellGroupData[{Cell["\[LeftCeiling]Distributions\[RightFloor]", 
            "CodeSubsubsection", Evaluatable -> True, CellChangeTimes -> 
             {{3.74222101966615*^9, 3.74222102441997*^9}, 
             {3.742222737909382*^9, 3.742222739763679*^9}}], 
           Cell["\[LeftCeiling]This should be in the Graphics or something. \
At min the spectral processing stuff needs an update to work like \
this.\[RightFloor]", "Text", Evaluatable -> True, CellChangeTimes -> 
             {{3.7422259030765133*^9, 3.74222593099855*^9}}], 
           Cell["\[LeftCeiling]Done (10/20/2018)\[RightFloor]", "Text", 
            Evaluatable -> True], Cell[CellGroupData[
             {Cell["\[LeftCeiling]General\[RightFloor]", 
               "CodeSubsubsubsection", Evaluatable -> True, 
               CellChangeTimes -> {{3.7422236797464857*^9, 
                3.7422236804406424*^9}}], Cell[BoxData[
                {RowBox[{"H5SpecDistribution", "//", "Clear"}], 
                 "\[IndentingNewLine]", RowBox[{RowBox[{"H5SpecDistribution", 
                     "[", "\[IndentingNewLine]", RowBox[{RowBox[{"specPts", 
                         ":", RowBox[{"{", RowBox[{RowBox[{"{", RowBox[{"_", 
                          ",", " ", RowBox[{"_", "?", "NumericQ"}]}], "}"}], 
                          ",", " ", "___"}], "}"}]}], ",", 
                       "\[IndentingNewLine]", RowBox[{"distFuncs", ":", 
                         RowBox[{"{", RowBox[{RowBox[{"_Function", "|", 
                          "_Symbol"}], ",", " ", RowBox[{"_Function", "|", 
                          "_Symbol"}]}], "}"}]}], ",", " ", 
                       "\[IndentingNewLine]", RowBox[{"range", ":", RowBox[
                          {RowBox[{"{", RowBox[{RowBox[{"_", "?", 
                          "NumericQ"}], ",", RowBox[{"_", "?", 
                          "NumericQ"}]}], "}"}], "|", "Automatic"}], ":", 
                         "Automatic"}], ",", "\[IndentingNewLine]", RowBox[
                        {"scaling", ":", RowBox[{RowBox[{"Scaled", "[", 
                          RowBox[{"_", "?", "NumericQ"}], "]"}], "|", 
                          "Automatic"}], ":", "Automatic"}], ",", 
                       "\[IndentingNewLine]", RowBox[{"shift", ":", RowBox[
                          {RowBox[{"Offset", "[", RowBox[{RowBox[{"_", "?", 
                          "NumericQ"}], ",", " ", RowBox[{"Scaled", "[", 
                          RowBox[{"_", "?", "NumericQ"}], "]"}]}], "]"}], 
                          "|", RowBox[{"Offset", "[", RowBox[{"_", "?", 
                          "NumericQ"}], "]"}], "|", "Automatic"}], ":", 
                         "Automatic"}], ",", "\[IndentingNewLine]", RowBox[
                        {"threshold", ":", RowBox[{RowBox[{"_", "?", RowBox[
                          {"(", RowBox[{RowBox[{"0", "<", "#", "<", "1"}], 
                          "&"}], ")"}]}], "|", "Automatic"}], ":", 
                         "Automatic"}]}], "\[IndentingNewLine]", "]"}], ":=", 
                   "\[IndentingNewLine]", RowBox[{"Module", "[", 
                     "\[IndentingNewLine]", RowBox[{RowBox[{"{", 
                         "\[IndentingNewLine]", RowBox[{"sps", ",", 
                          "\[IndentingNewLine]", "ints", ",", 
                          "\[IndentingNewLine]", "pos", ",", 
                          "\[IndentingNewLine]", "dists", ",", 
                          "\[IndentingNewLine]", "weights"}], 
                         "\[IndentingNewLine]", "}"}], ",", 
                       "\[IndentingNewLine]", RowBox[{RowBox[{"sps", "=", 
                          RowBox[{"H5SpecPrep", "[", RowBox[{"specPts", ",", 
                          " ", "range", ",", "scaling", ",", "shift", ",", 
                          "threshold"}], "]"}]}], ";", "\[IndentingNewLine]", 
                         RowBox[{"ints", "=", RowBox[{"sps", "[", RowBox[
                          {"[", RowBox[{"All", ",", " ", "2"}], "]"}], 
                          "]"}]}], ";", "\[IndentingNewLine]", RowBox[
                          {"pos", "=", RowBox[{"sps", "[", RowBox[{"[", 
                          RowBox[{"All", ",", " ", "1"}], "]"}], "]"}]}], 
                         ";", "\[IndentingNewLine]", RowBox[{"dists", "=", 
                          RowBox[{RowBox[{"distFuncs", "[", RowBox[{"[", "1", 
                          "]"}], "]"}], "/@", "pos"}]}], ";", 
                         "\[IndentingNewLine]", RowBox[{"weights", "=", 
                          RowBox[{"MapThread", "[", RowBox[{RowBox[
                          {"distFuncs", "[", RowBox[{"[", "2", "]"}], "]"}], 
                          ",", " ", RowBox[{"{", RowBox[{"ints", ",", 
                          "dists"}], "}"}]}], "]"}]}], ";", 
                         "\[IndentingNewLine]", RowBox[
                          {"MixtureDistribution", "[", "\[IndentingNewLine]", 
                          RowBox[{RowBox[{RowBox[{"Max", "[", "ints", "]"}], 
                          "*", RowBox[{"weights", "/", RowBox[{"Max", "[", 
                          "weights", "]"}]}]}], ",", "\[IndentingNewLine]", 
                          "dists"}], "\[IndentingNewLine]", "]"}]}]}], 
                     "\[IndentingNewLine]", "]"}]}]}], "CodeInput", 
               CellChangeTimes -> {{3.7422218563632917*^9, 
                 3.742222076002173*^9}, {3.742222171281972*^9, 
                 3.742222179159761*^9}, 3.7422223152821083*^9, 
                 {3.742222572626171*^9, 3.742222576691728*^9}, 
                 {3.742222875091696*^9, 3.742222883681115*^9}, 
                 {3.74222307398135*^9, 3.742223074169639*^9}, 
                 {3.742223650007305*^9, 3.7422236541099873*^9}, 
                 {3.742224689915495*^9, 3.742224729393075*^9}, 
                 {3.742225631218143*^9, 3.7422256401440897*^9}, 
                 {3.742225755409676*^9, 3.742225760054946*^9}, 
                 3.7423322069599457*^9}, CellLabel -> "In[118]:="]}, 
             Closed]], Cell[CellGroupData[
             {Cell["\[LeftCeiling]Gaussian Broadening\[RightFloor]", 
               "CodeSubsubsubsection", Evaluatable -> True, 
               CellChangeTimes -> {{3.742223571543468*^9, 
                3.742223575552219*^9}}], Cell[BoxData[
                {RowBox[{"H5SpecGaussianBroadening", "//", "Clear"}], 
                 "\[IndentingNewLine]", RowBox[{RowBox[
                    {"H5SpecGaussianBroadening", "[", "\[IndentingNewLine]", 
                     RowBox[{RowBox[{"specPts", ":", RowBox[{"{", RowBox[
                          {RowBox[{"{", RowBox[{"_", ",", " ", RowBox[{"_", 
                          "?", "NumericQ"}]}], "}"}], ",", " ", "___"}], 
                          "}"}]}], ",", " ", "\[IndentingNewLine]", RowBox[
                        {"broadness_", "?", RowBox[{"(", RowBox[{RowBox[
                          {RowBox[{"NumericQ", "[", "#", "]"}], "&&", RowBox[
                          {"Positive", "[", "#", "]"}]}], "&"}], ")"}]}], 
                       ",", "\[IndentingNewLine]", RowBox[{"range", ":", 
                         RowBox[{RowBox[{"{", RowBox[{RowBox[{"_", "?", 
                          "NumericQ"}], ",", RowBox[{"_", "?", 
                          "NumericQ"}]}], "}"}], "|", "Automatic"}], ":", 
                         "Automatic"}], ",", "\[IndentingNewLine]", RowBox[
                        {"scaling", ":", RowBox[{RowBox[{"Scaled", "[", 
                          RowBox[{"_", "?", "NumericQ"}], "]"}], "|", 
                          "Automatic"}], ":", "Automatic"}], ",", 
                       "\[IndentingNewLine]", RowBox[{"shift", ":", RowBox[
                          {RowBox[{"Offset", "[", RowBox[{RowBox[{"_", "?", 
                          "NumericQ"}], ",", " ", RowBox[{"Scaled", "[", 
                          RowBox[{"_", "?", "NumericQ"}], "]"}]}], "]"}], 
                          "|", RowBox[{"Offset", "[", RowBox[{"_", "?", 
                          "NumericQ"}], "]"}], "|", "Automatic"}], ":", 
                         "Automatic"}], ",", "\[IndentingNewLine]", RowBox[
                        {"threshold", ":", RowBox[{RowBox[{"_", "?", RowBox[
                          {"(", RowBox[{RowBox[{"0", "<", "#", "<", "1"}], 
                          "&"}], ")"}]}], "|", "Automatic"}], ":", 
                         "Automatic"}]}], "\[IndentingNewLine]", "]"}], ":=", 
                   "\[IndentingNewLine]", RowBox[{"H5SpecDistribution", "[", 
                     "\[IndentingNewLine]", RowBox[{"specPts", ",", 
                       "\[IndentingNewLine]", RowBox[{"{", RowBox[
                          {RowBox[{RowBox[{"NormalDistribution", "[", RowBox[
                          {"#", ",", " ", "broadness"}], "]"}], "&"}], ",", 
                          " ", RowBox[{RowBox[{"#", "/", RowBox[{"(", RowBox[
                          {"broadness", "*", RowBox[{"Sqrt", "[", RowBox[
                          {"2", "\[Pi]"}], "]"}]}], ")"}]}], "&"}]}], "}"}], 
                       ",", "\[IndentingNewLine]", "range", ",", 
                       "\[IndentingNewLine]", "scaling", ",", 
                       "\[IndentingNewLine]", "shift", ",", 
                       "\[IndentingNewLine]", "threshold"}], 
                     "\[IndentingNewLine]", "]"}]}]}], "CodeInput", 
               CellChangeTimes -> {{3.7422211272951097*^9, 
                 3.742221237617214*^9}, {3.74222128970198*^9, 
                 3.742221293807548*^9}, {3.7422216298878307*^9, 
                 3.742221718410665*^9}, {3.742221748824585*^9, 
                 3.7422217708404293*^9}, {3.742221802324132*^9, 
                 3.742221804699945*^9}, {3.742222321408369*^9, 
                 3.7422223806255617*^9}, {3.742222530190317*^9, 
                 3.7422225539907913*^9}, {3.74222576685275*^9, 
                 3.742225771104496*^9}, 3.742332213967433*^9}, CellLabel -> 
                "In[120]:="]}, Closed]], Cell[CellGroupData[
             {Cell["\[LeftCeiling]Lorentzian Broadening\[RightFloor]", 
               "CodeSubsubsubsection", Evaluatable -> True, 
               CellChangeTimes -> {{3.742223571543468*^9, 
                3.7422235822741833*^9}}], Cell[BoxData[
                {RowBox[{"H5SpecLorentzianBroadening", "//", "Clear"}], "\n", 
                 RowBox[{RowBox[{"H5SpecLorentzianBroadening", "[", 
                     "\[IndentingNewLine]", RowBox[{RowBox[{"specPts", ":", 
                         RowBox[{"{", RowBox[{RowBox[{"{", RowBox[{"_", ",", 
                          " ", RowBox[{"_", "?", "NumericQ"}]}], "}"}], ",", 
                          " ", "___"}], "}"}]}], ",", " ", 
                       "\[IndentingNewLine]", RowBox[{"broadness_", "?", 
                         RowBox[{"(", RowBox[{RowBox[{RowBox[{"NumericQ", 
                          "[", "#", "]"}], "&&", RowBox[{"Positive", "[", 
                          "#", "]"}]}], "&"}], ")"}]}], ",", 
                       "\[IndentingNewLine]", RowBox[{"range", ":", RowBox[
                          {RowBox[{"{", RowBox[{RowBox[{"_", "?", 
                          "NumericQ"}], ",", RowBox[{"_", "?", 
                          "NumericQ"}]}], "}"}], "|", "Automatic"}], ":", 
                         "Automatic"}], ",", "\[IndentingNewLine]", RowBox[
                        {"scaling", ":", RowBox[{RowBox[{"Scaled", "[", 
                          RowBox[{"_", "?", "NumericQ"}], "]"}], "|", 
                          "Automatic"}], ":", "Automatic"}], ",", 
                       "\[IndentingNewLine]", RowBox[{"shift", ":", RowBox[
                          {RowBox[{"Offset", "[", RowBox[{RowBox[{"_", "?", 
                          "NumericQ"}], ",", " ", RowBox[{"Scaled", "[", 
                          RowBox[{"_", "?", "NumericQ"}], "]"}]}], "]"}], 
                          "|", RowBox[{"Offset", "[", RowBox[{"_", "?", 
                          "NumericQ"}], "]"}], "|", "Automatic"}], ":", 
                         "Automatic"}], ",", "\[IndentingNewLine]", RowBox[
                        {"threshold", ":", RowBox[{RowBox[{"_", "?", RowBox[
                          {"(", RowBox[{RowBox[{"0", "<", "#", "<", "1"}], 
                          "&"}], ")"}]}], "|", "Automatic"}], ":", 
                         "Automatic"}]}], "\[IndentingNewLine]", "]"}], ":=", 
                   "\[IndentingNewLine]", RowBox[{"H5SpecDistribution", "[", 
                     "\[IndentingNewLine]", RowBox[{"specPts", ",", 
                       "\[IndentingNewLine]", RowBox[{"{", RowBox[
                          {RowBox[{RowBox[{"CauchyDistribution", "[", RowBox[
                          {"#", ",", " ", "broadness"}], "]"}], "&"}], ",", 
                          " ", RowBox[{RowBox[{"#", "/", RowBox[{"(", RowBox[
                          {"broadness", "*", RowBox[{"Sqrt", "[", "\[Pi]", 
                          "]"}]}], ")"}]}], "&"}]}], "}"}], ",", 
                       "\[IndentingNewLine]", "range", ",", 
                       "\[IndentingNewLine]", "scaling", ",", 
                       "\[IndentingNewLine]", "shift", ",", 
                       "\[IndentingNewLine]", "threshold"}], 
                     "\[IndentingNewLine]", "]"}]}]}], "CodeInput", 
               CellChangeTimes -> {{3.742225785078072*^9, 
                 3.7422257877927237*^9}, 3.742332220575645*^9}, CellLabel -> 
                "In[122]:="]}, Closed]], Cell[CellGroupData[
             {Cell["\[LeftCeiling]Plot\[RightFloor]", "CodeSubsubsubsection", 
               Evaluatable -> True], Cell["Assumes each distribution has a \
position parameter first, then a std-dev parameter", "Text", 
               CellChangeTimes -> {{3.7422245944789143*^9, 
                3.7422246112482147*^9}}], Cell[BoxData[
                {RowBox[{"H5SpecDistributionPlot", "//", "Clear"}], 
                 "\[IndentingNewLine]", RowBox[{RowBox[{RowBox[
                      {"H5SpecDistributionPlot", "[", "\[IndentingNewLine]", 
                       RowBox[{RowBox[{"dist", ":", "_MixtureDistribution"}], 
                         ",", "\[IndentingNewLine]", RowBox[{"ops", ":", 
                          RowBox[{"OptionsPattern", "[", "]"}]}]}], 
                       "\[IndentingNewLine]", "]"}], ":=", 
                     "\[IndentingNewLine]", RowBox[{"Module", "[", 
                       "\[IndentingNewLine]", RowBox[{RowBox[{"{", 
                          "\[IndentingNewLine]", RowBox[{RowBox[{"dists", 
                          "=", RowBox[{"SortBy", "[", RowBox[{RowBox[{"Last", 
                          "[", "dist", "]"}], ",", " ", "First"}], "]"}]}], 
                          ",", "\[IndentingNewLine]", RowBox[{"distmax", "=", 
                          RowBox[{RowBox[{"Ordering", "[", RowBox[{RowBox[
                          {"First", "@", "dist"}], ",", " ", RowBox[{"-", 
                          "1"}]}], "]"}], "[", RowBox[{"[", "1", "]"}], 
                          "]"}]}], ",", "\[IndentingNewLine]", "dmpos", ",", 
                          "\[IndentingNewLine]", "prang", ",", 
                          "\[IndentingNewLine]", "pdf", ",", 
                          "\[IndentingNewLine]", "dmval", ",", 
                          "\[IndentingNewLine]", "dmtarg"}], 
                          "\[IndentingNewLine]", "}"}], ",", 
                         "\[IndentingNewLine]", RowBox[{RowBox[{"dmpos", "=", 
                          RowBox[{RowBox[{"Extract", "[", RowBox[{RowBox[
                          {"Last", "@", "dist"}], ",", " ", "distmax"}], 
                          "]"}], "[", RowBox[{"[", "1", "]"}], "]"}]}], ";", 
                          "\[IndentingNewLine]", RowBox[{"dmtarg", "=", 
                          RowBox[{"Extract", "[", RowBox[{RowBox[{"First", 
                          "@", "dist"}], ",", " ", "distmax"}], "]"}]}], ";", 
                          "\[IndentingNewLine]", RowBox[{"prang", "=", 
                          RowBox[{RowBox[{"{", RowBox[{RowBox[{"dists", "[", 
                          RowBox[{"[", RowBox[{"1", ",", " ", "1"}], "]"}], 
                          "]"}], ",", " ", RowBox[{"dists", "[", RowBox[{"[", 
                          RowBox[{RowBox[{"-", "1"}], ",", " ", "1"}], "]"}], 
                          "]"}]}], "}"}], "+", RowBox[{"10", "*", RowBox[
                          {"{", RowBox[{RowBox[{"-", RowBox[{"dists", "[", 
                          RowBox[{"[", RowBox[{"1", ",", " ", "2"}], "]"}], 
                          "]"}]}], ",", " ", RowBox[{"dists", "[", RowBox[
                          {"[", RowBox[{RowBox[{"-", "1"}], ",", " ", "2"}], 
                          "]"}], "]"}]}], "}"}]}]}]}], ";", 
                          "\[IndentingNewLine]", RowBox[{"dmpos", "=", 
                          RowBox[{RowBox[{"Extract", "[", RowBox[{RowBox[
                          {"Last", "@", "dist"}], ",", " ", RowBox[
                          {"Ordering", "[", RowBox[{RowBox[{"First", "@", 
                          "dist"}], ",", " ", RowBox[{"-", "1"}]}], "]"}]}], 
                          "]"}], "[", RowBox[{"[", "1", "]"}], "]"}]}], ";", 
                          "\[IndentingNewLine]", RowBox[{"pdf", "=", RowBox[
                          {"PDF", "[", "dist", "]"}]}], ";", 
                          "\[IndentingNewLine]", RowBox[{"dmval", "=", 
                          RowBox[{"Quiet", "[", RowBox[{RowBox[{"pdf", "[", 
                          "dmpos", "]"}], ",", " ", RowBox[{"General", "::", 
                          "munfl"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                          RowBox[{"Quiet", "[", "\[IndentingNewLine]", 
                          RowBox[{RowBox[{"Plot", "[", RowBox[{RowBox[
                          {FractionBox["dmtarg", "dmval"], RowBox[{"pdf", 
                          "[", "\[Omega]", "]"}]}], ",", " ", RowBox[{"{", 
                          RowBox[{"\[Omega]", ",", " ", RowBox[{"prang", "[", 
                          RowBox[{"[", "1", "]"}], "]"}], ",", " ", RowBox[
                          {"prang", "[", RowBox[{"[", "2", "]"}], "]"}]}], 
                          "}"}], ",", " ", "ops", ",", " ", 
                          "\[IndentingNewLine]", RowBox[{"Axes", "\[Rule]", 
                          RowBox[{"{", RowBox[{"True", ",", " ", "False"}], 
                          "}"}]}], ",", "\[IndentingNewLine]", " ", RowBox[
                          {"PlotRange", "\[Rule]", "All"}], ",", 
                          "\[IndentingNewLine]", RowBox[{"PlotStyle", 
                          "\[Rule]", "Red"}]}], "\[IndentingNewLine]", "]"}], 
                          ",", "\[IndentingNewLine]", RowBox[{"General", 
                          "::", "munfl"}]}], "\[IndentingNewLine]", 
                          "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
                 "\n", RowBox[{RowBox[{"H5SpecDistributionPlot", "[", 
                     "\[IndentingNewLine]", RowBox[{RowBox[{"specPts", ":", 
                         RowBox[{"{", RowBox[{RowBox[{"{", RowBox[{"_", ",", 
                          " ", RowBox[{"_", "?", "NumericQ"}]}], "}"}], ",", 
                          " ", "___"}], "}"}]}], ",", "\[IndentingNewLine]", 
                       RowBox[{"distFuncs", ":", RowBox[{"{", RowBox[
                          {RowBox[{"_Function", "|", "_Symbol"}], ",", " ", 
                          RowBox[{"_Function", "|", "_Symbol"}]}], "}"}]}], 
                       ",", " ", "\[IndentingNewLine]", RowBox[{"range", ":", 
                         RowBox[{RowBox[{"{", RowBox[{RowBox[{"_", "?", 
                          "NumericQ"}], ",", RowBox[{"_", "?", 
                          "NumericQ"}]}], "}"}], "|", "Automatic"}], ":", 
                         "Automatic"}], ",", "\[IndentingNewLine]", RowBox[
                        {"scaling", ":", RowBox[{RowBox[{"Scaled", "[", 
                          RowBox[{"_", "?", "NumericQ"}], "]"}], "|", 
                          "Automatic"}], ":", "Automatic"}], ",", 
                       "\[IndentingNewLine]", RowBox[{"shift", ":", RowBox[
                          {RowBox[{"_", "?", "NumericQ"}], "|", 
                          "Automatic"}], ":", "Automatic"}], ",", 
                       "\[IndentingNewLine]", RowBox[{"threshold", ":", 
                         RowBox[{RowBox[{"_", "?", RowBox[{"(", RowBox[
                          {RowBox[{"0", "<", "#", "<", "1"}], "&"}], ")"}]}], 
                          "|", "Automatic"}], ":", "Automatic"}], ",", 
                       "\[IndentingNewLine]", RowBox[{"ops", ":", RowBox[
                          {"OptionsPattern", "[", "]"}]}]}], 
                     "\[IndentingNewLine]", "]"}], ":=", 
                   "\[IndentingNewLine]", RowBox[{"H5SpecDistributionPlot", 
                     "[", "\[IndentingNewLine]", RowBox[{RowBox[
                        {"H5SpecDistribution", "[", RowBox[{"specPts", ",", 
                          " ", "distFuncs", ",", " ", "range", ",", " ", 
                          "scaling", ",", " ", "shift", ",", " ", 
                          "threshold"}], "]"}], ",", " ", 
                       "\[IndentingNewLine]", "ops"}], "\[IndentingNewLine]", 
                     "]"}]}]}], "CodeInput", CellChangeTimes -> 
                {{3.742223691188532*^9, 3.7422237266482897*^9}, 
                {3.742223760852757*^9, 3.742223808229498*^9}, 
                {3.742224303530252*^9, 3.742224653634986*^9}, 
                {3.742224749384532*^9, 3.74222496693091*^9}, 
                {3.742224999731101*^9, 3.742224999895537*^9}, 
                {3.742225851926931*^9, 3.742225856840509*^9}, 
                {3.74223020890938*^9, 3.742230218317916*^9}}, CellLabel -> 
                "In[124]:="]}, Closed]], Cell[CellGroupData[
             {Cell["\[LeftCeiling]Gaussian Broadened Spectrum\[RightFloor]", 
               "CodeSubsubsubsection", Evaluatable -> True, 
               CellChangeTimes -> {3.74222518332137*^9, 
                 {3.742225326434523*^9, 3.742225328613233*^9}}], 
              Cell[BoxData[{RowBox[{"H5SpecGaussianBroadenedSpectrum", "//", 
                   "Clear"}], "\[IndentingNewLine]", RowBox[
                  {RowBox[{"H5SpecGaussianBroadenedSpectrum", "[", 
                     "\[IndentingNewLine]", RowBox[{RowBox[{"specPts", ":", 
                         RowBox[{"{", RowBox[{RowBox[{"{", RowBox[{"_", ",", 
                          " ", RowBox[{"_", "?", "NumericQ"}]}], "}"}], ",", 
                          " ", "___"}], "}"}]}], ",", " ", 
                       "\[IndentingNewLine]", RowBox[{"broadness_", "?", 
                         RowBox[{"(", RowBox[{RowBox[{RowBox[{"NumericQ", 
                          "[", "#", "]"}], "&&", RowBox[{"Positive", "[", 
                          "#", "]"}]}], "&"}], ")"}]}], ",", 
                       "\[IndentingNewLine]", RowBox[{"range", ":", RowBox[
                          {RowBox[{"{", RowBox[{RowBox[{"_", "?", 
                          "NumericQ"}], ",", RowBox[{"_", "?", 
                          "NumericQ"}]}], "}"}], "|", "Automatic"}], ":", 
                         "Automatic"}], ",", "\[IndentingNewLine]", RowBox[
                        {"scaling", ":", RowBox[{RowBox[{"Scaled", "[", 
                          RowBox[{"_", "?", "NumericQ"}], "]"}], "|", 
                          "Automatic"}], ":", "Automatic"}], ",", 
                       "\[IndentingNewLine]", RowBox[{"shift", ":", RowBox[
                          {RowBox[{"Offset", "[", RowBox[{RowBox[{"_", "?", 
                          "NumericQ"}], ",", " ", RowBox[{"Scaled", "[", 
                          RowBox[{"_", "?", "NumericQ"}], "]"}]}], "]"}], 
                          "|", RowBox[{"Offset", "[", RowBox[{"_", "?", 
                          "NumericQ"}], "]"}], "|", "Automatic"}], ":", 
                         "Automatic"}], ",", "\[IndentingNewLine]", RowBox[
                        {"threshold", ":", RowBox[{RowBox[{"_", "?", RowBox[
                          {"(", RowBox[{RowBox[{"0", "<", "#", "<", "1"}], 
                          "&"}], ")"}]}], "|", "Automatic"}], ":", 
                         "Automatic"}], ",", "\[IndentingNewLine]", RowBox[
                        {"ops", ":", RowBox[{"OptionsPattern", "[", 
                          "]"}]}]}], "\[IndentingNewLine]", "]"}], ":=", 
                   "\[IndentingNewLine]", RowBox[{"H5SpecDistributionPlot", 
                     "[", "\[IndentingNewLine]", RowBox[{RowBox[
                        {"H5SpecGaussianBroadening", "[", RowBox[{"specPts", 
                          ",", " ", "broadness", ",", " ", "range", ",", " ", 
                          "scaling", ",", " ", "shift", ",", " ", 
                          "threshold"}], "]"}], ",", " ", 
                       "\[IndentingNewLine]", "ops"}], "\[IndentingNewLine]", 
                     "]"}]}]}], "CodeInput", CellChangeTimes -> 
                {{3.7422211272951097*^9, 3.742221237617214*^9}, 
                 {3.74222128970198*^9, 3.742221293807548*^9}, 
                 {3.7422216298878307*^9, 3.742221718410665*^9}, 
                 {3.742221748824585*^9, 3.7422217708404293*^9}, 
                 {3.742221802324132*^9, 3.742221804699945*^9}, 
                 {3.742222321408369*^9, 3.7422223806255617*^9}, 
                 {3.742222530190317*^9, 3.7422225539907913*^9}, 
                 {3.742225180058443*^9, 3.742225181710834*^9}, 
                 {3.742225232604382*^9, 3.7422252491886187*^9}, 
                 {3.742230137547077*^9, 3.742230145680256*^9}, 
                 3.742332227560672*^9, 3.7423587884336443*^9}, CellLabel -> 
                "In[127]:="]}, Closed]], Cell[CellGroupData[
             {Cell[
               "\[LeftCeiling]Lorentzian Broadened Spectrum\[RightFloor]", 
               "CodeSubsubsubsection", Evaluatable -> True, 
               CellChangeTimes -> {3.74222518332137*^9, 
                 {3.742225257458488*^9, 3.742225259542576*^9}, 
                 {3.742225330205426*^9, 3.742225333037196*^9}}], 
              Cell[BoxData[{RowBox[{"H5SpecLorentzianBroadenedSpectrum", 
                   "//", "Clear"}], "\[IndentingNewLine]", RowBox[
                  {RowBox[{"H5SpecLorentzianBroadenedSpectrum", "[", 
                     "\[IndentingNewLine]", RowBox[{RowBox[{"specPts", ":", 
                         RowBox[{"{", RowBox[{RowBox[{"{", RowBox[{"_", ",", 
                          " ", RowBox[{"_", "?", "NumericQ"}]}], "}"}], ",", 
                          " ", "___"}], "}"}]}], ",", " ", 
                       "\[IndentingNewLine]", RowBox[{"broadness_", "?", 
                         RowBox[{"(", RowBox[{RowBox[{RowBox[{"NumericQ", 
                          "[", "#", "]"}], "&&", RowBox[{"Positive", "[", 
                          "#", "]"}]}], "&"}], ")"}]}], ",", 
                       "\[IndentingNewLine]", RowBox[{"range", ":", RowBox[
                          {RowBox[{"{", RowBox[{RowBox[{"_", "?", 
                          "NumericQ"}], ",", RowBox[{"_", "?", 
                          "NumericQ"}]}], "}"}], "|", "Automatic"}], ":", 
                         "Automatic"}], ",", "\[IndentingNewLine]", RowBox[
                        {"scaling", ":", RowBox[{RowBox[{"Scaled", "[", 
                          RowBox[{"_", "?", "NumericQ"}], "]"}], "|", 
                          "Automatic"}], ":", "Automatic"}], ",", 
                       "\[IndentingNewLine]", RowBox[{"shift", ":", RowBox[
                          {RowBox[{"Offset", "[", RowBox[{RowBox[{"_", "?", 
                          "NumericQ"}], ",", " ", RowBox[{"Scaled", "[", 
                          RowBox[{"_", "?", "NumericQ"}], "]"}]}], "]"}], 
                          "|", RowBox[{"Offset", "[", RowBox[{"_", "?", 
                          "NumericQ"}], "]"}], "|", "Automatic"}], ":", 
                         "Automatic"}], ",", "\[IndentingNewLine]", RowBox[
                        {"threshold", ":", RowBox[{RowBox[{"_", "?", RowBox[
                          {"(", RowBox[{RowBox[{"0", "<", "#", "<", "1"}], 
                          "&"}], ")"}]}], "|", "Automatic"}], ":", 
                         "Automatic"}], ",", "\[IndentingNewLine]", RowBox[
                        {"ops", ":", RowBox[{"OptionsPattern", "[", 
                          "]"}]}]}], "\[IndentingNewLine]", "]"}], ":=", 
                   "\[IndentingNewLine]", RowBox[{"H5SpecDistributionPlot", 
                     "[", "\[IndentingNewLine]", RowBox[{RowBox[
                        {"H5SpecLorentzianBroadening", "[", RowBox[
                          {"specPts", ",", " ", "broadness", ",", " ", 
                          "range", ",", " ", "scaling", ",", " ", "shift", 
                          ",", " ", "threshold"}], "]"}], ",", " ", 
                       "\[IndentingNewLine]", "ops"}], "\[IndentingNewLine]", 
                     "]"}]}]}], "CodeInput", CellChangeTimes -> 
                {{3.7422211272951097*^9, 3.742221237617214*^9}, 
                 {3.74222128970198*^9, 3.742221293807548*^9}, 
                 {3.7422216298878307*^9, 3.742221718410665*^9}, 
                 {3.742221748824585*^9, 3.7422217708404293*^9}, 
                 {3.742221802324132*^9, 3.742221804699945*^9}, 
                 {3.742222321408369*^9, 3.7422223806255617*^9}, 
                 {3.742222530190317*^9, 3.7422225539907913*^9}, 
                 {3.742225180058443*^9, 3.742225181710834*^9}, 
                 {3.742225232604382*^9, 3.7422252661776667*^9}, 
                 {3.74222580484422*^9, 3.742225808572702*^9}, 
                 3.7423322323515043*^9}, CellLabel -> "In[129]:="]}, 
             Closed]]}, Open]]}, Open]], 
     Cell[CellGroupData[
       {Cell["\[LeftCeiling]State Assignment Things\[RightFloor]", 
         "CodeSubsection", Evaluatable -> True, CellChangeTimes -> 
          {{3.744496694540657*^9, 3.744496699471797*^9}, 
          {3.7444967321726303*^9, 3.744496736071228*^9}}], 
        Cell[CellGroupData[{Cell["\[LeftCeiling]Common\[RightFloor]", 
            "CodeSubsubsection", Evaluatable -> True, CellChangeTimes -> 
             {{3.744493181407463*^9, 3.744493189020954*^9}}], 
           Cell[BoxData[RowBox[{RowBox[
                {"$iH5FormatStatePercentTableRelativeIntensities", "=", 
                 "True"}], ";"}]], "CodeInput", CellChangeTimes -> 
             {{3.742431053298461*^9, 3.742431061642541*^9}}, 
            CellLabel -> "In[131]:="], Cell[BoxData[
             RowBox[{RowBox[{RowBox[{"iH5CalculateStatePercents", "[", 
                   "vecs_", "]"}], ":=", "\[IndentingNewLine]", 
                 RowBox[{"100", "*", "\[IndentingNewLine]", RowBox[{"Round", 
                     "[", "\[IndentingNewLine]", RowBox[{RowBox[{"Power", 
                         "[", "\[IndentingNewLine]", RowBox[{"vecs", ",", 
                          "\[IndentingNewLine]", "2"}], 
                         "\[IndentingNewLine]", "]"}], ",", " ", 
                       "\[IndentingNewLine]", ".05"}], "\[IndentingNewLine]", 
                     "]"}]}]}], ";"}]], "CodeInput", CellChangeTimes -> 
             {{3.744493292409354*^9, 3.744493309958538*^9}, 
             {3.744493621802887*^9, 3.744493622271143*^9}, 
             {3.7445626565930443*^9, 3.744562660446527*^9}}, 
            CellLabel -> "In[132]:="], Cell[BoxData[
             RowBox[{RowBox[{RowBox[{"iH5FormatStatePercentPlot", "[", 
                   "vecs_", "]"}], ":=", "\[IndentingNewLine]", 
                 RowBox[{"MatrixPlot", "[", "\[IndentingNewLine]", 
                   RowBox[{RowBox[{"iH5CalculateStatePercents", "@", 
                       "vecs"}], ",", "\[IndentingNewLine]", RowBox[
                      {"PlotRangePadding", "\[Rule]", "None"}], ",", 
                     "\[IndentingNewLine]", RowBox[{"ImageMargins", "->", 
                       "None"}], ",", "\[IndentingNewLine]", RowBox[
                      {"ImagePadding", "\[Rule]", "None"}]}], 
                   "\[IndentingNewLine]", "]"}]}], ";"}]], "CodeInput", 
            CellChangeTimes -> {{3.744493623830308*^9, 
              3.7444936369590187*^9}, 3.744493722073265*^9, 
              {3.7444944196194563*^9, 3.744494445737891*^9}}, 
            CellLabel -> "In[133]:="], Cell[BoxData[
             RowBox[{RowBox[{"iH5FormatStatePercentTable", "[", 
                 RowBox[{"vecs_", ",", " ", "headers_", ",", " ", "states_", 
                   ",", " ", RowBox[{"ops", ":", RowBox[{"OptionsPattern", 
                       "[", "]"}]}]}], "]"}], ":=", "\[IndentingNewLine]", 
               RowBox[{RowBox[{"Grid", "[", "\[IndentingNewLine]", 
                   RowBox[{RowBox[{RowBox[{"Prepend", "[", RowBox[{"Join", 
                          "[", RowBox[{RowBox[{"{", RowBox[{"\"\[ScriptF]\"", 
                          ",", " ", "\"\[ScriptCapitalI]\""}], "}"}], ",", 
                          " ", "headers"}], "]"}], "]"}], "@", 
                       "\[IndentingNewLine]", RowBox[{"Join", "[", 
                         "\[IndentingNewLine]", RowBox[{RowBox[{"Round", "[", 
                          RowBox[{RowBox[{"List", "/@", RowBox[{RowBox[
                          {"Prepend", "[", RowBox[{RowBox[{"$H5Data", "[", 
                          RowBox[{"$H5Key", ",", " ", "\"Frequencies\""}], 
                          "]"}], ",", " ", "0"}], "]"}], "[", RowBox[{"[", 
                          "states", "]"}], "]"}]}], ",", " ", "1"}], "]"}], 
                          ",", "\[IndentingNewLine]", RowBox[{"List", "/@", 
                          "\[IndentingNewLine]", RowBox[{RowBox[{"If", "[", 
                          RowBox[{RowBox[{"TrueQ", "@", 
                          "$iH5FormatStatePercentTableRelativeIntensities"}], 
                          ",", "\[IndentingNewLine]", RowBox[{RowBox[{"Map", 
                          "[", "\[IndentingNewLine]", RowBox[{RowBox[{RowBox[
                          {"If", "[", RowBox[{RowBox[{"#", "<", "0.0001"}], 
                          ",", " ", RowBox[{"ScientificForm", "[", RowBox[
                          {"#", ",", " ", "2"}], "]"}], ",", " ", RowBox[
                          {"Round", "[", RowBox[{"#", ",", " ", ".01"}], 
                          "]"}]}], "]"}], "&"}], ",", "\[IndentingNewLine]", 
                          RowBox[{"100", "*", RowBox[{"#", "/", RowBox[
                          {"Max", "[", "#", "]"}]}]}]}], 
                          "\[IndentingNewLine]", "]"}], "&"}], ",", 
                          "\[IndentingNewLine]", RowBox[{"Map", "[", RowBox[
                          {RowBox[{"ScientificForm", "[", RowBox[{"#", ",", 
                          " ", "2"}], "]"}], "&"}], "]"}]}], 
                          "\[IndentingNewLine]", "]"}], "@", RowBox[{RowBox[
                          {"$H5Data", "[", RowBox[{"$H5Key", ",", " ", 
                          "\"Intensities\""}], "]"}], "[", RowBox[{"[", 
                          "states", "]"}], "]"}]}]}], ",", 
                          "\[IndentingNewLine]", RowBox[
                          {"iH5CalculateStatePercents", "[", "vecs", "]"}], 
                          ",", "\[IndentingNewLine]", "2"}], 
                         "\[IndentingNewLine]", "]"}]}], ",", 
                     "\[IndentingNewLine]", "ops", ",", 
                     "\[IndentingNewLine]", RowBox[{"Alignment", "\[Rule]", 
                       "Left"}], ",", "\[IndentingNewLine]", RowBox[
                      {"Dividers", "\[Rule]", RowBox[{"{", RowBox[
                          {RowBox[{"{", RowBox[{"3", "\[Rule]", "Gray"}], 
                          "}"}], ",", " ", RowBox[{"{", RowBox[{"2", 
                          "\[Rule]", "Gray"}], "}"}]}], "}"}]}], ",", 
                     "\[IndentingNewLine]", RowBox[{"ItemSize", "\[Rule]", 
                       "Full"}]}], "\[IndentingNewLine]", "]"}], "//", 
                 RowBox[{RowBox[{"Style", "[", RowBox[{"#", ",", " ", 
                       RowBox[{"ShowStringCharacters", "\[Rule]", 
                         "False"}]}], "]"}], "&"}]}]}]], "CodeInput", 
            CellChangeTimes -> {{3.742428745953677*^9, 
              3.7424287949129467*^9}, {3.742428830097877*^9, 
              3.742428961279872*^9}, {3.74242963637012*^9, 
              3.7424296507178907*^9}, {3.742429748749544*^9, 
              3.74242975695573*^9}, {3.742429787218989*^9, 
              3.742429798007285*^9}, {3.742429939058063*^9, 
              3.742429944401403*^9}, {3.742430032371455*^9, 
              3.742430037355962*^9}, {3.74243106621486*^9, 
              3.74243111749086*^9}, {3.742431153950389*^9, 
              3.742431154444684*^9}, {3.742431192449615*^9, 
              3.742431408386736*^9}, {3.742431442863346*^9, 
              3.742431488442011*^9}, 3.742440421489999*^9, 
              {3.7425108070969877*^9, 3.742510825971485*^9}, 
              {3.742512357036646*^9, 3.742512358904601*^9}, 
              {3.744493289333338*^9, 3.744493316902524*^9}}, 
            CellLabel -> "In[134]:="]}, Closed]], 
        Cell[CellGroupData[{Cell["\[LeftCeiling]H2\[RightFloor]", 
            "CodeSubsubsection", Evaluatable -> True, CellChangeTimes -> 
             {{3.744493181407463*^9, 3.744493195556757*^9}}], 
           Cell[BoxData[RowBox[{"(*", RowBox[{RowBox[
                  {"H5FormatH2StatePercentTable", "[", "states_", "]"}], 
                 ":=", "\[IndentingNewLine]", RowBox[
                  {"iH5FormatStatePercentTable", "[", "\[IndentingNewLine]", 
                   RowBox[{RowBox[{RowBox[{"$H5Data", "[", RowBox[{"$H5Key", 
                          ",", " ", "\"OuterH2StateVectors\""}], "]"}], "[", 
                       RowBox[{"[", "states", "]"}], "]"}], ",", 
                     "\[IndentingNewLine]", RowBox[{"Map", "[", 
                       "\[IndentingNewLine]", RowBox[{RowBox[{RowBox[
                          {"Superscript", "[", RowBox[{"#", ",", " ", RowBox[
                          {"\"H\"", "~", "Subscript", "~", "2"}]}], "]"}], 
                          "&"}], ",", RowBox[{"Lookup", "[", RowBox[
                          {"$H2StateAssignments", ",", " ", RowBox[
                          {"$H5Data", "[", RowBox[{"$H5Key", ",", " ", 
                          "\"OuterH2States\""}], "]"}]}], "]"}]}], 
                       "\[IndentingNewLine]", "]"}], ",", 
                     "\[IndentingNewLine]", "states"}], 
                   "\[IndentingNewLine]", "]"}]}], "*)"}]], "CodeInput", 
            CellChangeTimes -> {{3.742417932815979*^9, 3.742417950017913*^9}, 
             {3.7424179898671923*^9, 3.7424180296856413*^9}, 
             {3.742418819430039*^9, 3.742418819750043*^9}, 
             {3.742428013670312*^9, 3.742428034754107*^9}, 
             {3.742428804340639*^9, 3.7424288231705923*^9}, 
             {3.742429948515359*^9, 3.742429970729813*^9}}, 
            CellLabel -> "In[135]:="], Cell[BoxData[
             {RowBox[{RowBox[{RowBox[{"H5FormatH2StatePercentMatrix", "[", 
                    RowBox[{"states_", ",", " ", RowBox[{"saSpec_:", 
                        "All"}]}], "]"}], ":=", "\[IndentingNewLine]", 
                  RowBox[{RowBox[{"Normalize", "@*", "Total"}], "/@", 
                    "\[IndentingNewLine]", RowBox[{RowBox[{"Transpose", "[", 
                        "\[IndentingNewLine]", RowBox[{"$H5Data", "[", 
                          RowBox[{"$H5Key", ",", " ", 
                          "\"OuterH2SliceWavefunctionCoefficients\""}], 
                          "]"}], "\[IndentingNewLine]", "]"}], "[", 
                      RowBox[{"[", RowBox[{"states", ",", " ", "saSpec"}], 
                        "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
              RowBox[{RowBox[{RowBox[{"H5FormatH2StatePercentMatrix2", "[", 
                    RowBox[{"states_", ",", " ", RowBox[{"saSpec_:", 
                        "All"}]}], "]"}], ":=", "\[IndentingNewLine]", 
                  RowBox[{RowBox[{"Normalize", "@*", "Total", "@*", "Abs"}], 
                    "/@", "\[IndentingNewLine]", RowBox[{RowBox[{"Transpose", 
                        "[", "\[IndentingNewLine]", RowBox[{"$H5Data", "[", 
                          RowBox[{"$H5Key", ",", " ", 
                          "\"OuterH2SliceWavefunctionCoefficients\""}], 
                          "]"}], "\[IndentingNewLine]", "]"}], "[", 
                      RowBox[{"[", RowBox[{"states", ",", " ", "saSpec"}], 
                        "]"}], "]"}]}]}], ";"}]}], "CodeInput", 
            CellChangeTimes -> {{3.7444929839928493*^9, 
             3.744493050423765*^9}, {3.744493094907337*^9, 
             3.744493101035428*^9}}, CellLabel -> "In[136]:="], 
           Cell[BoxData[{RowBox[{RowBox[{"H5FormatH2StatePercentTable", "[", 
                  RowBox[{"states_", ",", " ", RowBox[{"saSpec_:", "All"}]}], 
                  "]"}], ":=", "\[IndentingNewLine]", RowBox[
                 {"iH5FormatStatePercentTable", "[", "\[IndentingNewLine]", 
                  RowBox[{RowBox[{"H5FormatH2StatePercentMatrix", "[", 
                      RowBox[{"states", ",", " ", "saSpec"}], "]"}], ",", 
                    "\[IndentingNewLine]", RowBox[{"Map", "[", 
                      "\[IndentingNewLine]", RowBox[{RowBox[{RowBox[
                          {"Superscript", "[", RowBox[{"#", ",", " ", RowBox[
                          {"\"H\"", "~", "Subscript", "~", "2"}]}], "]"}], 
                          "&"}], ",", RowBox[{"Lookup", "[", RowBox[
                          {"$H2StateAssignments", ",", " ", RowBox[
                          {"$H5Data", "[", RowBox[{"$H5Key", ",", " ", 
                          "\"OuterH2States\""}], "]"}]}], "]"}]}], 
                      "\[IndentingNewLine]", "]"}], ",", 
                    "\[IndentingNewLine]", "states"}], "\[IndentingNewLine]", 
                  "]"}]}], "\n", RowBox[{RowBox[{RowBox[
                   {"H5FormatH2StatePercentTable2", "[", RowBox[{"states_", 
                      ",", " ", RowBox[{"saSpec_:", "All"}]}], "]"}], ":=", 
                  "\[IndentingNewLine]", RowBox[
                   {"iH5FormatStatePercentTable", "[", "\[IndentingNewLine]", 
                    RowBox[{RowBox[{"H5FormatH2StatePercentMatrix2", "[", 
                        RowBox[{"states", ",", " ", "saSpec"}], "]"}], ",", 
                      "\[IndentingNewLine]", RowBox[{"Map", "[", 
                        "\[IndentingNewLine]", RowBox[{RowBox[{RowBox[
                          {"Superscript", "[", RowBox[{"#", ",", " ", RowBox[
                          {"\"H\"", "~", "Subscript", "~", "2"}]}], "]"}], 
                          "&"}], ",", RowBox[{"Lookup", "[", RowBox[
                          {"$H2StateAssignments", ",", " ", RowBox[
                          {"$H5Data", "[", RowBox[{"$H5Key", ",", " ", 
                          "\"OuterH2States\""}], "]"}]}], "]"}]}], 
                        "\[IndentingNewLine]", "]"}], ",", 
                      "\[IndentingNewLine]", "states"}], 
                    "\[IndentingNewLine]", "]"}]}], ";"}], 
              "\[IndentingNewLine]", RowBox[{RowBox[{RowBox[
                   {"H5FormatH2StatePercentPlot", "[", RowBox[{"states_", 
                      ",", " ", RowBox[{"saSpec_:", "All"}]}], "]"}], ":=", 
                  "\[IndentingNewLine]", RowBox[{"iH5FormatStatePercentPlot", 
                    "@", "\[IndentingNewLine]", RowBox[
                     {"H5FormatH2StatePercentMatrix", "[", RowBox[{"states", 
                        ",", " ", "saSpec"}], "]"}]}]}], ";"}], "\n", 
              RowBox[{RowBox[{RowBox[{"H5FormatH2StatePercentPlot2", "[", 
                    RowBox[{"states_", ",", " ", RowBox[{"saSpec_:", 
                        "All"}]}], "]"}], ":=", "\[IndentingNewLine]", 
                  RowBox[{"iH5FormatStatePercentPlot", "[", 
                    "\[IndentingNewLine]", RowBox[
                     {"H5FormatH2StatePercentMatrix2", "[", RowBox[{"states", 
                        ",", " ", "saSpec"}], "]"}], "\[IndentingNewLine]", 
                    "]"}]}], ";"}]}], "CodeInput", CellChangeTimes -> 
             {{3.742417932815979*^9, 3.742417950017913*^9}, 
              {3.7424179898671923*^9, 3.7424181929599743*^9}, 
              {3.742418226731757*^9, 3.7424182345401497*^9}, 
              {3.74241834512714*^9, 3.742418347512388*^9}, 
              {3.7424188041844063*^9, 3.7424188089397287*^9}, 
              {3.742428050821169*^9, 3.742428051268471*^9}, 
              {3.742429407417118*^9, 3.74242941876523*^9}, 
              3.742429974141944*^9, 3.744492463081951*^9, 
              {3.744493018123811*^9, 3.744493024697651*^9}, 
              {3.744493559734961*^9, 3.744493590563077*^9}, 
              {3.744493646037133*^9, 3.7444936854326143*^9}}, 
            CellLabel -> "In[138]:="]}, Closed]], 
        Cell[CellGroupData[{Cell["\[LeftCeiling]H+\[RightFloor]", 
            "CodeSubsubsection", Evaluatable -> True, CellChangeTimes -> 
             {{3.744493181407463*^9, 3.744493203804657*^9}}], 
           Cell["Similar thing for shared proton", "Text", CellChangeTimes -> 
             {{3.744493170124984*^9, 3.7444931744214153*^9}}], 
           Cell[BoxData[{RowBox[{RowBox[{RowBox[
                   {"H5FormatSharedProtonStatePercentMatrix", "[", 
                    RowBox[{"states_", ",", " ", RowBox[{"h2Spec_:", 
                        "All"}]}], "]"}], ":=", "\[IndentingNewLine]", 
                  RowBox[{RowBox[{"Normalize", "@*", "Total"}], "/@", 
                    "\[IndentingNewLine]", RowBox[{RowBox[{"Transpose", "[", 
                        "\[IndentingNewLine]", RowBox[{"$H5Data", "[", 
                          RowBox[{"$H5Key", ",", " ", 
                          "\"SharedProtonStateCoefficients\""}], "]"}], 
                        "\[IndentingNewLine]", "]"}], "[", RowBox[{"[", 
                        RowBox[{"states", ",", " ", "h2Spec"}], "]"}], 
                      "]"}]}]}], ";"}], "\[IndentingNewLine]", 
              RowBox[{RowBox[{RowBox[
                   {"H5FormatSharedProtonStatePercentMatrix2", "[", 
                    RowBox[{"states_", ",", " ", RowBox[{"h2Spec_:", 
                        "All"}]}], "]"}], ":=", "\[IndentingNewLine]", 
                  RowBox[{RowBox[{"Normalize", "@*", "Total", "@*", "Abs"}], 
                    "/@", "\[IndentingNewLine]", RowBox[{RowBox[{"Transpose", 
                        "[", "\[IndentingNewLine]", RowBox[{"$H5Data", "[", 
                          RowBox[{"$H5Key", ",", " ", 
                          "\"SharedProtonStateCoefficients\""}], "]"}], 
                        "\[IndentingNewLine]", "]"}], "[", RowBox[{"[", 
                        RowBox[{"states", ",", " ", "h2Spec"}], "]"}], 
                      "]"}]}]}], ";"}]}], "CodeInput", CellChangeTimes -> 
             {{3.744493074951356*^9, 3.7444931256236763*^9}}, 
            CellLabel -> "In[142]:="], Cell[BoxData[
             {RowBox[{RowBox[{RowBox[
                   {"H5FormatSharedProtonStatePercentTable", "[", RowBox[
                     {"states_", ",", " ", RowBox[{"h2Spec_:", "All"}]}], 
                    "]"}], ":=", "\[IndentingNewLine]", RowBox[
                   {"iH5FormatStatePercentTable", "[", "\[IndentingNewLine]", 
                    RowBox[{RowBox[{"H5FormatSharedProtonStatePercentMatrix", 
                        "[", RowBox[{"states", ",", " ", "h2Spec"}], "]"}], 
                      ",", "\[IndentingNewLine]", RowBox[{"Map", "[", 
                        "\[IndentingNewLine]", RowBox[{RowBox[{RowBox[
                          {"Superscript", "[", RowBox[{"#", ",", " ", 
                          "\"H+\""}], "]"}], "&"}], ",", RowBox[{"Thread", 
                          "[", RowBox[{"Ket", "[", RowBox[{"Range", "[", 
                          RowBox[{"$H5Data", "[", RowBox[{"$H5Key", ",", " ", 
                          "\"SharedProtonStates\""}], "]"}], "]"}], "]"}], 
                          "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
                      "\[IndentingNewLine]", "states"}], 
                    "\[IndentingNewLine]", "]"}]}], ";"}], 
              "\[IndentingNewLine]", RowBox[{RowBox[{RowBox[
                   {"H5FormatSharedProtonStatePercentTable2", "[", 
                    RowBox[{"states_", ",", " ", RowBox[{"h2Spec_:", 
                        "All"}]}], "]"}], ":=", "\[IndentingNewLine]", 
                  RowBox[{"iH5FormatStatePercentTable", "[", 
                    "\[IndentingNewLine]", RowBox[{RowBox[
                       {"H5FormatSharedProtonStatePercentMatrix2", "[", 
                        RowBox[{"states", ",", " ", "h2Spec"}], "]"}], ",", 
                      "\[IndentingNewLine]", RowBox[{"Map", "[", 
                        "\[IndentingNewLine]", RowBox[{RowBox[{RowBox[
                          {"Superscript", "[", RowBox[{"#", ",", " ", 
                          "\"H+\""}], "]"}], "&"}], ",", RowBox[{"Thread", 
                          "[", RowBox[{"Ket", "[", RowBox[{"Range", "[", 
                          RowBox[{"$H5Data", "[", RowBox[{"$H5Key", ",", " ", 
                          "\"SharedProtonStates\""}], "]"}], "]"}], "]"}], 
                          "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
                      "\[IndentingNewLine]", "states"}], 
                    "\[IndentingNewLine]", "]"}]}], ";"}], 
              "\[IndentingNewLine]", RowBox[{RowBox[{RowBox[
                   {"H5FormatSharedProtonStatePercentPlot", "[", RowBox[
                     {"states_", ",", " ", RowBox[{"h2Spec_:", "All"}]}], 
                    "]"}], ":=", "\[IndentingNewLine]", RowBox[
                   {"iH5FormatStatePercentPlot", "@", "\[IndentingNewLine]", 
                    RowBox[{"H5FormatSharedProtonStatePercentMatrix", "[", 
                      RowBox[{"states", ",", " ", "h2Spec"}], "]"}]}]}], 
                ";"}], "\[IndentingNewLine]", RowBox[{RowBox[
                 {RowBox[{"H5FormatSharedProtonStatePercentPlot2", "[", 
                    RowBox[{"states_", ",", " ", RowBox[{"h2Spec_:", 
                        "All"}]}], "]"}], ":=", "\[IndentingNewLine]", 
                  RowBox[{"iH5FormatStatePercentPlot", "@", 
                    "\[IndentingNewLine]", RowBox[
                     {"H5FormatSharedProtonStatePercentMatrix2", "[", 
                      RowBox[{"states", ",", " ", "h2Spec"}], "]"}]}]}], 
                ";"}]}], "CodeInput", CellChangeTimes -> 
             {{3.742417932815979*^9, 3.742417950017913*^9}, 
              {3.7424179898671923*^9, 3.7424181929599743*^9}, 
              {3.742418226731757*^9, 3.7424182345401497*^9}, 
              {3.74241834512714*^9, 3.742418347512388*^9}, 
              {3.7424188041844063*^9, 3.7424188089397287*^9}, 
              {3.742428050821169*^9, 3.742428104804759*^9}, 
              {3.742428202446821*^9, 3.7424282808286*^9}, 
              {3.7424286564285707*^9, 3.742428733083027*^9}, 
              {3.742429466380735*^9, 3.742429494756111*^9}, 
              3.742429999853385*^9, 3.7424982862390013*^9, 
              {3.744492431222883*^9, 3.7444924325975943*^9}, 
              3.744493071644878*^9, {3.744493133210862*^9, 
              3.744493155226131*^9}, {3.744493268112899*^9, 
              3.744493274125003*^9}, {3.744493334842059*^9, 
              3.744493358831594*^9}, {3.744494601040845*^9, 
              3.7444946093466473*^9}}, CellLabel -> "In[144]:="]}, Closed]], 
        Cell[CellGroupData[{Cell["\[LeftCeiling]Combo\[RightFloor]", 
            "CodeSubsubsection", Evaluatable -> True, CellChangeTimes -> 
             {{3.744493391476939*^9, 3.744493392395186*^9}}], 
           Cell[BoxData[RowBox[{RowBox[{"H5FormatStatePercentTable", "[", 
                 "states_", "]"}], ":=", "\[IndentingNewLine]", RowBox[
                {"iH5FormatStatePercentTable", "[", "\[IndentingNewLine]", 
                 RowBox[{RowBox[{"Join", "[", "\[IndentingNewLine]", 
                     RowBox[{RowBox[{"H5FormatH2StatePercentMatrix", "[", 
                         RowBox[{"states", ",", " ", "All"}], "]"}], ",", 
                       "\[IndentingNewLine]", RowBox[
                        {"H5FormatSharedProtonStatePercentMatrix", "[", 
                         RowBox[{"states", ",", " ", "All"}], "]"}], ",", 
                       "\[IndentingNewLine]", "2"}], "\[IndentingNewLine]", 
                     "]"}], ",", "\[IndentingNewLine]", RowBox[
                    {RowBox[{"Map", "[", "\[IndentingNewLine]", RowBox[
                        {RowBox[{RowBox[{"Superscript", "[", RowBox[{"#", 
                          ",", " ", RowBox[{"\"H\"", "~", "Subscript", "~", 
                          "2"}]}], "]"}], "&"}], ",", RowBox[{"Lookup", "[", 
                          RowBox[{"$H2StateAssignments", ",", " ", RowBox[
                          {"$H5Data", "[", RowBox[{"$H5Key", ",", " ", 
                          "\"OuterH2States\""}], "]"}]}], "]"}]}], 
                       "\[IndentingNewLine]", "]"}], "~", "Join", "~", 
                     "\[IndentingNewLine]", RowBox[{"Map", "[", 
                       "\[IndentingNewLine]", RowBox[{RowBox[{RowBox[
                          {"Superscript", "[", RowBox[{"#", ",", " ", 
                          "\"H+\""}], "]"}], "&"}], ",", RowBox[{"Thread", 
                          "[", RowBox[{"Ket", "[", RowBox[{"Range", "[", 
                          RowBox[{"$H5Data", "[", RowBox[{"$H5Key", ",", " ", 
                          "\"SharedProtonStates\""}], "]"}], "]"}], "]"}], 
                          "]"}]}], "\[IndentingNewLine]", "]"}]}], ",", 
                   "\[IndentingNewLine]", "states", ",", 
                   "\[IndentingNewLine]", RowBox[{"Dividers", "\[Rule]", 
                     RowBox[{"{", RowBox[{RowBox[{RowBox[{RowBox[{"{", RowBox[
                          {"3", ",", " ", RowBox[{"-", "10"}]}], "}"}], 
                          "\[Rule]", "Gray"}], "//", "Thread"}], ",", " ", 
                         RowBox[{"{", RowBox[{"2", "\[Rule]", "Gray"}], 
                          "}"}]}], "}"}]}]}], "\[IndentingNewLine]", 
                 "]"}]}]], "CodeInput", CellChangeTimes -> 
             {{3.742429514353301*^9, 3.742429566757951*^9}, 
              {3.742429620625538*^9, 3.742429713702895*^9}, 
              {3.742430004213702*^9, 3.742430011803875*^9}, 
              3.742498289647599*^9, {3.744496934553409*^9, 
              3.744496958910873*^9}}, CellLabel -> "In[148]:="], 
           Cell[BoxData[RowBox[{RowBox[{"H5FormatStatePercentTable2", "[", 
                 "states_", "]"}], ":=", "\[IndentingNewLine]", RowBox[
                {"iH5FormatStatePercentTable", "[", "\[IndentingNewLine]", 
                 RowBox[{RowBox[{"Join", "[", "\[IndentingNewLine]", 
                     RowBox[{RowBox[{"H5FormatH2StatePercentMatrix2", "[", 
                         RowBox[{"states", ",", " ", "All"}], "]"}], ",", 
                       "\[IndentingNewLine]", RowBox[
                        {"H5FormatSharedProtonStatePercentMatrix2", "[", 
                         RowBox[{"states", ",", " ", "All"}], "]"}], ",", 
                       "\[IndentingNewLine]", "2"}], "\[IndentingNewLine]", 
                     "]"}], ",", "\[IndentingNewLine]", RowBox[
                    {RowBox[{"Map", "[", "\[IndentingNewLine]", RowBox[
                        {RowBox[{RowBox[{"Superscript", "[", RowBox[{"#", 
                          ",", " ", RowBox[{"\"H\"", "~", "Subscript", "~", 
                          "2"}]}], "]"}], "&"}], ",", RowBox[{"Lookup", "[", 
                          RowBox[{"$H2StateAssignments", ",", " ", RowBox[
                          {"$H5Data", "[", RowBox[{"$H5Key", ",", " ", 
                          "\"OuterH2States\""}], "]"}]}], "]"}]}], 
                       "\[IndentingNewLine]", "]"}], "~", "Join", "~", 
                     "\[IndentingNewLine]", RowBox[{"Map", "[", 
                       "\[IndentingNewLine]", RowBox[{RowBox[{RowBox[
                          {"Superscript", "[", RowBox[{"#", ",", " ", 
                          "\"H+\""}], "]"}], "&"}], ",", RowBox[{"Thread", 
                          "[", RowBox[{"Ket", "[", RowBox[{"Range", "[", 
                          RowBox[{"$H5Data", "[", RowBox[{"$H5Key", ",", " ", 
                          "\"SharedProtonStates\""}], "]"}], "]"}], "]"}], 
                          "]"}]}], "\[IndentingNewLine]", "]"}]}], ",", 
                   "\[IndentingNewLine]", "states", ",", 
                   "\[IndentingNewLine]", RowBox[{"Dividers", "\[Rule]", 
                     RowBox[{"{", RowBox[{RowBox[{RowBox[{RowBox[{"{", RowBox[
                          {"3", ",", " ", RowBox[{"-", "10"}]}], "}"}], 
                          "\[Rule]", "Gray"}], "//", "Thread"}], ",", " ", 
                         RowBox[{"{", RowBox[{"2", "\[Rule]", "Gray"}], 
                          "}"}]}], "}"}]}]}], "\[IndentingNewLine]", 
                 "]"}]}]], "CodeInput", CellChangeTimes -> 
             {{3.742429514353301*^9, 3.742429566757951*^9}, 
              {3.742429620625538*^9, 3.742429713702895*^9}, 
              {3.742430004213702*^9, 3.742430011803875*^9}, 
              3.742498289647599*^9, 3.7444969186528482*^9, 
              {3.744496970100482*^9, 3.744496973935383*^9}}, 
            CellLabel -> "In[149]:="]}, Closed]], 
        Cell[CellGroupData[{Cell["\[LeftCeiling]Plots\[RightFloor]", 
            "CodeSubsubsection", Evaluatable -> True, CellChangeTimes -> 
             {{3.744496775118931*^9, 3.74449677576721*^9}}], 
           Cell[BoxData[RowBox[{RowBox[{"H5PlotHPH2States", "[", "states_", 
                 "]"}], ":=", "\[IndentingNewLine]", RowBox[
                {RowBox[{RowBox[{RowBox[{RowBox[{RowBox[{"$H5Data", "[", 
                          RowBox[{"$H5Key", ",", " ", 
                          "\"SharedProtonSliceWavefunctionsUnnormalized\""}], 
                          "]"}], "[", RowBox[{"[", RowBox[{"All", ",", " ", 
                          "states"}], "]"}], "]"}], "//", 
                       "\[IndentingNewLine]", "Transpose"}], "//", 
                     "Rescale"}], "//", "\[IndentingNewLine]", RowBox[
                    {"Map", "[", "\[IndentingNewLine]", RowBox[
                      {RowBox[{"With", "[", RowBox[{RowBox[{"{", RowBox[
                          {"rs", "=", "#"}], "}"}], ",", 
                          "\[IndentingNewLine]", RowBox[{"Map", "[", 
                          "\[IndentingNewLine]", RowBox[{RowBox[{RowBox[
                          {"ListDensityPlot", "[", "\[IndentingNewLine]", 
                          RowBox[{RowBox[{"Transpose", "@", RowBox[
                          {"Partition", "[", RowBox[{"#", ",", " ", RowBox[
                          {"$H5Data", "[", RowBox[{"$H5Key", ",", " ", 
                          "\"SharedProtonPoints\""}], "]"}]}], "]"}]}], ",", 
                          " ", "\[IndentingNewLine]", RowBox[{
                          "ColorFunction", "\[Rule]", "\"Rainbow\""}], ",", 
                          " ", "\[IndentingNewLine]", RowBox[{"PlotRange", 
                          "\[Rule]", "All"}], ",", "\[IndentingNewLine]", 
                          RowBox[{"DataRange", "\[Rule]", RowBox[{"{", RowBox[
                          {RowBox[{"{", RowBox[{RowBox[{"-", "2.5"}], ",", 
                          " ", "2.5"}], "}"}], ",", " ", RowBox[{"{", RowBox[
                          {".7", ",", " ", "3.7"}], "}"}]}], "}"}]}], ",", 
                          "\[IndentingNewLine]", RowBox[{
                          "ColorFunctionScaling", "\[Rule]", "False"}], ",", 
                          "\[IndentingNewLine]", RowBox[{"FrameTicks", 
                          "\[Rule]", "None"}]}], "\[IndentingNewLine]", 
                          "]"}], "&"}], ",", "\[IndentingNewLine]", "rs"}], 
                          "\[IndentingNewLine]", "]"}]}], 
                         "\[IndentingNewLine]", "]"}], "&"}], 
                     "\[IndentingNewLine]", "]"}]}], "//", RowBox[
                  {RowBox[{"Column", "[", RowBox[{"Map", "[", RowBox[
                        {RowBox[{RowBox[{"Style", "[", RowBox[{RowBox[{"Row", 
                          "[", "#", "]"}], ",", " ", RowBox[
                          {"LineBreakWithin", "\[Rule]", "False"}]}], "]"}], 
                          "&"}], ",", " ", "#"}], "]"}], "]"}], "&"}]}]}]], 
            "CodeInput", CellChangeTimes -> {{3.74250128363375*^9, 
              3.742501389102173*^9}, {3.7425014239504538*^9, 
              3.742501424314443*^9}, {3.7425015231457157*^9, 
              3.7425016214509277*^9}, {3.742501655771859*^9, 
              3.74250167826243*^9}, {3.7425017473243427*^9, 
              3.742501769999691*^9}, {3.742501994570129*^9, 
              3.742501995984416*^9}, {3.742502033005373*^9, 
              3.7425020335932283*^9}, {3.74250289848883*^9, 
              3.7425029050076437*^9}, {3.742503113281196*^9, 
              3.742503114648134*^9}, {3.742503149624106*^9, 
              3.742503153557653*^9}, 3.742503895464078*^9, 
              {3.742504214348011*^9, 3.742504338361107*^9}, 
              {3.742504376090581*^9, 3.742504381398767*^9}, 
              {3.742504412530455*^9, 3.7425044182980747*^9}, 
              {3.742504463944809*^9, 3.742504478256464*^9}, 
              {3.74250515537185*^9, 3.7425051699775047*^9}, 
              {3.742505481065115*^9, 3.742505481564159*^9}, 
              {3.742512440094599*^9, 3.742512444340727*^9}, 
              {3.742518640521336*^9, 3.7425186525112343*^9}, 
              {3.74251898843393*^9, 3.742518991099968*^9}, 
              {3.74257563567761*^9, 3.7425756950353727*^9}, 
              {3.742576615950197*^9, 3.74257661732458*^9}, 
              {3.744485660714938*^9, 3.7444856683554497*^9}, 
              {3.744485733760336*^9, 3.744485739542251*^9}, 
              {3.744485922652609*^9, 3.7444859461594553*^9}, 
              {3.74448641164377*^9, 3.7444864398336983*^9}}, 
            CellLabel -> "In[150]:="], Cell[BoxData[
             RowBox[{RowBox[{"H5PlotHPH2States3D", "[", "states_", "]"}], 
               ":=", "\[IndentingNewLine]", RowBox[{RowBox[
                  {RowBox[{RowBox[{RowBox[{RowBox[{"$H5Data", "[", RowBox[
                          {"$H5Key", ",", " ", 
                          "\"SharedProtonSliceWavefunctionsUnnormalized\""}], 
                          "]"}], "[", RowBox[{"[", RowBox[{"All", ",", " ", 
                          "states"}], "]"}], "]"}], "//", 
                       "\[IndentingNewLine]", "Transpose"}], "//", 
                     "Rescale"}], "//", "\[IndentingNewLine]", RowBox[
                    {"Map", "[", "\[IndentingNewLine]", RowBox[
                      {RowBox[{"With", "[", RowBox[{RowBox[{"{", RowBox[
                          {"rs", "=", "#"}], "}"}], ",", 
                          "\[IndentingNewLine]", RowBox[{"Map", "[", 
                          "\[IndentingNewLine]", RowBox[{RowBox[{RowBox[
                          {"ListPlot3D", "[", "\[IndentingNewLine]", RowBox[
                          {RowBox[{"Transpose", "@", RowBox[{"Partition", 
                          "[", RowBox[{"#", ",", " ", RowBox[{"$H5Data", "[", 
                          RowBox[{"$H5Key", ",", " ", 
                          "\"SharedProtonPoints\""}], "]"}]}], "]"}]}], ",", 
                          " ", "\[IndentingNewLine]", RowBox[{
                          "ColorFunction", "\[Rule]", "\"Rainbow\""}], ",", 
                          " ", "\[IndentingNewLine]", RowBox[{"PlotRange", 
                          "\[Rule]", "All"}], ",", "\[IndentingNewLine]", 
                          RowBox[{"DataRange", "\[Rule]", RowBox[{"{", RowBox[
                          {RowBox[{"{", RowBox[{RowBox[{"-", "2.5"}], ",", 
                          " ", "2.5"}], "}"}], ",", " ", RowBox[{"{", RowBox[
                          {".7", ",", " ", "3.7"}], "}"}]}], "}"}]}], ",", 
                          "\[IndentingNewLine]", RowBox[{
                          "ColorFunctionScaling", "\[Rule]", "False"}]}], 
                          "\[IndentingNewLine]", "]"}], "&"}], ",", 
                          "\[IndentingNewLine]", "rs"}], 
                          "\[IndentingNewLine]", "]"}]}], 
                         "\[IndentingNewLine]", "]"}], "&"}], 
                     "\[IndentingNewLine]", "]"}]}], "//", "Grid"}]}]], 
            "CodeInput", CellChangeTimes -> {{3.74250128363375*^9, 
              3.742501389102173*^9}, {3.7425014239504538*^9, 
              3.742501424314443*^9}, {3.7425015231457157*^9, 
              3.7425016214509277*^9}, {3.742501655771859*^9, 
              3.74250167826243*^9}, {3.7425017473243427*^9, 
              3.742501769999691*^9}, {3.742501994570129*^9, 
              3.742501995984416*^9}, {3.742502033005373*^9, 
              3.7425020335932283*^9}, {3.74250289848883*^9, 
              3.7425029050076437*^9}, {3.742503113281196*^9, 
              3.742503114648134*^9}, {3.742503149624106*^9, 
              3.742503153557653*^9}, 3.742503895464078*^9, 
              {3.742504214348011*^9, 3.742504338361107*^9}, 
              {3.742504376090581*^9, 3.742504381398767*^9}, 
              {3.742504412530455*^9, 3.7425044182980747*^9}, 
              {3.742504463944809*^9, 3.742504478256464*^9}, 
              {3.74250515537185*^9, 3.7425051699775047*^9}, 
              {3.742505481065115*^9, 3.742505481564159*^9}, 
              {3.742512440094599*^9, 3.742512444340727*^9}, 
              {3.742518640521336*^9, 3.7425186525112343*^9}, 
              {3.74251898843393*^9, 3.742518991099968*^9}, 
              {3.74257563567761*^9, 3.7425756950353727*^9}, 
              {3.742576620498493*^9, 3.7425766256838503*^9}}, 
            CellLabel -> "In[151]:="], Cell[BoxData[
             {RowBox[{RowBox[{"Clear", "@", "H5PlotH2HPStates"}], ";"}], 
              "\[IndentingNewLine]", RowBox[{RowBox[{"H5PlotH2HPStates", "[", 
                  RowBox[{"states_", ",", " ", RowBox[{"hpStates", ":", "_", 
                      ":", RowBox[{"{", RowBox[{RowBox[{RowBox[{"14", "*", 
                          "30"}], "+", "6"}], ",", " ", RowBox[{RowBox[
                          {"15", "*", "30"}], "+", "6"}]}], "}"}]}]}], "]"}], 
                ":=", "\[IndentingNewLine]", RowBox[{RowBox[
                   {RowBox[{RowBox[{RowBox[{"$H5Data", "[", RowBox[{"$H5Key", 
                          ",", " ", "\"OuterH2SliceWavefunctions\""}], "]"}], 
                        "[", RowBox[{"[", RowBox[{"states", ",", " ", 
                          "hpStates"}], "]"}], "]"}], "//", "Rescale"}], 
                    "//", "\[IndentingNewLine]", RowBox[{"Map", "[", 
                      "\[IndentingNewLine]", RowBox[{RowBox[{"With", "[", 
                          RowBox[{RowBox[{"{", RowBox[{"rs", "=", "#"}], 
                          "}"}], ",", "\[IndentingNewLine]", RowBox[{"Map", 
                          "[", "\[IndentingNewLine]", RowBox[{RowBox[
                          {RowBox[{"ListDensityPlot", "[", 
                          "\[IndentingNewLine]", RowBox[{RowBox[{"Transpose", 
                          "@", RowBox[{"Partition", "[", RowBox[{"#", ",", 
                          " ", RowBox[{"$H5Data", "[", RowBox[{"$H5Key", ",", 
                          " ", "\"OuterH2Points\""}], "]"}]}], "]"}]}], ",", 
                          " ", "\[IndentingNewLine]", RowBox[{
                          "ColorFunction", "\[Rule]", "\"Rainbow\""}], ",", 
                          "\[IndentingNewLine]", RowBox[{"PlotRange", 
                          "\[Rule]", "All"}], ",", "\[IndentingNewLine]", 
                          RowBox[{"DataRange", "\[Rule]", RowBox[{"{", RowBox[
                          {RowBox[{"{", RowBox[{".25", ",", " ", "1"}], 
                          "}"}], ",", " ", RowBox[{"{", RowBox[{".25", ",", 
                          " ", "1"}], "}"}]}], "}"}]}], ",", 
                          "\[IndentingNewLine]", RowBox[{
                          "ColorFunctionScaling", "\[Rule]", "False"}], ",", 
                          "\[IndentingNewLine]", RowBox[{"FrameTicks", 
                          "\[Rule]", "None"}]}], "\[IndentingNewLine]", 
                          "]"}], "&"}], ",", "\[IndentingNewLine]", "rs"}], 
                          "\[IndentingNewLine]", "]"}]}], 
                          "\[IndentingNewLine]", "]"}], "&"}], 
                      "\[IndentingNewLine]", "]"}]}], "//", RowBox[
                   {RowBox[{"Column", "[", RowBox[{"Map", "[", RowBox[
                         {RowBox[{RowBox[{"Style", "[", RowBox[{RowBox[
                          {"Row", "[", "#", "]"}], ",", " ", RowBox[
                          {"LineBreakWithin", "\[Rule]", "False"}]}], "]"}], 
                          "&"}], ",", " ", "#"}], "]"}], "]"}], "&"}]}]}]}], 
            "CodeInput", CellChangeTimes -> {{3.74250128363375*^9, 
              3.742501389102173*^9}, {3.7425014239504538*^9, 
              3.742501424314443*^9}, {3.7425015231457157*^9, 
              3.7425016214509277*^9}, {3.742501655771859*^9, 
              3.74250167826243*^9}, {3.7425017473243427*^9, 
              3.742501769999691*^9}, {3.742501994570129*^9, 
              3.742501995984416*^9}, {3.742502033005373*^9, 
              3.7425020335932283*^9}, {3.74250289848883*^9, 
              3.7425029050076437*^9}, {3.742503113281196*^9, 
              3.742503114648134*^9}, {3.742503149624106*^9, 
              3.742503153557653*^9}, 3.742503895464078*^9, 
              {3.742504214348011*^9, 3.742504338361107*^9}, 
              {3.742504376090581*^9, 3.742504381398767*^9}, 
              {3.742504412530455*^9, 3.7425044182980747*^9}, 
              {3.742504463944809*^9, 3.742504478256464*^9}, 
              {3.74250515537185*^9, 3.7425051699775047*^9}, 
              {3.742505481065115*^9, 3.742505481564159*^9}, 
              {3.742512440094599*^9, 3.742512444340727*^9}, 
              {3.742518640521336*^9, 3.7425186525112343*^9}, 
              {3.74251898843393*^9, 3.742518991099968*^9}, 
              {3.74257563567761*^9, 3.7425757072436943*^9}, 
              {3.742575926709669*^9, 3.742575977080305*^9}, 
              {3.742576086174842*^9, 3.7425763533102427*^9}, 
              {3.7425764634732847*^9, 3.7425764695736303*^9}, 
              {3.7444856774391737*^9, 3.744485678576016*^9}, 
              {3.7444858707886*^9, 3.7444858720465927*^9}, 
              {3.744485927162705*^9, 3.744485940095695*^9}, 
              {3.744486365992393*^9, 3.74448642964613*^9}}, 
            CellLabel -> "In[152]:="], Cell[BoxData[
             {RowBox[{RowBox[{"Clear", "@", "H5PlotH2HPStates3D"}], ";"}], 
              "\[IndentingNewLine]", RowBox[{RowBox[{"H5PlotH2HPStates3D", 
                  "[", RowBox[{"states_", ",", " ", RowBox[{"hpStates", ":", 
                      "_", ":", RowBox[{"{", RowBox[{RowBox[{RowBox[{"14", 
                          "*", "30"}], "+", "6"}], ",", " ", RowBox[
                          {RowBox[{"15", "*", "30"}], "+", "6"}]}], 
                        "}"}]}]}], "]"}], ":=", "\[IndentingNewLine]", 
                RowBox[{RowBox[{RowBox[{RowBox[{RowBox[{"$H5Data", "[", 
                          RowBox[{"$H5Key", ",", " ", 
                          "\"OuterH2SliceWavefunctions\""}], "]"}], "[", 
                        RowBox[{"[", RowBox[{"states", ",", " ", 
                          "hpStates"}], "]"}], "]"}], "//", "Rescale"}], 
                    "//", "\[IndentingNewLine]", RowBox[{"Map", "[", 
                      "\[IndentingNewLine]", RowBox[{RowBox[{"With", "[", 
                          RowBox[{RowBox[{"{", RowBox[{"rs", "=", "#"}], 
                          "}"}], ",", "\[IndentingNewLine]", RowBox[{"Map", 
                          "[", "\[IndentingNewLine]", RowBox[{RowBox[
                          {RowBox[{"ListPlot3D", "[", "\[IndentingNewLine]", 
                          RowBox[{RowBox[{"Transpose", "@", RowBox[
                          {"Partition", "[", RowBox[{"#", ",", " ", RowBox[
                          {"$H5Data", "[", RowBox[{"$H5Key", ",", " ", 
                          "\"OuterH2Points\""}], "]"}]}], "]"}]}], ",", " ", 
                          "\[IndentingNewLine]", RowBox[{"ColorFunction", 
                          "\[Rule]", "\"Rainbow\""}], ",", 
                          "\[IndentingNewLine]", RowBox[{"PlotRange", 
                          "\[Rule]", "All"}], ",", "\[IndentingNewLine]", 
                          RowBox[{"DataRange", "\[Rule]", RowBox[{"{", RowBox[
                          {RowBox[{"{", RowBox[{".25", ",", " ", "1"}], 
                          "}"}], ",", " ", RowBox[{"{", RowBox[{".25", ",", 
                          " ", "1"}], "}"}]}], "}"}]}], ",", 
                          "\[IndentingNewLine]", RowBox[{
                          "ColorFunctionScaling", "\[Rule]", "False"}]}], 
                          "\[IndentingNewLine]", "]"}], "&"}], ",", 
                          "\[IndentingNewLine]", "rs"}], 
                          "\[IndentingNewLine]", "]"}]}], 
                          "\[IndentingNewLine]", "]"}], "&"}], 
                      "\[IndentingNewLine]", "]"}]}], "//", "Grid"}]}]}], 
            "CodeInput", CellChangeTimes -> {{3.74250128363375*^9, 
              3.742501389102173*^9}, {3.7425014239504538*^9, 
              3.742501424314443*^9}, {3.7425015231457157*^9, 
              3.7425016214509277*^9}, {3.742501655771859*^9, 
              3.74250167826243*^9}, {3.7425017473243427*^9, 
              3.742501769999691*^9}, {3.742501994570129*^9, 
              3.742501995984416*^9}, {3.742502033005373*^9, 
              3.7425020335932283*^9}, {3.74250289848883*^9, 
              3.7425029050076437*^9}, {3.742503113281196*^9, 
              3.742503114648134*^9}, {3.742503149624106*^9, 
              3.742503153557653*^9}, 3.742503895464078*^9, 
              {3.742504214348011*^9, 3.742504338361107*^9}, 
              {3.742504376090581*^9, 3.742504381398767*^9}, 
              {3.742504412530455*^9, 3.7425044182980747*^9}, 
              {3.742504463944809*^9, 3.742504478256464*^9}, 
              {3.74250515537185*^9, 3.7425051699775047*^9}, 
              {3.742505481065115*^9, 3.742505481564159*^9}, 
              {3.742512440094599*^9, 3.742512444340727*^9}, 
              {3.742518640521336*^9, 3.7425186525112343*^9}, 
              {3.74251898843393*^9, 3.742518991099968*^9}, 
              {3.74257563567761*^9, 3.7425757072436943*^9}, 
              {3.742575926709669*^9, 3.742575977080305*^9}, 
              {3.742576086174842*^9, 3.7425763533102427*^9}, 
              {3.7425764634732847*^9, 3.7425764695736303*^9}, 
              {3.742576633352377*^9, 3.742576638076275*^9}, 
              3.744485745921584*^9, 3.744485874252809*^9}, 
            CellLabel -> "In[154]:="]}, Closed]]}, Closed]], 
     Cell[BoxData[RowBox[{RowBox[{"End", "[", "]"}], ";"}]], "InputSection"], 
     Cell[BoxData[RowBox[{RowBox[{"EndPackage", "[", "]"}], ";"}]], 
      "InputSection"]}, Open]], Cell["", "SectionSeparator"]}, 
 WindowSize -> {808, 746}, WindowMargins -> {{Automatic, 110}, 
   {4, Automatic}}, TaggingRules -> 
  {"UUIDButtons" -> 
    {"Active" -> {"Button-b8297203-6b28-48f9-8ba3-edbd5eb431d2" -> False, 
       "Button-8c92aebb-2725-4f7c-a6a8-f90e3a4dce9c" -> False, 
       "Button-ede3a027-3279-40a0-8aa4-1fcc5f60357d" -> False, 
       "Button-89ffd2c3-ec41-4179-a9b1-8e28670bca2c" -> False, 
       "Button-ca46e5e0-4fd1-47e8-8cf6-72998922b757" -> False, 
       "Button-a6d68254-3684-4d32-83fc-e5ef6f443930" -> False}}}, 
 FrontEndVersion -> 
  "11.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 5, 2018)", 
 StyleDefinitions -> FrontEnd`FileName[{"BTools"}, "CodePackage.nb", 
   CharacterEncoding -> "UTF-8"]]
